<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>8dobibim Tech Blog</title>
<meta name="keywords" content="">
<meta name="description" content="🛠️ OpenWebUI 운영 매뉴얼

👥 대상: DevOps 엔지니어, SRE, 시스템 관리자
📅 업데이트: 정기적으로 업데이트 필요
🚨 비상 연락처: [팀 연락처 정보]

📋 일일 운영 체크리스트
매일 확인 항목
#!/bin/bash
# daily-check.sh

echo &#34;📅 $(date &#39;&#43;%Y-%m-%d %H:%M:%S&#39;) - 일일 운영 체크 시작&#34;

# 1. 클러스터 상태
kubectl get nodes
kubectl get pods -A | grep -v Running

# 2. 애플리케이션 상태
kubectl get pods -n openwebui -n litellm

# 3. 리소스 사용량
kubectl top nodes
kubectl top pods -A

# 4. 최근 에러 로그 (최근 1시간)
kubectl logs --since=1h -n openwebui -l app=openwebui | grep -i error | tail -10

# 5. 디스크 사용량
kubectl get pvc -A

echo &#34;✅ 일일 체크 완료&#34;
주간 확인 항목

 백업 상태 확인
 보안 패치 검토
 비용 사용량 확인
 성능 메트릭 검토
 로그 정리


🔍 모니터링 및 알람
핵심 메트릭
# prometheus-alerts.yml
groups:
- name: openwebui.rules
  rules:
  # 파드 상태 알람
  - alert: PodCrashLooping
    expr: rate(kube_pod_container_status_restarts_total[5m]) &gt; 0
    for: 5m
    annotations:
      summary: &#34;Pod {{ $labels.pod }} is crash looping&#34;
  
  # 리소스 사용량 알람
  - alert: HighCPUUsage
    expr: (cpu_usage_rate &gt; 80)
    for: 10m
    annotations:
      summary: &#34;High CPU usage: {{ $value }}%&#34;
  
  # 응답 시간 알람
  - alert: HighResponseTime
    expr: http_request_duration_seconds &gt; 2
    for: 5m
    annotations:
      summary: &#34;High response time: {{ $value }}s&#34;
로그 모니터링
# 실시간 로그 모니터링
kubectl logs -f deployment/openwebui -n openwebui

# 에러 로그 검색
kubectl logs deployment/openwebui -n openwebui | grep -E &#34;(ERROR|FATAL|CRITICAL)&#34;

# 특정 시간대 로그
kubectl logs --since=2h --until=1h deployment/openwebui -n openwebui

📊 성능 관리
스케일링 관리
# 수동 스케일링
kubectl scale deployment openwebui --replicas=5 -n openwebui
kubectl scale deployment litellm --replicas=3 -n litellm

# HPA 상태 확인
kubectl get hpa -A

# 스케일링 이벤트 확인
kubectl describe hpa openwebui-hpa -n openwebui
리소스 최적화
# 리소스 요청량 조정 예시
resources:
  requests:
    memory: &#34;512Mi&#34;    # 실제 사용량 기반 조정
    cpu: &#34;250m&#34;
  limits:
    memory: &#34;1Gi&#34;      # OOM 방지
    cpu: &#34;500m&#34;        # CPU 스로틀링 방지
데이터베이스 성능
# PostgreSQL 연결 수 확인
kubectl exec deployment/postgres -n openwebui -- \
  psql -U openwebui -d openwebui -c \
  &#34;SELECT count(*) FROM pg_stat_activity WHERE state = &#39;active&#39;;&#34;

# 슬로우 쿼리 확인
kubectl exec deployment/postgres -n openwebui -- \
  psql -U openwebui -d openwebui -c \
  &#34;SELECT query, mean_exec_time FROM pg_stat_statements ORDER BY mean_exec_time DESC LIMIT 10;&#34;

# 데이터베이스 크기 확인
kubectl exec deployment/postgres -n openwebui -- \
  psql -U openwebui -d openwebui -c \
  &#34;SELECT pg_size_pretty(pg_database_size(&#39;openwebui&#39;));&#34;

🔄 백업 및 복원
데이터베이스 백업
#!/bin/bash
# backup-database.sh

BACKUP_DATE=$(date &#43;%Y%m%d_%H%M%S)
BACKUP_FILE=&#34;openwebui_backup_${BACKUP_DATE}.sql&#34;

# PostgreSQL 백업
kubectl exec deployment/postgres -n openwebui -- \
  pg_dump -U openwebui openwebui &gt; $BACKUP_FILE

# S3에 업로드
aws s3 cp $BACKUP_FILE s3://openwebui-backups/database/

# 로컬 파일 정리 (7일 이상 된 파일)
find . -name &#34;openwebui_backup_*.sql&#34; -mtime &#43;7 -delete

echo &#34;✅ 백업 완료: $BACKUP_FILE&#34;
데이터베이스 복원
#!/bin/bash
# restore-database.sh

BACKUP_FILE=$1

if [ -z &#34;$BACKUP_FILE&#34; ]; then
  echo &#34;사용법: $0 &lt;backup_file&gt;&#34;
  exit 1
fi

# S3에서 백업 파일 다운로드
aws s3 cp s3://openwebui-backups/database/$BACKUP_FILE .

# 애플리케이션 중지
kubectl scale deployment openwebui --replicas=0 -n openwebui
kubectl scale deployment litellm --replicas=0 -n litellm

# 데이터베이스 복원
kubectl exec -i deployment/postgres -n openwebui -- \
  psql -U openwebui openwebui &lt; $BACKUP_FILE

# 애플리케이션 재시작
kubectl scale deployment openwebui --replicas=2 -n openwebui
kubectl scale deployment litellm --replicas=2 -n litellm

echo &#34;✅ 복원 완료&#34;
설정 파일 백업
# ConfigMap 백업
kubectl get configmap -n openwebui -o yaml &gt; configmaps-backup.yaml
kubectl get configmap -n litellm -o yaml &gt;&gt; configmaps-backup.yaml

# Secret 백업 (암호화된 형태)
kubectl get secret -n openwebui -o yaml &gt; secrets-backup.yaml
kubectl get secret -n litellm -o yaml &gt;&gt; secrets-backup.yaml

🚨 장애 대응
긴급 상황 대응 절차
1단계: 상황 파악 (5분 이내)
# 전체 상태 빠른 확인
kubectl get pods -A | grep -v Running
kubectl get nodes
kubectl top nodes

# 최근 이벤트 확인
kubectl get events -A --sort-by=&#39;.lastTimestamp&#39; | tail -20
2단계: 임시 조치 (10분 이내)
# 파드 재시작
kubectl rollout restart deployment/openwebui -n openwebui

# 트래픽 차단 (필요시)
kubectl patch ingress openwebui-ingress -n openwebui -p \
  &#39;{&#34;metadata&#34;:{&#34;annotations&#34;:{&#34;nginx.ingress.kubernetes.io/server-snippet&#34;:&#34;return 503;&#34;}}}&#39;

# 스케일 다운 (리소스 부족 시)
kubectl scale deployment openwebui --replicas=1 -n openwebui
3단계: 근본 원인 분석
# 상세 로그 분석
kubectl logs deployment/openwebui -n openwebui --previous
kubectl describe pod -l app=openwebui -n openwebui

# 리소스 사용량 분석
kubectl top pods -n openwebui --containers
kubectl describe nodes
일반적인 장애 시나리오
파드가 시작되지 않는 경우
# 원인 확인
kubectl describe pod &lt;pod-name&gt; -n openwebui

# 일반적인 해결책
# 1. 이미지 문제
kubectl get pods -n openwebui -o jsonpath=&#39;{.items[*].spec.containers[*].image}&#39;

# 2. 리소스 부족
kubectl describe nodes | grep -A 5 &#34;Allocated resources&#34;

# 3. PVC 마운트 실패
kubectl get pvc -n openwebui
kubectl describe pvc &lt;pvc-name&gt; -n openwebui
데이터베이스 연결 실패
# PostgreSQL 상태 확인
kubectl get pods -l app=postgres -n openwebui
kubectl logs deployment/postgres -n openwebui

# 연결 테스트
kubectl exec deployment/postgres -n openwebui -- pg_isready

# 네트워크 연결 확인
kubectl exec deployment/openwebui -n openwebui -- \
  nc -zv postgres-service 5432
높은 응답 시간
# 리소스 사용량 확인
kubectl top pods -n openwebui

# HPA 스케일링 강제 실행
kubectl patch hpa openwebui-hpa -n openwebui -p \
  &#39;{&#34;spec&#34;:{&#34;minReplicas&#34;:3}}&#39;

# 캐시 클리어 (애플리케이션별 방법)
kubectl exec deployment/openwebui -n openwebui -- \
  curl -X POST http://localhost:8080/api/v1/cache/clear

🔧 유지보수
정기 업데이트
#!/bin/bash
# update-system.sh

echo &#34;🔄 시스템 업데이트 시작...&#34;

# 1. EKS 클러스터 업데이트 확인
aws eks describe-cluster --name openwebui-eks-dev \
  --query &#39;cluster.version&#39; --output text

# 2. 노드 그룹 업데이트 확인
aws eks describe-nodegroup --cluster-name openwebui-eks-dev \
  --nodegroup-name primary-nodes \
  --query &#39;nodegroup.version&#39; --output text

# 3. Add-on 업데이트
kubectl get pods -n kube-system

# 4. 애플리케이션 이미지 업데이트
kubectl set image deployment/openwebui openwebui=ghcr.io/openwebui:latest -n openwebui

echo &#34;✅ 업데이트 완료&#34;
보안 패치
# 보안 스캔 실행
trivy image ghcr.io/openwebui:latest

# 취약점 있는 컨테이너 재배포
kubectl rollout restart deployment/openwebui -n openwebui

# 시크릿 로테이션
kubectl create secret generic api-keys \
  --from-literal=OPENAI_API_KEY=new-key \
  --dry-run=client -o yaml | kubectl apply -f -
용량 관리
# 디스크 사용량 모니터링
kubectl get pvc -A -o custom-columns=NAME:.metadata.name,SIZE:.spec.resources.requests.storage,USED:.status.capacity.storage

# 로그 정리
kubectl logs deployment/openwebui -n openwebui --tail=1000 &gt; /dev/null

# 이미지 정리 (노드에서 직접)
docker system prune -a

📈 성능 튜닝
애플리케이션 최적화
# OpenWebUI 성능 설정
env:
- name: WEBUI_SECRET_KEY
  value: &#34;optimized-secret-key&#34;
- name: MAX_WORKERS
  value: &#34;4&#34;
- name: TIMEOUT
  value: &#34;60&#34;
- name: KEEP_ALIVE
  value: &#34;2&#34;
데이터베이스 튜닝
-- PostgreSQL 성능 튜닝
-- 연결 풀 설정
ALTER SYSTEM SET max_connections = 100;
ALTER SYSTEM SET shared_buffers = &#39;256MB&#39;;
ALTER SYSTEM SET effective_cache_size = &#39;1GB&#39;;
ALTER SYSTEM SET work_mem = &#39;4MB&#39;;

-- 인덱스 확인 및 최적화
SELECT schemaname, tablename, attname, n_distinct, correlation 
FROM pg_stats WHERE tablename = &#39;your_table&#39;;
네트워크 최적화
# Ingress 설정 최적화
annotations:
  nginx.ingress.kubernetes.io/proxy-connect-timeout: &#34;60&#34;
  nginx.ingress.kubernetes.io/proxy-send-timeout: &#34;60&#34;
  nginx.ingress.kubernetes.io/proxy-read-timeout: &#34;60&#34;
  nginx.ingress.kubernetes.io/proxy-body-size: &#34;50m&#34;
  nginx.ingress.kubernetes.io/enable-cors: &#34;true&#34;

💰 비용 최적화
리소스 사용량 분석
# 노드 비용 분석
kubectl describe nodes | grep -A 3 &#34;Allocated resources&#34;

# Spot 인스턴스 활용률
kubectl get nodes -l node.kubernetes.io/instance-type

# 사용하지 않는 리소스 정리
kubectl get pods -A --field-selector=status.phase=Succeeded
kubectl delete pods --field-selector=status.phase=Succeeded -A
자동 스케일링 최적화
# 비용 효율적인 HPA 설정
spec:
  minReplicas: 1        # 최소 비용
  maxReplicas: 10       # 트래픽 대응
  targetCPUUtilizationPercentage: 70  # 적절한 활용률
  
  behavior:
    scaleDown:
      stabilizationWindowSeconds: 300  # 급격한 스케일 다운 방지
      policies:
      - type: Percent
        value: 50
        periodSeconds: 60

📞 비상 연락 체계
장애 등급별 대응
P0 (Critical): 
  - 서비스 완전 중단
  - 즉시 대응 (24/7)
  - 연락처: [긴급 연락처]

P1 (High):
  - 주요 기능 장애
  - 4시간 이내 대응
  - 연락처: [팀 리더]

P2 (Medium):
  - 부분 기능 장애  
  - 24시간 이내 대응
  - 연락처: [담당자]

P3 (Low):
  - 성능 저하
  - 72시간 이내 대응
  - 연락처: [팀 메일]
에스컬레이션 절차

1차 담당자 (30분 이내 응답)
팀 리더 (1시간 이내)
기술 책임자 (2시간 이내)
CTO (4시간 이내)


📚 운영 도구 및 대시보드
필수 도구
# kubectl 플러그인 설치
kubectl krew install ctx ns stern top

# 유용한 명령어 별칭
alias k=&#39;kubectl&#39;
alias kgp=&#39;kubectl get pods&#39;
alias kgs=&#39;kubectl get svc&#39; 
alias kgn=&#39;kubectl get nodes&#39;
alias kdp=&#39;kubectl describe pod&#39;
alias kl=&#39;kubectl logs&#39;
모니터링 대시보드

Grafana: http://grafana.your-domain.com
Prometheus: http://prometheus.your-domain.com
Jaeger: http://jaeger.your-domain.com (트레이싱)
ArgoCD: http://argocd.your-domain.com (GitOps)

로그 분석
# 중앙화된 로깅 (ELK Stack)
kubectl port-forward svc/kibana 5601:5601 -n logging

# 로그 쿼리 예시
# Kibana에서: kubernetes.namespace:&#34;openwebui&#34; AND level:&#34;ERROR&#34;

🔄 정기 작업 스케줄
일일 작업 (자동화)
# CronJob 예시
apiVersion: batch/v1
kind: CronJob
metadata:
  name: daily-cleanup
spec:
  schedule: &#34;0 2 * * *&#34;  # 매일 오전 2시
  jobTemplate:
    spec:
      template:
        spec:
          containers:
          - name: cleanup
            image: alpine:latest
            command:
            - /bin/sh
            - -c
            - |
              # 로그 정리
              find /var/log -name &#34;*.log&#34; -mtime &#43;7 -delete
              # 임시 파일 정리
              find /tmp -mtime &#43;1 -delete
          restartPolicy: OnFailure
주간 작업

백업 검증 테스트
보안 스캔 실행
성능 리포트 작성
비용 분석 리포트

월간 작업

DR(재해복구) 테스트
보안 감사
용량 계획 검토
아키텍처 리뷰

이제 완전한 운영 매뉴얼이 준비되었습니다! 🛠️">
<meta name="author" content="">
<link rel="canonical" href="https://8dobibim.github.io/backend/%EC%9A%B4%EC%98%81-%EB%A9%94%EB%89%B4%EC%96%BC/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.css" rel="preload stylesheet" as="style">
<link rel="icon" href="https://8dobibim.github.io/%3Clink%20/%20abs%20url%3E">
<link rel="icon" type="image/png" sizes="16x16" href="https://8dobibim.github.io/%3Clink%20/%20abs%20url%3E">
<link rel="icon" type="image/png" sizes="32x32" href="https://8dobibim.github.io/%3Clink%20/%20abs%20url%3E">
<link rel="apple-touch-icon" href="https://8dobibim.github.io/%3Clink%20/%20abs%20url%3E">
<link rel="mask-icon" href="https://8dobibim.github.io/%3Clink%20/%20abs%20url%3E">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://8dobibim.github.io/backend/%EC%9A%B4%EC%98%81-%EB%A9%94%EB%89%B4%EC%96%BC/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:url" content="https://8dobibim.github.io/backend/%EC%9A%B4%EC%98%81-%EB%A9%94%EB%89%B4%EC%96%BC/">
  <meta property="og:site_name" content="8dobibim Tech Blog">
  <meta property="og:title" content="8dobibim Tech Blog">
  <meta property="og:description" content="🛠️ OpenWebUI 운영 매뉴얼 👥 대상: DevOps 엔지니어, SRE, 시스템 관리자
📅 업데이트: 정기적으로 업데이트 필요
🚨 비상 연락처: [팀 연락처 정보]
📋 일일 운영 체크리스트 매일 확인 항목 #!/bin/bash # daily-check.sh echo &#34;📅 $(date &#39;&#43;%Y-%m-%d %H:%M:%S&#39;) - 일일 운영 체크 시작&#34; # 1. 클러스터 상태 kubectl get nodes kubectl get pods -A | grep -v Running # 2. 애플리케이션 상태 kubectl get pods -n openwebui -n litellm # 3. 리소스 사용량 kubectl top nodes kubectl top pods -A # 4. 최근 에러 로그 (최근 1시간) kubectl logs --since=1h -n openwebui -l app=openwebui | grep -i error | tail -10 # 5. 디스크 사용량 kubectl get pvc -A echo &#34;✅ 일일 체크 완료&#34; 주간 확인 항목 백업 상태 확인 보안 패치 검토 비용 사용량 확인 성능 메트릭 검토 로그 정리 🔍 모니터링 및 알람 핵심 메트릭 # prometheus-alerts.yml groups: - name: openwebui.rules rules: # 파드 상태 알람 - alert: PodCrashLooping expr: rate(kube_pod_container_status_restarts_total[5m]) &gt; 0 for: 5m annotations: summary: &#34;Pod {{ $labels.pod }} is crash looping&#34; # 리소스 사용량 알람 - alert: HighCPUUsage expr: (cpu_usage_rate &gt; 80) for: 10m annotations: summary: &#34;High CPU usage: {{ $value }}%&#34; # 응답 시간 알람 - alert: HighResponseTime expr: http_request_duration_seconds &gt; 2 for: 5m annotations: summary: &#34;High response time: {{ $value }}s&#34; 로그 모니터링 # 실시간 로그 모니터링 kubectl logs -f deployment/openwebui -n openwebui # 에러 로그 검색 kubectl logs deployment/openwebui -n openwebui | grep -E &#34;(ERROR|FATAL|CRITICAL)&#34; # 특정 시간대 로그 kubectl logs --since=2h --until=1h deployment/openwebui -n openwebui 📊 성능 관리 스케일링 관리 # 수동 스케일링 kubectl scale deployment openwebui --replicas=5 -n openwebui kubectl scale deployment litellm --replicas=3 -n litellm # HPA 상태 확인 kubectl get hpa -A # 스케일링 이벤트 확인 kubectl describe hpa openwebui-hpa -n openwebui 리소스 최적화 # 리소스 요청량 조정 예시 resources: requests: memory: &#34;512Mi&#34; # 실제 사용량 기반 조정 cpu: &#34;250m&#34; limits: memory: &#34;1Gi&#34; # OOM 방지 cpu: &#34;500m&#34; # CPU 스로틀링 방지 데이터베이스 성능 # PostgreSQL 연결 수 확인 kubectl exec deployment/postgres -n openwebui -- \ psql -U openwebui -d openwebui -c \ &#34;SELECT count(*) FROM pg_stat_activity WHERE state = &#39;active&#39;;&#34; # 슬로우 쿼리 확인 kubectl exec deployment/postgres -n openwebui -- \ psql -U openwebui -d openwebui -c \ &#34;SELECT query, mean_exec_time FROM pg_stat_statements ORDER BY mean_exec_time DESC LIMIT 10;&#34; # 데이터베이스 크기 확인 kubectl exec deployment/postgres -n openwebui -- \ psql -U openwebui -d openwebui -c \ &#34;SELECT pg_size_pretty(pg_database_size(&#39;openwebui&#39;));&#34; 🔄 백업 및 복원 데이터베이스 백업 #!/bin/bash # backup-database.sh BACKUP_DATE=$(date &#43;%Y%m%d_%H%M%S) BACKUP_FILE=&#34;openwebui_backup_${BACKUP_DATE}.sql&#34; # PostgreSQL 백업 kubectl exec deployment/postgres -n openwebui -- \ pg_dump -U openwebui openwebui &gt; $BACKUP_FILE # S3에 업로드 aws s3 cp $BACKUP_FILE s3://openwebui-backups/database/ # 로컬 파일 정리 (7일 이상 된 파일) find . -name &#34;openwebui_backup_*.sql&#34; -mtime &#43;7 -delete echo &#34;✅ 백업 완료: $BACKUP_FILE&#34; 데이터베이스 복원 #!/bin/bash # restore-database.sh BACKUP_FILE=$1 if [ -z &#34;$BACKUP_FILE&#34; ]; then echo &#34;사용법: $0 &lt;backup_file&gt;&#34; exit 1 fi # S3에서 백업 파일 다운로드 aws s3 cp s3://openwebui-backups/database/$BACKUP_FILE . # 애플리케이션 중지 kubectl scale deployment openwebui --replicas=0 -n openwebui kubectl scale deployment litellm --replicas=0 -n litellm # 데이터베이스 복원 kubectl exec -i deployment/postgres -n openwebui -- \ psql -U openwebui openwebui &lt; $BACKUP_FILE # 애플리케이션 재시작 kubectl scale deployment openwebui --replicas=2 -n openwebui kubectl scale deployment litellm --replicas=2 -n litellm echo &#34;✅ 복원 완료&#34; 설정 파일 백업 # ConfigMap 백업 kubectl get configmap -n openwebui -o yaml &gt; configmaps-backup.yaml kubectl get configmap -n litellm -o yaml &gt;&gt; configmaps-backup.yaml # Secret 백업 (암호화된 형태) kubectl get secret -n openwebui -o yaml &gt; secrets-backup.yaml kubectl get secret -n litellm -o yaml &gt;&gt; secrets-backup.yaml 🚨 장애 대응 긴급 상황 대응 절차 1단계: 상황 파악 (5분 이내) # 전체 상태 빠른 확인 kubectl get pods -A | grep -v Running kubectl get nodes kubectl top nodes # 최근 이벤트 확인 kubectl get events -A --sort-by=&#39;.lastTimestamp&#39; | tail -20 2단계: 임시 조치 (10분 이내) # 파드 재시작 kubectl rollout restart deployment/openwebui -n openwebui # 트래픽 차단 (필요시) kubectl patch ingress openwebui-ingress -n openwebui -p \ &#39;{&#34;metadata&#34;:{&#34;annotations&#34;:{&#34;nginx.ingress.kubernetes.io/server-snippet&#34;:&#34;return 503;&#34;}}}&#39; # 스케일 다운 (리소스 부족 시) kubectl scale deployment openwebui --replicas=1 -n openwebui 3단계: 근본 원인 분석 # 상세 로그 분석 kubectl logs deployment/openwebui -n openwebui --previous kubectl describe pod -l app=openwebui -n openwebui # 리소스 사용량 분석 kubectl top pods -n openwebui --containers kubectl describe nodes 일반적인 장애 시나리오 파드가 시작되지 않는 경우 # 원인 확인 kubectl describe pod &lt;pod-name&gt; -n openwebui # 일반적인 해결책 # 1. 이미지 문제 kubectl get pods -n openwebui -o jsonpath=&#39;{.items[*].spec.containers[*].image}&#39; # 2. 리소스 부족 kubectl describe nodes | grep -A 5 &#34;Allocated resources&#34; # 3. PVC 마운트 실패 kubectl get pvc -n openwebui kubectl describe pvc &lt;pvc-name&gt; -n openwebui 데이터베이스 연결 실패 # PostgreSQL 상태 확인 kubectl get pods -l app=postgres -n openwebui kubectl logs deployment/postgres -n openwebui # 연결 테스트 kubectl exec deployment/postgres -n openwebui -- pg_isready # 네트워크 연결 확인 kubectl exec deployment/openwebui -n openwebui -- \ nc -zv postgres-service 5432 높은 응답 시간 # 리소스 사용량 확인 kubectl top pods -n openwebui # HPA 스케일링 강제 실행 kubectl patch hpa openwebui-hpa -n openwebui -p \ &#39;{&#34;spec&#34;:{&#34;minReplicas&#34;:3}}&#39; # 캐시 클리어 (애플리케이션별 방법) kubectl exec deployment/openwebui -n openwebui -- \ curl -X POST http://localhost:8080/api/v1/cache/clear 🔧 유지보수 정기 업데이트 #!/bin/bash # update-system.sh echo &#34;🔄 시스템 업데이트 시작...&#34; # 1. EKS 클러스터 업데이트 확인 aws eks describe-cluster --name openwebui-eks-dev \ --query &#39;cluster.version&#39; --output text # 2. 노드 그룹 업데이트 확인 aws eks describe-nodegroup --cluster-name openwebui-eks-dev \ --nodegroup-name primary-nodes \ --query &#39;nodegroup.version&#39; --output text # 3. Add-on 업데이트 kubectl get pods -n kube-system # 4. 애플리케이션 이미지 업데이트 kubectl set image deployment/openwebui openwebui=ghcr.io/openwebui:latest -n openwebui echo &#34;✅ 업데이트 완료&#34; 보안 패치 # 보안 스캔 실행 trivy image ghcr.io/openwebui:latest # 취약점 있는 컨테이너 재배포 kubectl rollout restart deployment/openwebui -n openwebui # 시크릿 로테이션 kubectl create secret generic api-keys \ --from-literal=OPENAI_API_KEY=new-key \ --dry-run=client -o yaml | kubectl apply -f - 용량 관리 # 디스크 사용량 모니터링 kubectl get pvc -A -o custom-columns=NAME:.metadata.name,SIZE:.spec.resources.requests.storage,USED:.status.capacity.storage # 로그 정리 kubectl logs deployment/openwebui -n openwebui --tail=1000 &gt; /dev/null # 이미지 정리 (노드에서 직접) docker system prune -a 📈 성능 튜닝 애플리케이션 최적화 # OpenWebUI 성능 설정 env: - name: WEBUI_SECRET_KEY value: &#34;optimized-secret-key&#34; - name: MAX_WORKERS value: &#34;4&#34; - name: TIMEOUT value: &#34;60&#34; - name: KEEP_ALIVE value: &#34;2&#34; 데이터베이스 튜닝 -- PostgreSQL 성능 튜닝 -- 연결 풀 설정 ALTER SYSTEM SET max_connections = 100; ALTER SYSTEM SET shared_buffers = &#39;256MB&#39;; ALTER SYSTEM SET effective_cache_size = &#39;1GB&#39;; ALTER SYSTEM SET work_mem = &#39;4MB&#39;; -- 인덱스 확인 및 최적화 SELECT schemaname, tablename, attname, n_distinct, correlation FROM pg_stats WHERE tablename = &#39;your_table&#39;; 네트워크 최적화 # Ingress 설정 최적화 annotations: nginx.ingress.kubernetes.io/proxy-connect-timeout: &#34;60&#34; nginx.ingress.kubernetes.io/proxy-send-timeout: &#34;60&#34; nginx.ingress.kubernetes.io/proxy-read-timeout: &#34;60&#34; nginx.ingress.kubernetes.io/proxy-body-size: &#34;50m&#34; nginx.ingress.kubernetes.io/enable-cors: &#34;true&#34; 💰 비용 최적화 리소스 사용량 분석 # 노드 비용 분석 kubectl describe nodes | grep -A 3 &#34;Allocated resources&#34; # Spot 인스턴스 활용률 kubectl get nodes -l node.kubernetes.io/instance-type # 사용하지 않는 리소스 정리 kubectl get pods -A --field-selector=status.phase=Succeeded kubectl delete pods --field-selector=status.phase=Succeeded -A 자동 스케일링 최적화 # 비용 효율적인 HPA 설정 spec: minReplicas: 1 # 최소 비용 maxReplicas: 10 # 트래픽 대응 targetCPUUtilizationPercentage: 70 # 적절한 활용률 behavior: scaleDown: stabilizationWindowSeconds: 300 # 급격한 스케일 다운 방지 policies: - type: Percent value: 50 periodSeconds: 60 📞 비상 연락 체계 장애 등급별 대응 P0 (Critical): - 서비스 완전 중단 - 즉시 대응 (24/7) - 연락처: [긴급 연락처] P1 (High): - 주요 기능 장애 - 4시간 이내 대응 - 연락처: [팀 리더] P2 (Medium): - 부분 기능 장애 - 24시간 이내 대응 - 연락처: [담당자] P3 (Low): - 성능 저하 - 72시간 이내 대응 - 연락처: [팀 메일] 에스컬레이션 절차 1차 담당자 (30분 이내 응답) 팀 리더 (1시간 이내) 기술 책임자 (2시간 이내) CTO (4시간 이내) 📚 운영 도구 및 대시보드 필수 도구 # kubectl 플러그인 설치 kubectl krew install ctx ns stern top # 유용한 명령어 별칭 alias k=&#39;kubectl&#39; alias kgp=&#39;kubectl get pods&#39; alias kgs=&#39;kubectl get svc&#39; alias kgn=&#39;kubectl get nodes&#39; alias kdp=&#39;kubectl describe pod&#39; alias kl=&#39;kubectl logs&#39; 모니터링 대시보드 Grafana: http://grafana.your-domain.com Prometheus: http://prometheus.your-domain.com Jaeger: http://jaeger.your-domain.com (트레이싱) ArgoCD: http://argocd.your-domain.com (GitOps) 로그 분석 # 중앙화된 로깅 (ELK Stack) kubectl port-forward svc/kibana 5601:5601 -n logging # 로그 쿼리 예시 # Kibana에서: kubernetes.namespace:&#34;openwebui&#34; AND level:&#34;ERROR&#34; 🔄 정기 작업 스케줄 일일 작업 (자동화) # CronJob 예시 apiVersion: batch/v1 kind: CronJob metadata: name: daily-cleanup spec: schedule: &#34;0 2 * * *&#34; # 매일 오전 2시 jobTemplate: spec: template: spec: containers: - name: cleanup image: alpine:latest command: - /bin/sh - -c - | # 로그 정리 find /var/log -name &#34;*.log&#34; -mtime &#43;7 -delete # 임시 파일 정리 find /tmp -mtime &#43;1 -delete restartPolicy: OnFailure 주간 작업 백업 검증 테스트 보안 스캔 실행 성능 리포트 작성 비용 분석 리포트 월간 작업 DR(재해복구) 테스트 보안 감사 용량 계획 검토 아키텍처 리뷰 이제 완전한 운영 매뉴얼이 준비되었습니다! 🛠️">
  <meta property="og:locale" content="ko">
  <meta property="og:type" content="article">
    <meta property="article:section" content="backend">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="">
<meta name="twitter:description" content="🛠️ OpenWebUI 운영 매뉴얼

👥 대상: DevOps 엔지니어, SRE, 시스템 관리자
📅 업데이트: 정기적으로 업데이트 필요
🚨 비상 연락처: [팀 연락처 정보]

📋 일일 운영 체크리스트
매일 확인 항목
#!/bin/bash
# daily-check.sh

echo &#34;📅 $(date &#39;&#43;%Y-%m-%d %H:%M:%S&#39;) - 일일 운영 체크 시작&#34;

# 1. 클러스터 상태
kubectl get nodes
kubectl get pods -A | grep -v Running

# 2. 애플리케이션 상태
kubectl get pods -n openwebui -n litellm

# 3. 리소스 사용량
kubectl top nodes
kubectl top pods -A

# 4. 최근 에러 로그 (최근 1시간)
kubectl logs --since=1h -n openwebui -l app=openwebui | grep -i error | tail -10

# 5. 디스크 사용량
kubectl get pvc -A

echo &#34;✅ 일일 체크 완료&#34;
주간 확인 항목

 백업 상태 확인
 보안 패치 검토
 비용 사용량 확인
 성능 메트릭 검토
 로그 정리


🔍 모니터링 및 알람
핵심 메트릭
# prometheus-alerts.yml
groups:
- name: openwebui.rules
  rules:
  # 파드 상태 알람
  - alert: PodCrashLooping
    expr: rate(kube_pod_container_status_restarts_total[5m]) &gt; 0
    for: 5m
    annotations:
      summary: &#34;Pod {{ $labels.pod }} is crash looping&#34;
  
  # 리소스 사용량 알람
  - alert: HighCPUUsage
    expr: (cpu_usage_rate &gt; 80)
    for: 10m
    annotations:
      summary: &#34;High CPU usage: {{ $value }}%&#34;
  
  # 응답 시간 알람
  - alert: HighResponseTime
    expr: http_request_duration_seconds &gt; 2
    for: 5m
    annotations:
      summary: &#34;High response time: {{ $value }}s&#34;
로그 모니터링
# 실시간 로그 모니터링
kubectl logs -f deployment/openwebui -n openwebui

# 에러 로그 검색
kubectl logs deployment/openwebui -n openwebui | grep -E &#34;(ERROR|FATAL|CRITICAL)&#34;

# 특정 시간대 로그
kubectl logs --since=2h --until=1h deployment/openwebui -n openwebui

📊 성능 관리
스케일링 관리
# 수동 스케일링
kubectl scale deployment openwebui --replicas=5 -n openwebui
kubectl scale deployment litellm --replicas=3 -n litellm

# HPA 상태 확인
kubectl get hpa -A

# 스케일링 이벤트 확인
kubectl describe hpa openwebui-hpa -n openwebui
리소스 최적화
# 리소스 요청량 조정 예시
resources:
  requests:
    memory: &#34;512Mi&#34;    # 실제 사용량 기반 조정
    cpu: &#34;250m&#34;
  limits:
    memory: &#34;1Gi&#34;      # OOM 방지
    cpu: &#34;500m&#34;        # CPU 스로틀링 방지
데이터베이스 성능
# PostgreSQL 연결 수 확인
kubectl exec deployment/postgres -n openwebui -- \
  psql -U openwebui -d openwebui -c \
  &#34;SELECT count(*) FROM pg_stat_activity WHERE state = &#39;active&#39;;&#34;

# 슬로우 쿼리 확인
kubectl exec deployment/postgres -n openwebui -- \
  psql -U openwebui -d openwebui -c \
  &#34;SELECT query, mean_exec_time FROM pg_stat_statements ORDER BY mean_exec_time DESC LIMIT 10;&#34;

# 데이터베이스 크기 확인
kubectl exec deployment/postgres -n openwebui -- \
  psql -U openwebui -d openwebui -c \
  &#34;SELECT pg_size_pretty(pg_database_size(&#39;openwebui&#39;));&#34;

🔄 백업 및 복원
데이터베이스 백업
#!/bin/bash
# backup-database.sh

BACKUP_DATE=$(date &#43;%Y%m%d_%H%M%S)
BACKUP_FILE=&#34;openwebui_backup_${BACKUP_DATE}.sql&#34;

# PostgreSQL 백업
kubectl exec deployment/postgres -n openwebui -- \
  pg_dump -U openwebui openwebui &gt; $BACKUP_FILE

# S3에 업로드
aws s3 cp $BACKUP_FILE s3://openwebui-backups/database/

# 로컬 파일 정리 (7일 이상 된 파일)
find . -name &#34;openwebui_backup_*.sql&#34; -mtime &#43;7 -delete

echo &#34;✅ 백업 완료: $BACKUP_FILE&#34;
데이터베이스 복원
#!/bin/bash
# restore-database.sh

BACKUP_FILE=$1

if [ -z &#34;$BACKUP_FILE&#34; ]; then
  echo &#34;사용법: $0 &lt;backup_file&gt;&#34;
  exit 1
fi

# S3에서 백업 파일 다운로드
aws s3 cp s3://openwebui-backups/database/$BACKUP_FILE .

# 애플리케이션 중지
kubectl scale deployment openwebui --replicas=0 -n openwebui
kubectl scale deployment litellm --replicas=0 -n litellm

# 데이터베이스 복원
kubectl exec -i deployment/postgres -n openwebui -- \
  psql -U openwebui openwebui &lt; $BACKUP_FILE

# 애플리케이션 재시작
kubectl scale deployment openwebui --replicas=2 -n openwebui
kubectl scale deployment litellm --replicas=2 -n litellm

echo &#34;✅ 복원 완료&#34;
설정 파일 백업
# ConfigMap 백업
kubectl get configmap -n openwebui -o yaml &gt; configmaps-backup.yaml
kubectl get configmap -n litellm -o yaml &gt;&gt; configmaps-backup.yaml

# Secret 백업 (암호화된 형태)
kubectl get secret -n openwebui -o yaml &gt; secrets-backup.yaml
kubectl get secret -n litellm -o yaml &gt;&gt; secrets-backup.yaml

🚨 장애 대응
긴급 상황 대응 절차
1단계: 상황 파악 (5분 이내)
# 전체 상태 빠른 확인
kubectl get pods -A | grep -v Running
kubectl get nodes
kubectl top nodes

# 최근 이벤트 확인
kubectl get events -A --sort-by=&#39;.lastTimestamp&#39; | tail -20
2단계: 임시 조치 (10분 이내)
# 파드 재시작
kubectl rollout restart deployment/openwebui -n openwebui

# 트래픽 차단 (필요시)
kubectl patch ingress openwebui-ingress -n openwebui -p \
  &#39;{&#34;metadata&#34;:{&#34;annotations&#34;:{&#34;nginx.ingress.kubernetes.io/server-snippet&#34;:&#34;return 503;&#34;}}}&#39;

# 스케일 다운 (리소스 부족 시)
kubectl scale deployment openwebui --replicas=1 -n openwebui
3단계: 근본 원인 분석
# 상세 로그 분석
kubectl logs deployment/openwebui -n openwebui --previous
kubectl describe pod -l app=openwebui -n openwebui

# 리소스 사용량 분석
kubectl top pods -n openwebui --containers
kubectl describe nodes
일반적인 장애 시나리오
파드가 시작되지 않는 경우
# 원인 확인
kubectl describe pod &lt;pod-name&gt; -n openwebui

# 일반적인 해결책
# 1. 이미지 문제
kubectl get pods -n openwebui -o jsonpath=&#39;{.items[*].spec.containers[*].image}&#39;

# 2. 리소스 부족
kubectl describe nodes | grep -A 5 &#34;Allocated resources&#34;

# 3. PVC 마운트 실패
kubectl get pvc -n openwebui
kubectl describe pvc &lt;pvc-name&gt; -n openwebui
데이터베이스 연결 실패
# PostgreSQL 상태 확인
kubectl get pods -l app=postgres -n openwebui
kubectl logs deployment/postgres -n openwebui

# 연결 테스트
kubectl exec deployment/postgres -n openwebui -- pg_isready

# 네트워크 연결 확인
kubectl exec deployment/openwebui -n openwebui -- \
  nc -zv postgres-service 5432
높은 응답 시간
# 리소스 사용량 확인
kubectl top pods -n openwebui

# HPA 스케일링 강제 실행
kubectl patch hpa openwebui-hpa -n openwebui -p \
  &#39;{&#34;spec&#34;:{&#34;minReplicas&#34;:3}}&#39;

# 캐시 클리어 (애플리케이션별 방법)
kubectl exec deployment/openwebui -n openwebui -- \
  curl -X POST http://localhost:8080/api/v1/cache/clear

🔧 유지보수
정기 업데이트
#!/bin/bash
# update-system.sh

echo &#34;🔄 시스템 업데이트 시작...&#34;

# 1. EKS 클러스터 업데이트 확인
aws eks describe-cluster --name openwebui-eks-dev \
  --query &#39;cluster.version&#39; --output text

# 2. 노드 그룹 업데이트 확인
aws eks describe-nodegroup --cluster-name openwebui-eks-dev \
  --nodegroup-name primary-nodes \
  --query &#39;nodegroup.version&#39; --output text

# 3. Add-on 업데이트
kubectl get pods -n kube-system

# 4. 애플리케이션 이미지 업데이트
kubectl set image deployment/openwebui openwebui=ghcr.io/openwebui:latest -n openwebui

echo &#34;✅ 업데이트 완료&#34;
보안 패치
# 보안 스캔 실행
trivy image ghcr.io/openwebui:latest

# 취약점 있는 컨테이너 재배포
kubectl rollout restart deployment/openwebui -n openwebui

# 시크릿 로테이션
kubectl create secret generic api-keys \
  --from-literal=OPENAI_API_KEY=new-key \
  --dry-run=client -o yaml | kubectl apply -f -
용량 관리
# 디스크 사용량 모니터링
kubectl get pvc -A -o custom-columns=NAME:.metadata.name,SIZE:.spec.resources.requests.storage,USED:.status.capacity.storage

# 로그 정리
kubectl logs deployment/openwebui -n openwebui --tail=1000 &gt; /dev/null

# 이미지 정리 (노드에서 직접)
docker system prune -a

📈 성능 튜닝
애플리케이션 최적화
# OpenWebUI 성능 설정
env:
- name: WEBUI_SECRET_KEY
  value: &#34;optimized-secret-key&#34;
- name: MAX_WORKERS
  value: &#34;4&#34;
- name: TIMEOUT
  value: &#34;60&#34;
- name: KEEP_ALIVE
  value: &#34;2&#34;
데이터베이스 튜닝
-- PostgreSQL 성능 튜닝
-- 연결 풀 설정
ALTER SYSTEM SET max_connections = 100;
ALTER SYSTEM SET shared_buffers = &#39;256MB&#39;;
ALTER SYSTEM SET effective_cache_size = &#39;1GB&#39;;
ALTER SYSTEM SET work_mem = &#39;4MB&#39;;

-- 인덱스 확인 및 최적화
SELECT schemaname, tablename, attname, n_distinct, correlation 
FROM pg_stats WHERE tablename = &#39;your_table&#39;;
네트워크 최적화
# Ingress 설정 최적화
annotations:
  nginx.ingress.kubernetes.io/proxy-connect-timeout: &#34;60&#34;
  nginx.ingress.kubernetes.io/proxy-send-timeout: &#34;60&#34;
  nginx.ingress.kubernetes.io/proxy-read-timeout: &#34;60&#34;
  nginx.ingress.kubernetes.io/proxy-body-size: &#34;50m&#34;
  nginx.ingress.kubernetes.io/enable-cors: &#34;true&#34;

💰 비용 최적화
리소스 사용량 분석
# 노드 비용 분석
kubectl describe nodes | grep -A 3 &#34;Allocated resources&#34;

# Spot 인스턴스 활용률
kubectl get nodes -l node.kubernetes.io/instance-type

# 사용하지 않는 리소스 정리
kubectl get pods -A --field-selector=status.phase=Succeeded
kubectl delete pods --field-selector=status.phase=Succeeded -A
자동 스케일링 최적화
# 비용 효율적인 HPA 설정
spec:
  minReplicas: 1        # 최소 비용
  maxReplicas: 10       # 트래픽 대응
  targetCPUUtilizationPercentage: 70  # 적절한 활용률
  
  behavior:
    scaleDown:
      stabilizationWindowSeconds: 300  # 급격한 스케일 다운 방지
      policies:
      - type: Percent
        value: 50
        periodSeconds: 60

📞 비상 연락 체계
장애 등급별 대응
P0 (Critical): 
  - 서비스 완전 중단
  - 즉시 대응 (24/7)
  - 연락처: [긴급 연락처]

P1 (High):
  - 주요 기능 장애
  - 4시간 이내 대응
  - 연락처: [팀 리더]

P2 (Medium):
  - 부분 기능 장애  
  - 24시간 이내 대응
  - 연락처: [담당자]

P3 (Low):
  - 성능 저하
  - 72시간 이내 대응
  - 연락처: [팀 메일]
에스컬레이션 절차

1차 담당자 (30분 이내 응답)
팀 리더 (1시간 이내)
기술 책임자 (2시간 이내)
CTO (4시간 이내)


📚 운영 도구 및 대시보드
필수 도구
# kubectl 플러그인 설치
kubectl krew install ctx ns stern top

# 유용한 명령어 별칭
alias k=&#39;kubectl&#39;
alias kgp=&#39;kubectl get pods&#39;
alias kgs=&#39;kubectl get svc&#39; 
alias kgn=&#39;kubectl get nodes&#39;
alias kdp=&#39;kubectl describe pod&#39;
alias kl=&#39;kubectl logs&#39;
모니터링 대시보드

Grafana: http://grafana.your-domain.com
Prometheus: http://prometheus.your-domain.com
Jaeger: http://jaeger.your-domain.com (트레이싱)
ArgoCD: http://argocd.your-domain.com (GitOps)

로그 분석
# 중앙화된 로깅 (ELK Stack)
kubectl port-forward svc/kibana 5601:5601 -n logging

# 로그 쿼리 예시
# Kibana에서: kubernetes.namespace:&#34;openwebui&#34; AND level:&#34;ERROR&#34;

🔄 정기 작업 스케줄
일일 작업 (자동화)
# CronJob 예시
apiVersion: batch/v1
kind: CronJob
metadata:
  name: daily-cleanup
spec:
  schedule: &#34;0 2 * * *&#34;  # 매일 오전 2시
  jobTemplate:
    spec:
      template:
        spec:
          containers:
          - name: cleanup
            image: alpine:latest
            command:
            - /bin/sh
            - -c
            - |
              # 로그 정리
              find /var/log -name &#34;*.log&#34; -mtime &#43;7 -delete
              # 임시 파일 정리
              find /tmp -mtime &#43;1 -delete
          restartPolicy: OnFailure
주간 작업

백업 검증 테스트
보안 스캔 실행
성능 리포트 작성
비용 분석 리포트

월간 작업

DR(재해복구) 테스트
보안 감사
용량 계획 검토
아키텍처 리뷰

이제 완전한 운영 매뉴얼이 준비되었습니다! 🛠️">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Backend 문서",
      "item": "https://8dobibim.github.io/backend/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "",
      "item": "https://8dobibim.github.io/backend/%EC%9A%B4%EC%98%81-%EB%A9%94%EB%89%B4%EC%96%BC/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "",
  "name": "",
  "description": "🛠️ OpenWebUI 운영 매뉴얼 👥 대상: DevOps 엔지니어, SRE, 시스템 관리자\n📅 업데이트: 정기적으로 업데이트 필요\n🚨 비상 연락처: [팀 연락처 정보]\n📋 일일 운영 체크리스트 매일 확인 항목 #!/bin/bash # daily-check.sh echo \u0026#34;📅 $(date \u0026#39;+%Y-%m-%d %H:%M:%S\u0026#39;) - 일일 운영 체크 시작\u0026#34; # 1. 클러스터 상태 kubectl get nodes kubectl get pods -A | grep -v Running # 2. 애플리케이션 상태 kubectl get pods -n openwebui -n litellm # 3. 리소스 사용량 kubectl top nodes kubectl top pods -A # 4. 최근 에러 로그 (최근 1시간) kubectl logs --since=1h -n openwebui -l app=openwebui | grep -i error | tail -10 # 5. 디스크 사용량 kubectl get pvc -A echo \u0026#34;✅ 일일 체크 완료\u0026#34; 주간 확인 항목 백업 상태 확인 보안 패치 검토 비용 사용량 확인 성능 메트릭 검토 로그 정리 🔍 모니터링 및 알람 핵심 메트릭 # prometheus-alerts.yml groups: - name: openwebui.rules rules: # 파드 상태 알람 - alert: PodCrashLooping expr: rate(kube_pod_container_status_restarts_total[5m]) \u0026gt; 0 for: 5m annotations: summary: \u0026#34;Pod {{ $labels.pod }} is crash looping\u0026#34; # 리소스 사용량 알람 - alert: HighCPUUsage expr: (cpu_usage_rate \u0026gt; 80) for: 10m annotations: summary: \u0026#34;High CPU usage: {{ $value }}%\u0026#34; # 응답 시간 알람 - alert: HighResponseTime expr: http_request_duration_seconds \u0026gt; 2 for: 5m annotations: summary: \u0026#34;High response time: {{ $value }}s\u0026#34; 로그 모니터링 # 실시간 로그 모니터링 kubectl logs -f deployment/openwebui -n openwebui # 에러 로그 검색 kubectl logs deployment/openwebui -n openwebui | grep -E \u0026#34;(ERROR|FATAL|CRITICAL)\u0026#34; # 특정 시간대 로그 kubectl logs --since=2h --until=1h deployment/openwebui -n openwebui 📊 성능 관리 스케일링 관리 # 수동 스케일링 kubectl scale deployment openwebui --replicas=5 -n openwebui kubectl scale deployment litellm --replicas=3 -n litellm # HPA 상태 확인 kubectl get hpa -A # 스케일링 이벤트 확인 kubectl describe hpa openwebui-hpa -n openwebui 리소스 최적화 # 리소스 요청량 조정 예시 resources: requests: memory: \u0026#34;512Mi\u0026#34; # 실제 사용량 기반 조정 cpu: \u0026#34;250m\u0026#34; limits: memory: \u0026#34;1Gi\u0026#34; # OOM 방지 cpu: \u0026#34;500m\u0026#34; # CPU 스로틀링 방지 데이터베이스 성능 # PostgreSQL 연결 수 확인 kubectl exec deployment/postgres -n openwebui -- \\ psql -U openwebui -d openwebui -c \\ \u0026#34;SELECT count(*) FROM pg_stat_activity WHERE state = \u0026#39;active\u0026#39;;\u0026#34; # 슬로우 쿼리 확인 kubectl exec deployment/postgres -n openwebui -- \\ psql -U openwebui -d openwebui -c \\ \u0026#34;SELECT query, mean_exec_time FROM pg_stat_statements ORDER BY mean_exec_time DESC LIMIT 10;\u0026#34; # 데이터베이스 크기 확인 kubectl exec deployment/postgres -n openwebui -- \\ psql -U openwebui -d openwebui -c \\ \u0026#34;SELECT pg_size_pretty(pg_database_size(\u0026#39;openwebui\u0026#39;));\u0026#34; 🔄 백업 및 복원 데이터베이스 백업 #!/bin/bash # backup-database.sh BACKUP_DATE=$(date +%Y%m%d_%H%M%S) BACKUP_FILE=\u0026#34;openwebui_backup_${BACKUP_DATE}.sql\u0026#34; # PostgreSQL 백업 kubectl exec deployment/postgres -n openwebui -- \\ pg_dump -U openwebui openwebui \u0026gt; $BACKUP_FILE # S3에 업로드 aws s3 cp $BACKUP_FILE s3://openwebui-backups/database/ # 로컬 파일 정리 (7일 이상 된 파일) find . -name \u0026#34;openwebui_backup_*.sql\u0026#34; -mtime +7 -delete echo \u0026#34;✅ 백업 완료: $BACKUP_FILE\u0026#34; 데이터베이스 복원 #!/bin/bash # restore-database.sh BACKUP_FILE=$1 if [ -z \u0026#34;$BACKUP_FILE\u0026#34; ]; then echo \u0026#34;사용법: $0 \u0026lt;backup_file\u0026gt;\u0026#34; exit 1 fi # S3에서 백업 파일 다운로드 aws s3 cp s3://openwebui-backups/database/$BACKUP_FILE . # 애플리케이션 중지 kubectl scale deployment openwebui --replicas=0 -n openwebui kubectl scale deployment litellm --replicas=0 -n litellm # 데이터베이스 복원 kubectl exec -i deployment/postgres -n openwebui -- \\ psql -U openwebui openwebui \u0026lt; $BACKUP_FILE # 애플리케이션 재시작 kubectl scale deployment openwebui --replicas=2 -n openwebui kubectl scale deployment litellm --replicas=2 -n litellm echo \u0026#34;✅ 복원 완료\u0026#34; 설정 파일 백업 # ConfigMap 백업 kubectl get configmap -n openwebui -o yaml \u0026gt; configmaps-backup.yaml kubectl get configmap -n litellm -o yaml \u0026gt;\u0026gt; configmaps-backup.yaml # Secret 백업 (암호화된 형태) kubectl get secret -n openwebui -o yaml \u0026gt; secrets-backup.yaml kubectl get secret -n litellm -o yaml \u0026gt;\u0026gt; secrets-backup.yaml 🚨 장애 대응 긴급 상황 대응 절차 1단계: 상황 파악 (5분 이내) # 전체 상태 빠른 확인 kubectl get pods -A | grep -v Running kubectl get nodes kubectl top nodes # 최근 이벤트 확인 kubectl get events -A --sort-by=\u0026#39;.lastTimestamp\u0026#39; | tail -20 2단계: 임시 조치 (10분 이내) # 파드 재시작 kubectl rollout restart deployment/openwebui -n openwebui # 트래픽 차단 (필요시) kubectl patch ingress openwebui-ingress -n openwebui -p \\ \u0026#39;{\u0026#34;metadata\u0026#34;:{\u0026#34;annotations\u0026#34;:{\u0026#34;nginx.ingress.kubernetes.io/server-snippet\u0026#34;:\u0026#34;return 503;\u0026#34;}}}\u0026#39; # 스케일 다운 (리소스 부족 시) kubectl scale deployment openwebui --replicas=1 -n openwebui 3단계: 근본 원인 분석 # 상세 로그 분석 kubectl logs deployment/openwebui -n openwebui --previous kubectl describe pod -l app=openwebui -n openwebui # 리소스 사용량 분석 kubectl top pods -n openwebui --containers kubectl describe nodes 일반적인 장애 시나리오 파드가 시작되지 않는 경우 # 원인 확인 kubectl describe pod \u0026lt;pod-name\u0026gt; -n openwebui # 일반적인 해결책 # 1. 이미지 문제 kubectl get pods -n openwebui -o jsonpath=\u0026#39;{.items[*].spec.containers[*].image}\u0026#39; # 2. 리소스 부족 kubectl describe nodes | grep -A 5 \u0026#34;Allocated resources\u0026#34; # 3. PVC 마운트 실패 kubectl get pvc -n openwebui kubectl describe pvc \u0026lt;pvc-name\u0026gt; -n openwebui 데이터베이스 연결 실패 # PostgreSQL 상태 확인 kubectl get pods -l app=postgres -n openwebui kubectl logs deployment/postgres -n openwebui # 연결 테스트 kubectl exec deployment/postgres -n openwebui -- pg_isready # 네트워크 연결 확인 kubectl exec deployment/openwebui -n openwebui -- \\ nc -zv postgres-service 5432 높은 응답 시간 # 리소스 사용량 확인 kubectl top pods -n openwebui # HPA 스케일링 강제 실행 kubectl patch hpa openwebui-hpa -n openwebui -p \\ \u0026#39;{\u0026#34;spec\u0026#34;:{\u0026#34;minReplicas\u0026#34;:3}}\u0026#39; # 캐시 클리어 (애플리케이션별 방법) kubectl exec deployment/openwebui -n openwebui -- \\ curl -X POST http://localhost:8080/api/v1/cache/clear 🔧 유지보수 정기 업데이트 #!/bin/bash # update-system.sh echo \u0026#34;🔄 시스템 업데이트 시작...\u0026#34; # 1. EKS 클러스터 업데이트 확인 aws eks describe-cluster --name openwebui-eks-dev \\ --query \u0026#39;cluster.version\u0026#39; --output text # 2. 노드 그룹 업데이트 확인 aws eks describe-nodegroup --cluster-name openwebui-eks-dev \\ --nodegroup-name primary-nodes \\ --query \u0026#39;nodegroup.version\u0026#39; --output text # 3. Add-on 업데이트 kubectl get pods -n kube-system # 4. 애플리케이션 이미지 업데이트 kubectl set image deployment/openwebui openwebui=ghcr.io/openwebui:latest -n openwebui echo \u0026#34;✅ 업데이트 완료\u0026#34; 보안 패치 # 보안 스캔 실행 trivy image ghcr.io/openwebui:latest # 취약점 있는 컨테이너 재배포 kubectl rollout restart deployment/openwebui -n openwebui # 시크릿 로테이션 kubectl create secret generic api-keys \\ --from-literal=OPENAI_API_KEY=new-key \\ --dry-run=client -o yaml | kubectl apply -f - 용량 관리 # 디스크 사용량 모니터링 kubectl get pvc -A -o custom-columns=NAME:.metadata.name,SIZE:.spec.resources.requests.storage,USED:.status.capacity.storage # 로그 정리 kubectl logs deployment/openwebui -n openwebui --tail=1000 \u0026gt; /dev/null # 이미지 정리 (노드에서 직접) docker system prune -a 📈 성능 튜닝 애플리케이션 최적화 # OpenWebUI 성능 설정 env: - name: WEBUI_SECRET_KEY value: \u0026#34;optimized-secret-key\u0026#34; - name: MAX_WORKERS value: \u0026#34;4\u0026#34; - name: TIMEOUT value: \u0026#34;60\u0026#34; - name: KEEP_ALIVE value: \u0026#34;2\u0026#34; 데이터베이스 튜닝 -- PostgreSQL 성능 튜닝 -- 연결 풀 설정 ALTER SYSTEM SET max_connections = 100; ALTER SYSTEM SET shared_buffers = \u0026#39;256MB\u0026#39;; ALTER SYSTEM SET effective_cache_size = \u0026#39;1GB\u0026#39;; ALTER SYSTEM SET work_mem = \u0026#39;4MB\u0026#39;; -- 인덱스 확인 및 최적화 SELECT schemaname, tablename, attname, n_distinct, correlation FROM pg_stats WHERE tablename = \u0026#39;your_table\u0026#39;; 네트워크 최적화 # Ingress 설정 최적화 annotations: nginx.ingress.kubernetes.io/proxy-connect-timeout: \u0026#34;60\u0026#34; nginx.ingress.kubernetes.io/proxy-send-timeout: \u0026#34;60\u0026#34; nginx.ingress.kubernetes.io/proxy-read-timeout: \u0026#34;60\u0026#34; nginx.ingress.kubernetes.io/proxy-body-size: \u0026#34;50m\u0026#34; nginx.ingress.kubernetes.io/enable-cors: \u0026#34;true\u0026#34; 💰 비용 최적화 리소스 사용량 분석 # 노드 비용 분석 kubectl describe nodes | grep -A 3 \u0026#34;Allocated resources\u0026#34; # Spot 인스턴스 활용률 kubectl get nodes -l node.kubernetes.io/instance-type # 사용하지 않는 리소스 정리 kubectl get pods -A --field-selector=status.phase=Succeeded kubectl delete pods --field-selector=status.phase=Succeeded -A 자동 스케일링 최적화 # 비용 효율적인 HPA 설정 spec: minReplicas: 1 # 최소 비용 maxReplicas: 10 # 트래픽 대응 targetCPUUtilizationPercentage: 70 # 적절한 활용률 behavior: scaleDown: stabilizationWindowSeconds: 300 # 급격한 스케일 다운 방지 policies: - type: Percent value: 50 periodSeconds: 60 📞 비상 연락 체계 장애 등급별 대응 P0 (Critical): - 서비스 완전 중단 - 즉시 대응 (24/7) - 연락처: [긴급 연락처] P1 (High): - 주요 기능 장애 - 4시간 이내 대응 - 연락처: [팀 리더] P2 (Medium): - 부분 기능 장애 - 24시간 이내 대응 - 연락처: [담당자] P3 (Low): - 성능 저하 - 72시간 이내 대응 - 연락처: [팀 메일] 에스컬레이션 절차 1차 담당자 (30분 이내 응답) 팀 리더 (1시간 이내) 기술 책임자 (2시간 이내) CTO (4시간 이내) 📚 운영 도구 및 대시보드 필수 도구 # kubectl 플러그인 설치 kubectl krew install ctx ns stern top # 유용한 명령어 별칭 alias k=\u0026#39;kubectl\u0026#39; alias kgp=\u0026#39;kubectl get pods\u0026#39; alias kgs=\u0026#39;kubectl get svc\u0026#39; alias kgn=\u0026#39;kubectl get nodes\u0026#39; alias kdp=\u0026#39;kubectl describe pod\u0026#39; alias kl=\u0026#39;kubectl logs\u0026#39; 모니터링 대시보드 Grafana: http://grafana.your-domain.com Prometheus: http://prometheus.your-domain.com Jaeger: http://jaeger.your-domain.com (트레이싱) ArgoCD: http://argocd.your-domain.com (GitOps) 로그 분석 # 중앙화된 로깅 (ELK Stack) kubectl port-forward svc/kibana 5601:5601 -n logging # 로그 쿼리 예시 # Kibana에서: kubernetes.namespace:\u0026#34;openwebui\u0026#34; AND level:\u0026#34;ERROR\u0026#34; 🔄 정기 작업 스케줄 일일 작업 (자동화) # CronJob 예시 apiVersion: batch/v1 kind: CronJob metadata: name: daily-cleanup spec: schedule: \u0026#34;0 2 * * *\u0026#34; # 매일 오전 2시 jobTemplate: spec: template: spec: containers: - name: cleanup image: alpine:latest command: - /bin/sh - -c - | # 로그 정리 find /var/log -name \u0026#34;*.log\u0026#34; -mtime +7 -delete # 임시 파일 정리 find /tmp -mtime +1 -delete restartPolicy: OnFailure 주간 작업 백업 검증 테스트 보안 스캔 실행 성능 리포트 작성 비용 분석 리포트 월간 작업 DR(재해복구) 테스트 보안 감사 용량 계획 검토 아키텍처 리뷰 이제 완전한 운영 매뉴얼이 준비되었습니다! 🛠️\n",
  "keywords": [
    
  ],
  "articleBody": "🛠️ OpenWebUI 운영 매뉴얼 👥 대상: DevOps 엔지니어, SRE, 시스템 관리자\n📅 업데이트: 정기적으로 업데이트 필요\n🚨 비상 연락처: [팀 연락처 정보]\n📋 일일 운영 체크리스트 매일 확인 항목 #!/bin/bash # daily-check.sh echo \"📅 $(date '+%Y-%m-%d %H:%M:%S') - 일일 운영 체크 시작\" # 1. 클러스터 상태 kubectl get nodes kubectl get pods -A | grep -v Running # 2. 애플리케이션 상태 kubectl get pods -n openwebui -n litellm # 3. 리소스 사용량 kubectl top nodes kubectl top pods -A # 4. 최근 에러 로그 (최근 1시간) kubectl logs --since=1h -n openwebui -l app=openwebui | grep -i error | tail -10 # 5. 디스크 사용량 kubectl get pvc -A echo \"✅ 일일 체크 완료\" 주간 확인 항목 백업 상태 확인 보안 패치 검토 비용 사용량 확인 성능 메트릭 검토 로그 정리 🔍 모니터링 및 알람 핵심 메트릭 # prometheus-alerts.yml groups: - name: openwebui.rules rules: # 파드 상태 알람 - alert: PodCrashLooping expr: rate(kube_pod_container_status_restarts_total[5m]) \u003e 0 for: 5m annotations: summary: \"Pod {{ $labels.pod }} is crash looping\" # 리소스 사용량 알람 - alert: HighCPUUsage expr: (cpu_usage_rate \u003e 80) for: 10m annotations: summary: \"High CPU usage: {{ $value }}%\" # 응답 시간 알람 - alert: HighResponseTime expr: http_request_duration_seconds \u003e 2 for: 5m annotations: summary: \"High response time: {{ $value }}s\" 로그 모니터링 # 실시간 로그 모니터링 kubectl logs -f deployment/openwebui -n openwebui # 에러 로그 검색 kubectl logs deployment/openwebui -n openwebui | grep -E \"(ERROR|FATAL|CRITICAL)\" # 특정 시간대 로그 kubectl logs --since=2h --until=1h deployment/openwebui -n openwebui 📊 성능 관리 스케일링 관리 # 수동 스케일링 kubectl scale deployment openwebui --replicas=5 -n openwebui kubectl scale deployment litellm --replicas=3 -n litellm # HPA 상태 확인 kubectl get hpa -A # 스케일링 이벤트 확인 kubectl describe hpa openwebui-hpa -n openwebui 리소스 최적화 # 리소스 요청량 조정 예시 resources: requests: memory: \"512Mi\" # 실제 사용량 기반 조정 cpu: \"250m\" limits: memory: \"1Gi\" # OOM 방지 cpu: \"500m\" # CPU 스로틀링 방지 데이터베이스 성능 # PostgreSQL 연결 수 확인 kubectl exec deployment/postgres -n openwebui -- \\ psql -U openwebui -d openwebui -c \\ \"SELECT count(*) FROM pg_stat_activity WHERE state = 'active';\" # 슬로우 쿼리 확인 kubectl exec deployment/postgres -n openwebui -- \\ psql -U openwebui -d openwebui -c \\ \"SELECT query, mean_exec_time FROM pg_stat_statements ORDER BY mean_exec_time DESC LIMIT 10;\" # 데이터베이스 크기 확인 kubectl exec deployment/postgres -n openwebui -- \\ psql -U openwebui -d openwebui -c \\ \"SELECT pg_size_pretty(pg_database_size('openwebui'));\" 🔄 백업 및 복원 데이터베이스 백업 #!/bin/bash # backup-database.sh BACKUP_DATE=$(date +%Y%m%d_%H%M%S) BACKUP_FILE=\"openwebui_backup_${BACKUP_DATE}.sql\" # PostgreSQL 백업 kubectl exec deployment/postgres -n openwebui -- \\ pg_dump -U openwebui openwebui \u003e $BACKUP_FILE # S3에 업로드 aws s3 cp $BACKUP_FILE s3://openwebui-backups/database/ # 로컬 파일 정리 (7일 이상 된 파일) find . -name \"openwebui_backup_*.sql\" -mtime +7 -delete echo \"✅ 백업 완료: $BACKUP_FILE\" 데이터베이스 복원 #!/bin/bash # restore-database.sh BACKUP_FILE=$1 if [ -z \"$BACKUP_FILE\" ]; then echo \"사용법: $0 \" exit 1 fi # S3에서 백업 파일 다운로드 aws s3 cp s3://openwebui-backups/database/$BACKUP_FILE . # 애플리케이션 중지 kubectl scale deployment openwebui --replicas=0 -n openwebui kubectl scale deployment litellm --replicas=0 -n litellm # 데이터베이스 복원 kubectl exec -i deployment/postgres -n openwebui -- \\ psql -U openwebui openwebui \u003c $BACKUP_FILE # 애플리케이션 재시작 kubectl scale deployment openwebui --replicas=2 -n openwebui kubectl scale deployment litellm --replicas=2 -n litellm echo \"✅ 복원 완료\" 설정 파일 백업 # ConfigMap 백업 kubectl get configmap -n openwebui -o yaml \u003e configmaps-backup.yaml kubectl get configmap -n litellm -o yaml \u003e\u003e configmaps-backup.yaml # Secret 백업 (암호화된 형태) kubectl get secret -n openwebui -o yaml \u003e secrets-backup.yaml kubectl get secret -n litellm -o yaml \u003e\u003e secrets-backup.yaml 🚨 장애 대응 긴급 상황 대응 절차 1단계: 상황 파악 (5분 이내) # 전체 상태 빠른 확인 kubectl get pods -A | grep -v Running kubectl get nodes kubectl top nodes # 최근 이벤트 확인 kubectl get events -A --sort-by='.lastTimestamp' | tail -20 2단계: 임시 조치 (10분 이내) # 파드 재시작 kubectl rollout restart deployment/openwebui -n openwebui # 트래픽 차단 (필요시) kubectl patch ingress openwebui-ingress -n openwebui -p \\ '{\"metadata\":{\"annotations\":{\"nginx.ingress.kubernetes.io/server-snippet\":\"return 503;\"}}}' # 스케일 다운 (리소스 부족 시) kubectl scale deployment openwebui --replicas=1 -n openwebui 3단계: 근본 원인 분석 # 상세 로그 분석 kubectl logs deployment/openwebui -n openwebui --previous kubectl describe pod -l app=openwebui -n openwebui # 리소스 사용량 분석 kubectl top pods -n openwebui --containers kubectl describe nodes 일반적인 장애 시나리오 파드가 시작되지 않는 경우 # 원인 확인 kubectl describe pod -n openwebui # 일반적인 해결책 # 1. 이미지 문제 kubectl get pods -n openwebui -o jsonpath='{.items[*].spec.containers[*].image}' # 2. 리소스 부족 kubectl describe nodes | grep -A 5 \"Allocated resources\" # 3. PVC 마운트 실패 kubectl get pvc -n openwebui kubectl describe pvc -n openwebui 데이터베이스 연결 실패 # PostgreSQL 상태 확인 kubectl get pods -l app=postgres -n openwebui kubectl logs deployment/postgres -n openwebui # 연결 테스트 kubectl exec deployment/postgres -n openwebui -- pg_isready # 네트워크 연결 확인 kubectl exec deployment/openwebui -n openwebui -- \\ nc -zv postgres-service 5432 높은 응답 시간 # 리소스 사용량 확인 kubectl top pods -n openwebui # HPA 스케일링 강제 실행 kubectl patch hpa openwebui-hpa -n openwebui -p \\ '{\"spec\":{\"minReplicas\":3}}' # 캐시 클리어 (애플리케이션별 방법) kubectl exec deployment/openwebui -n openwebui -- \\ curl -X POST http://localhost:8080/api/v1/cache/clear 🔧 유지보수 정기 업데이트 #!/bin/bash # update-system.sh echo \"🔄 시스템 업데이트 시작...\" # 1. EKS 클러스터 업데이트 확인 aws eks describe-cluster --name openwebui-eks-dev \\ --query 'cluster.version' --output text # 2. 노드 그룹 업데이트 확인 aws eks describe-nodegroup --cluster-name openwebui-eks-dev \\ --nodegroup-name primary-nodes \\ --query 'nodegroup.version' --output text # 3. Add-on 업데이트 kubectl get pods -n kube-system # 4. 애플리케이션 이미지 업데이트 kubectl set image deployment/openwebui openwebui=ghcr.io/openwebui:latest -n openwebui echo \"✅ 업데이트 완료\" 보안 패치 # 보안 스캔 실행 trivy image ghcr.io/openwebui:latest # 취약점 있는 컨테이너 재배포 kubectl rollout restart deployment/openwebui -n openwebui # 시크릿 로테이션 kubectl create secret generic api-keys \\ --from-literal=OPENAI_API_KEY=new-key \\ --dry-run=client -o yaml | kubectl apply -f - 용량 관리 # 디스크 사용량 모니터링 kubectl get pvc -A -o custom-columns=NAME:.metadata.name,SIZE:.spec.resources.requests.storage,USED:.status.capacity.storage # 로그 정리 kubectl logs deployment/openwebui -n openwebui --tail=1000 \u003e /dev/null # 이미지 정리 (노드에서 직접) docker system prune -a 📈 성능 튜닝 애플리케이션 최적화 # OpenWebUI 성능 설정 env: - name: WEBUI_SECRET_KEY value: \"optimized-secret-key\" - name: MAX_WORKERS value: \"4\" - name: TIMEOUT value: \"60\" - name: KEEP_ALIVE value: \"2\" 데이터베이스 튜닝 -- PostgreSQL 성능 튜닝 -- 연결 풀 설정 ALTER SYSTEM SET max_connections = 100; ALTER SYSTEM SET shared_buffers = '256MB'; ALTER SYSTEM SET effective_cache_size = '1GB'; ALTER SYSTEM SET work_mem = '4MB'; -- 인덱스 확인 및 최적화 SELECT schemaname, tablename, attname, n_distinct, correlation FROM pg_stats WHERE tablename = 'your_table'; 네트워크 최적화 # Ingress 설정 최적화 annotations: nginx.ingress.kubernetes.io/proxy-connect-timeout: \"60\" nginx.ingress.kubernetes.io/proxy-send-timeout: \"60\" nginx.ingress.kubernetes.io/proxy-read-timeout: \"60\" nginx.ingress.kubernetes.io/proxy-body-size: \"50m\" nginx.ingress.kubernetes.io/enable-cors: \"true\" 💰 비용 최적화 리소스 사용량 분석 # 노드 비용 분석 kubectl describe nodes | grep -A 3 \"Allocated resources\" # Spot 인스턴스 활용률 kubectl get nodes -l node.kubernetes.io/instance-type # 사용하지 않는 리소스 정리 kubectl get pods -A --field-selector=status.phase=Succeeded kubectl delete pods --field-selector=status.phase=Succeeded -A 자동 스케일링 최적화 # 비용 효율적인 HPA 설정 spec: minReplicas: 1 # 최소 비용 maxReplicas: 10 # 트래픽 대응 targetCPUUtilizationPercentage: 70 # 적절한 활용률 behavior: scaleDown: stabilizationWindowSeconds: 300 # 급격한 스케일 다운 방지 policies: - type: Percent value: 50 periodSeconds: 60 📞 비상 연락 체계 장애 등급별 대응 P0 (Critical): - 서비스 완전 중단 - 즉시 대응 (24/7) - 연락처: [긴급 연락처] P1 (High): - 주요 기능 장애 - 4시간 이내 대응 - 연락처: [팀 리더] P2 (Medium): - 부분 기능 장애 - 24시간 이내 대응 - 연락처: [담당자] P3 (Low): - 성능 저하 - 72시간 이내 대응 - 연락처: [팀 메일] 에스컬레이션 절차 1차 담당자 (30분 이내 응답) 팀 리더 (1시간 이내) 기술 책임자 (2시간 이내) CTO (4시간 이내) 📚 운영 도구 및 대시보드 필수 도구 # kubectl 플러그인 설치 kubectl krew install ctx ns stern top # 유용한 명령어 별칭 alias k='kubectl' alias kgp='kubectl get pods' alias kgs='kubectl get svc' alias kgn='kubectl get nodes' alias kdp='kubectl describe pod' alias kl='kubectl logs' 모니터링 대시보드 Grafana: http://grafana.your-domain.com Prometheus: http://prometheus.your-domain.com Jaeger: http://jaeger.your-domain.com (트레이싱) ArgoCD: http://argocd.your-domain.com (GitOps) 로그 분석 # 중앙화된 로깅 (ELK Stack) kubectl port-forward svc/kibana 5601:5601 -n logging # 로그 쿼리 예시 # Kibana에서: kubernetes.namespace:\"openwebui\" AND level:\"ERROR\" 🔄 정기 작업 스케줄 일일 작업 (자동화) # CronJob 예시 apiVersion: batch/v1 kind: CronJob metadata: name: daily-cleanup spec: schedule: \"0 2 * * *\" # 매일 오전 2시 jobTemplate: spec: template: spec: containers: - name: cleanup image: alpine:latest command: - /bin/sh - -c - | # 로그 정리 find /var/log -name \"*.log\" -mtime +7 -delete # 임시 파일 정리 find /tmp -mtime +1 -delete restartPolicy: OnFailure 주간 작업 백업 검증 테스트 보안 스캔 실행 성능 리포트 작성 비용 분석 리포트 월간 작업 DR(재해복구) 테스트 보안 감사 용량 계획 검토 아키텍처 리뷰 이제 완전한 운영 매뉴얼이 준비되었습니다! 🛠️\n",
  "wordCount" : "1419",
  "inLanguage": "en",
  "datePublished": "0001-01-01T00:00:00Z",
  "dateModified": "0001-01-01T00:00:00Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://8dobibim.github.io/backend/%EC%9A%B4%EC%98%81-%EB%A9%94%EB%89%B4%EC%96%BC/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "8dobibim Tech Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://8dobibim.github.io/%3Clink%20/%20abs%20url%3E"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://8dobibim.github.io/" accesskey="h" title="8dobibim Tech Blog (Alt + H)">8dobibim Tech Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://8dobibim.github.io/frontend/" title="🖥 프론트엔드">
                    <span>🖥 프론트엔드</span>
                </a>
            </li>
            <li>
                <a href="https://8dobibim.github.io/backend/" title="💾 백엔드">
                    <span>💾 백엔드</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://8dobibim.github.io/">Home</a>&nbsp;»&nbsp;<a href="https://8dobibim.github.io/backend/">Backend 문서</a></div>
    <h1 class="post-title entry-hint-parent">
      
    </h1>
    <div class="post-meta">7 min&nbsp;·&nbsp;1419 words

</div>
  </header> <div class="toc">
    <details  open>
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#-openwebui-%ec%9a%b4%ec%98%81-%eb%a7%a4%eb%89%b4%ec%96%bc" aria-label="🛠️ OpenWebUI 운영 매뉴얼">🛠️ OpenWebUI 운영 매뉴얼</a><ul>
                        
                <li>
                    <a href="#-%ec%9d%bc%ec%9d%bc-%ec%9a%b4%ec%98%81-%ec%b2%b4%ed%81%ac%eb%a6%ac%ec%8a%a4%ed%8a%b8" aria-label="📋 일일 운영 체크리스트">📋 일일 운영 체크리스트</a><ul>
                        
                <li>
                    <a href="#%eb%a7%a4%ec%9d%bc-%ed%99%95%ec%9d%b8-%ed%95%ad%eb%aa%a9" aria-label="매일 확인 항목">매일 확인 항목</a></li>
                <li>
                    <a href="#%ec%a3%bc%ea%b0%84-%ed%99%95%ec%9d%b8-%ed%95%ad%eb%aa%a9" aria-label="주간 확인 항목">주간 확인 항목</a></li></ul>
                </li>
                <li>
                    <a href="#-%eb%aa%a8%eb%8b%88%ed%84%b0%eb%a7%81-%eb%b0%8f-%ec%95%8c%eb%9e%8c" aria-label="🔍 모니터링 및 알람">🔍 모니터링 및 알람</a><ul>
                        
                <li>
                    <a href="#%ed%95%b5%ec%8b%ac-%eb%a9%94%ed%8a%b8%eb%a6%ad" aria-label="핵심 메트릭">핵심 메트릭</a></li>
                <li>
                    <a href="#%eb%a1%9c%ea%b7%b8-%eb%aa%a8%eb%8b%88%ed%84%b0%eb%a7%81" aria-label="로그 모니터링">로그 모니터링</a></li></ul>
                </li>
                <li>
                    <a href="#-%ec%84%b1%eb%8a%a5-%ea%b4%80%eb%a6%ac" aria-label="📊 성능 관리">📊 성능 관리</a><ul>
                        
                <li>
                    <a href="#%ec%8a%a4%ec%bc%80%ec%9d%bc%eb%a7%81-%ea%b4%80%eb%a6%ac" aria-label="스케일링 관리">스케일링 관리</a></li>
                <li>
                    <a href="#%eb%a6%ac%ec%86%8c%ec%8a%a4-%ec%b5%9c%ec%a0%81%ed%99%94" aria-label="리소스 최적화">리소스 최적화</a></li>
                <li>
                    <a href="#%eb%8d%b0%ec%9d%b4%ed%84%b0%eb%b2%a0%ec%9d%b4%ec%8a%a4-%ec%84%b1%eb%8a%a5" aria-label="데이터베이스 성능">데이터베이스 성능</a></li></ul>
                </li>
                <li>
                    <a href="#-%eb%b0%b1%ec%97%85-%eb%b0%8f-%eb%b3%b5%ec%9b%90" aria-label="🔄 백업 및 복원">🔄 백업 및 복원</a><ul>
                        
                <li>
                    <a href="#%eb%8d%b0%ec%9d%b4%ed%84%b0%eb%b2%a0%ec%9d%b4%ec%8a%a4-%eb%b0%b1%ec%97%85" aria-label="데이터베이스 백업">데이터베이스 백업</a></li>
                <li>
                    <a href="#%eb%8d%b0%ec%9d%b4%ed%84%b0%eb%b2%a0%ec%9d%b4%ec%8a%a4-%eb%b3%b5%ec%9b%90" aria-label="데이터베이스 복원">데이터베이스 복원</a></li>
                <li>
                    <a href="#%ec%84%a4%ec%a0%95-%ed%8c%8c%ec%9d%bc-%eb%b0%b1%ec%97%85" aria-label="설정 파일 백업">설정 파일 백업</a></li></ul>
                </li>
                <li>
                    <a href="#-%ec%9e%a5%ec%95%a0-%eb%8c%80%ec%9d%91" aria-label="🚨 장애 대응">🚨 장애 대응</a><ul>
                        
                <li>
                    <a href="#%ea%b8%b4%ea%b8%89-%ec%83%81%ed%99%a9-%eb%8c%80%ec%9d%91-%ec%a0%88%ec%b0%a8" aria-label="긴급 상황 대응 절차">긴급 상황 대응 절차</a><ul>
                        
                <li>
                    <a href="#1%eb%8b%a8%ea%b3%84-%ec%83%81%ed%99%a9-%ed%8c%8c%ec%95%85-5%eb%b6%84-%ec%9d%b4%eb%82%b4" aria-label="1단계: 상황 파악 (5분 이내)">1단계: 상황 파악 (5분 이내)</a></li>
                <li>
                    <a href="#2%eb%8b%a8%ea%b3%84-%ec%9e%84%ec%8b%9c-%ec%a1%b0%ec%b9%98-10%eb%b6%84-%ec%9d%b4%eb%82%b4" aria-label="2단계: 임시 조치 (10분 이내)">2단계: 임시 조치 (10분 이내)</a></li>
                <li>
                    <a href="#3%eb%8b%a8%ea%b3%84-%ea%b7%bc%eb%b3%b8-%ec%9b%90%ec%9d%b8-%eb%b6%84%ec%84%9d" aria-label="3단계: 근본 원인 분석">3단계: 근본 원인 분석</a></li></ul>
                </li>
                <li>
                    <a href="#%ec%9d%bc%eb%b0%98%ec%a0%81%ec%9d%b8-%ec%9e%a5%ec%95%a0-%ec%8b%9c%eb%82%98%eb%a6%ac%ec%98%a4" aria-label="일반적인 장애 시나리오">일반적인 장애 시나리오</a><ul>
                        
                <li>
                    <a href="#%ed%8c%8c%eb%93%9c%ea%b0%80-%ec%8b%9c%ec%9e%91%eb%90%98%ec%a7%80-%ec%95%8a%eb%8a%94-%ea%b2%bd%ec%9a%b0" aria-label="파드가 시작되지 않는 경우">파드가 시작되지 않는 경우</a></li>
                <li>
                    <a href="#%eb%8d%b0%ec%9d%b4%ed%84%b0%eb%b2%a0%ec%9d%b4%ec%8a%a4-%ec%97%b0%ea%b2%b0-%ec%8b%a4%ed%8c%a8" aria-label="데이터베이스 연결 실패">데이터베이스 연결 실패</a></li>
                <li>
                    <a href="#%eb%86%92%ec%9d%80-%ec%9d%91%eb%8b%b5-%ec%8b%9c%ea%b0%84" aria-label="높은 응답 시간">높은 응답 시간</a></li></ul>
                </li></ul>
                </li>
                <li>
                    <a href="#-%ec%9c%a0%ec%a7%80%eb%b3%b4%ec%88%98" aria-label="🔧 유지보수">🔧 유지보수</a><ul>
                        
                <li>
                    <a href="#%ec%a0%95%ea%b8%b0-%ec%97%85%eb%8d%b0%ec%9d%b4%ed%8a%b8" aria-label="정기 업데이트">정기 업데이트</a></li>
                <li>
                    <a href="#%eb%b3%b4%ec%95%88-%ed%8c%a8%ec%b9%98" aria-label="보안 패치">보안 패치</a></li>
                <li>
                    <a href="#%ec%9a%a9%eb%9f%89-%ea%b4%80%eb%a6%ac" aria-label="용량 관리">용량 관리</a></li></ul>
                </li>
                <li>
                    <a href="#-%ec%84%b1%eb%8a%a5-%ed%8a%9c%eb%8b%9d" aria-label="📈 성능 튜닝">📈 성능 튜닝</a><ul>
                        
                <li>
                    <a href="#%ec%95%a0%ed%94%8c%eb%a6%ac%ec%bc%80%ec%9d%b4%ec%85%98-%ec%b5%9c%ec%a0%81%ed%99%94" aria-label="애플리케이션 최적화">애플리케이션 최적화</a></li>
                <li>
                    <a href="#%eb%8d%b0%ec%9d%b4%ed%84%b0%eb%b2%a0%ec%9d%b4%ec%8a%a4-%ed%8a%9c%eb%8b%9d" aria-label="데이터베이스 튜닝">데이터베이스 튜닝</a></li>
                <li>
                    <a href="#%eb%84%a4%ed%8a%b8%ec%9b%8c%ed%81%ac-%ec%b5%9c%ec%a0%81%ed%99%94" aria-label="네트워크 최적화">네트워크 최적화</a></li></ul>
                </li>
                <li>
                    <a href="#-%eb%b9%84%ec%9a%a9-%ec%b5%9c%ec%a0%81%ed%99%94" aria-label="💰 비용 최적화">💰 비용 최적화</a><ul>
                        
                <li>
                    <a href="#%eb%a6%ac%ec%86%8c%ec%8a%a4-%ec%82%ac%ec%9a%a9%eb%9f%89-%eb%b6%84%ec%84%9d" aria-label="리소스 사용량 분석">리소스 사용량 분석</a></li>
                <li>
                    <a href="#%ec%9e%90%eb%8f%99-%ec%8a%a4%ec%bc%80%ec%9d%bc%eb%a7%81-%ec%b5%9c%ec%a0%81%ed%99%94" aria-label="자동 스케일링 최적화">자동 스케일링 최적화</a></li></ul>
                </li>
                <li>
                    <a href="#-%eb%b9%84%ec%83%81-%ec%97%b0%eb%9d%bd-%ec%b2%b4%ea%b3%84" aria-label="📞 비상 연락 체계">📞 비상 연락 체계</a><ul>
                        
                <li>
                    <a href="#%ec%9e%a5%ec%95%a0-%eb%93%b1%ea%b8%89%eb%b3%84-%eb%8c%80%ec%9d%91" aria-label="장애 등급별 대응">장애 등급별 대응</a></li>
                <li>
                    <a href="#%ec%97%90%ec%8a%a4%ec%bb%ac%eb%a0%88%ec%9d%b4%ec%85%98-%ec%a0%88%ec%b0%a8" aria-label="에스컬레이션 절차">에스컬레이션 절차</a></li></ul>
                </li>
                <li>
                    <a href="#-%ec%9a%b4%ec%98%81-%eb%8f%84%ea%b5%ac-%eb%b0%8f-%eb%8c%80%ec%8b%9c%eb%b3%b4%eb%93%9c" aria-label="📚 운영 도구 및 대시보드">📚 운영 도구 및 대시보드</a><ul>
                        
                <li>
                    <a href="#%ed%95%84%ec%88%98-%eb%8f%84%ea%b5%ac" aria-label="필수 도구">필수 도구</a></li>
                <li>
                    <a href="#%eb%aa%a8%eb%8b%88%ed%84%b0%eb%a7%81-%eb%8c%80%ec%8b%9c%eb%b3%b4%eb%93%9c" aria-label="모니터링 대시보드">모니터링 대시보드</a></li>
                <li>
                    <a href="#%eb%a1%9c%ea%b7%b8-%eb%b6%84%ec%84%9d" aria-label="로그 분석">로그 분석</a></li></ul>
                </li>
                <li>
                    <a href="#-%ec%a0%95%ea%b8%b0-%ec%9e%91%ec%97%85-%ec%8a%a4%ec%bc%80%ec%a4%84" aria-label="🔄 정기 작업 스케줄">🔄 정기 작업 스케줄</a><ul>
                        
                <li>
                    <a href="#%ec%9d%bc%ec%9d%bc-%ec%9e%91%ec%97%85-%ec%9e%90%eb%8f%99%ed%99%94" aria-label="일일 작업 (자동화)">일일 작업 (자동화)</a></li>
                <li>
                    <a href="#%ec%a3%bc%ea%b0%84-%ec%9e%91%ec%97%85" aria-label="주간 작업">주간 작업</a></li>
                <li>
                    <a href="#%ec%9b%94%ea%b0%84-%ec%9e%91%ec%97%85" aria-label="월간 작업">월간 작업</a>
                </li>
            </ul>
            </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h1 id="-openwebui-운영-매뉴얼">🛠️ OpenWebUI 운영 매뉴얼<a hidden class="anchor" aria-hidden="true" href="#-openwebui-운영-매뉴얼">#</a></h1>
<blockquote>
<p><strong>👥 대상</strong>: DevOps 엔지니어, SRE, 시스템 관리자<br>
<strong>📅 업데이트</strong>: 정기적으로 업데이트 필요<br>
<strong>🚨 비상 연락처</strong>: [팀 연락처 정보]</p></blockquote>
<hr>
<h2 id="-일일-운영-체크리스트">📋 일일 운영 체크리스트<a hidden class="anchor" aria-hidden="true" href="#-일일-운영-체크리스트">#</a></h2>
<h3 id="매일-확인-항목">매일 확인 항목<a hidden class="anchor" aria-hidden="true" href="#매일-확인-항목">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">#!/bin/bash
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#75715e"># daily-check.sh</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;📅 </span><span style="color:#66d9ef">$(</span>date <span style="color:#e6db74">&#39;+%Y-%m-%d %H:%M:%S&#39;</span><span style="color:#66d9ef">)</span><span style="color:#e6db74"> - 일일 운영 체크 시작&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 1. 클러스터 상태</span>
</span></span><span style="display:flex;"><span>kubectl get nodes
</span></span><span style="display:flex;"><span>kubectl get pods -A | grep -v Running
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 2. 애플리케이션 상태</span>
</span></span><span style="display:flex;"><span>kubectl get pods -n openwebui -n litellm
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 3. 리소스 사용량</span>
</span></span><span style="display:flex;"><span>kubectl top nodes
</span></span><span style="display:flex;"><span>kubectl top pods -A
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 4. 최근 에러 로그 (최근 1시간)</span>
</span></span><span style="display:flex;"><span>kubectl logs --since<span style="color:#f92672">=</span>1h -n openwebui -l app<span style="color:#f92672">=</span>openwebui | grep -i error | tail -10
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 5. 디스크 사용량</span>
</span></span><span style="display:flex;"><span>kubectl get pvc -A
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;✅ 일일 체크 완료&#34;</span>
</span></span></code></pre></div><h3 id="주간-확인-항목">주간 확인 항목<a hidden class="anchor" aria-hidden="true" href="#주간-확인-항목">#</a></h3>
<ul>
<li><input disabled="" type="checkbox"> 백업 상태 확인</li>
<li><input disabled="" type="checkbox"> 보안 패치 검토</li>
<li><input disabled="" type="checkbox"> 비용 사용량 확인</li>
<li><input disabled="" type="checkbox"> 성능 메트릭 검토</li>
<li><input disabled="" type="checkbox"> 로그 정리</li>
</ul>
<hr>
<h2 id="-모니터링-및-알람">🔍 모니터링 및 알람<a hidden class="anchor" aria-hidden="true" href="#-모니터링-및-알람">#</a></h2>
<h3 id="핵심-메트릭">핵심 메트릭<a hidden class="anchor" aria-hidden="true" href="#핵심-메트릭">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#75715e"># prometheus-alerts.yml</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">groups</span>:
</span></span><span style="display:flex;"><span>- <span style="color:#f92672">name</span>: <span style="color:#ae81ff">openwebui.rules</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">rules</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># 파드 상태 알람</span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">alert</span>: <span style="color:#ae81ff">PodCrashLooping</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">expr</span>: <span style="color:#ae81ff">rate(kube_pod_container_status_restarts_total[5m]) &gt; 0</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">for</span>: <span style="color:#ae81ff">5m</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">annotations</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">summary</span>: <span style="color:#e6db74">&#34;Pod {{ $labels.pod }} is crash looping&#34;</span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># 리소스 사용량 알람</span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">alert</span>: <span style="color:#ae81ff">HighCPUUsage</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">expr</span>: <span style="color:#ae81ff">(cpu_usage_rate &gt; 80)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">for</span>: <span style="color:#ae81ff">10m</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">annotations</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">summary</span>: <span style="color:#e6db74">&#34;High CPU usage: {{ $value }}%&#34;</span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># 응답 시간 알람</span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">alert</span>: <span style="color:#ae81ff">HighResponseTime</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">expr</span>: <span style="color:#ae81ff">http_request_duration_seconds &gt; 2</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">for</span>: <span style="color:#ae81ff">5m</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">annotations</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">summary</span>: <span style="color:#e6db74">&#34;High response time: {{ $value }}s&#34;</span>
</span></span></code></pre></div><h3 id="로그-모니터링">로그 모니터링<a hidden class="anchor" aria-hidden="true" href="#로그-모니터링">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 실시간 로그 모니터링</span>
</span></span><span style="display:flex;"><span>kubectl logs -f deployment/openwebui -n openwebui
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 에러 로그 검색</span>
</span></span><span style="display:flex;"><span>kubectl logs deployment/openwebui -n openwebui | grep -E <span style="color:#e6db74">&#34;(ERROR|FATAL|CRITICAL)&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 특정 시간대 로그</span>
</span></span><span style="display:flex;"><span>kubectl logs --since<span style="color:#f92672">=</span>2h --until<span style="color:#f92672">=</span>1h deployment/openwebui -n openwebui
</span></span></code></pre></div><hr>
<h2 id="-성능-관리">📊 성능 관리<a hidden class="anchor" aria-hidden="true" href="#-성능-관리">#</a></h2>
<h3 id="스케일링-관리">스케일링 관리<a hidden class="anchor" aria-hidden="true" href="#스케일링-관리">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 수동 스케일링</span>
</span></span><span style="display:flex;"><span>kubectl scale deployment openwebui --replicas<span style="color:#f92672">=</span><span style="color:#ae81ff">5</span> -n openwebui
</span></span><span style="display:flex;"><span>kubectl scale deployment litellm --replicas<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span> -n litellm
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># HPA 상태 확인</span>
</span></span><span style="display:flex;"><span>kubectl get hpa -A
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 스케일링 이벤트 확인</span>
</span></span><span style="display:flex;"><span>kubectl describe hpa openwebui-hpa -n openwebui
</span></span></code></pre></div><h3 id="리소스-최적화">리소스 최적화<a hidden class="anchor" aria-hidden="true" href="#리소스-최적화">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#75715e"># 리소스 요청량 조정 예시</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">resources</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">requests</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">memory</span>: <span style="color:#e6db74">&#34;512Mi&#34;</span>    <span style="color:#75715e"># 실제 사용량 기반 조정</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">cpu</span>: <span style="color:#e6db74">&#34;250m&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">limits</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">memory</span>: <span style="color:#e6db74">&#34;1Gi&#34;</span>      <span style="color:#75715e"># OOM 방지</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">cpu</span>: <span style="color:#e6db74">&#34;500m&#34;</span>        <span style="color:#75715e"># CPU 스로틀링 방지</span>
</span></span></code></pre></div><h3 id="데이터베이스-성능">데이터베이스 성능<a hidden class="anchor" aria-hidden="true" href="#데이터베이스-성능">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># PostgreSQL 연결 수 확인</span>
</span></span><span style="display:flex;"><span>kubectl exec deployment/postgres -n openwebui -- <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  psql -U openwebui -d openwebui -c <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  <span style="color:#e6db74">&#34;SELECT count(*) FROM pg_stat_activity WHERE state = &#39;active&#39;;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 슬로우 쿼리 확인</span>
</span></span><span style="display:flex;"><span>kubectl exec deployment/postgres -n openwebui -- <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  psql -U openwebui -d openwebui -c <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  <span style="color:#e6db74">&#34;SELECT query, mean_exec_time FROM pg_stat_statements ORDER BY mean_exec_time DESC LIMIT 10;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 데이터베이스 크기 확인</span>
</span></span><span style="display:flex;"><span>kubectl exec deployment/postgres -n openwebui -- <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  psql -U openwebui -d openwebui -c <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  <span style="color:#e6db74">&#34;SELECT pg_size_pretty(pg_database_size(&#39;openwebui&#39;));&#34;</span>
</span></span></code></pre></div><hr>
<h2 id="-백업-및-복원">🔄 백업 및 복원<a hidden class="anchor" aria-hidden="true" href="#-백업-및-복원">#</a></h2>
<h3 id="데이터베이스-백업">데이터베이스 백업<a hidden class="anchor" aria-hidden="true" href="#데이터베이스-백업">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">#!/bin/bash
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#75715e"># backup-database.sh</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>BACKUP_DATE<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>date +%Y%m%d_%H%M%S<span style="color:#66d9ef">)</span>
</span></span><span style="display:flex;"><span>BACKUP_FILE<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;openwebui_backup_</span><span style="color:#e6db74">${</span>BACKUP_DATE<span style="color:#e6db74">}</span><span style="color:#e6db74">.sql&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># PostgreSQL 백업</span>
</span></span><span style="display:flex;"><span>kubectl exec deployment/postgres -n openwebui -- <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  pg_dump -U openwebui openwebui &gt; $BACKUP_FILE
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># S3에 업로드</span>
</span></span><span style="display:flex;"><span>aws s3 cp $BACKUP_FILE s3://openwebui-backups/database/
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 로컬 파일 정리 (7일 이상 된 파일)</span>
</span></span><span style="display:flex;"><span>find . -name <span style="color:#e6db74">&#34;openwebui_backup_*.sql&#34;</span> -mtime +7 -delete
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;✅ 백업 완료: </span>$BACKUP_FILE<span style="color:#e6db74">&#34;</span>
</span></span></code></pre></div><h3 id="데이터베이스-복원">데이터베이스 복원<a hidden class="anchor" aria-hidden="true" href="#데이터베이스-복원">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">#!/bin/bash
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#75715e"># restore-database.sh</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>BACKUP_FILE<span style="color:#f92672">=</span>$1
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> -z <span style="color:#e6db74">&#34;</span>$BACKUP_FILE<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>  echo <span style="color:#e6db74">&#34;사용법: </span>$0<span style="color:#e6db74"> &lt;backup_file&gt;&#34;</span>
</span></span><span style="display:flex;"><span>  exit <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># S3에서 백업 파일 다운로드</span>
</span></span><span style="display:flex;"><span>aws s3 cp s3://openwebui-backups/database/$BACKUP_FILE .
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 애플리케이션 중지</span>
</span></span><span style="display:flex;"><span>kubectl scale deployment openwebui --replicas<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span> -n openwebui
</span></span><span style="display:flex;"><span>kubectl scale deployment litellm --replicas<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span> -n litellm
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 데이터베이스 복원</span>
</span></span><span style="display:flex;"><span>kubectl exec -i deployment/postgres -n openwebui -- <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  psql -U openwebui openwebui &lt; $BACKUP_FILE
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 애플리케이션 재시작</span>
</span></span><span style="display:flex;"><span>kubectl scale deployment openwebui --replicas<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span> -n openwebui
</span></span><span style="display:flex;"><span>kubectl scale deployment litellm --replicas<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span> -n litellm
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;✅ 복원 완료&#34;</span>
</span></span></code></pre></div><h3 id="설정-파일-백업">설정 파일 백업<a hidden class="anchor" aria-hidden="true" href="#설정-파일-백업">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># ConfigMap 백업</span>
</span></span><span style="display:flex;"><span>kubectl get configmap -n openwebui -o yaml &gt; configmaps-backup.yaml
</span></span><span style="display:flex;"><span>kubectl get configmap -n litellm -o yaml &gt;&gt; configmaps-backup.yaml
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Secret 백업 (암호화된 형태)</span>
</span></span><span style="display:flex;"><span>kubectl get secret -n openwebui -o yaml &gt; secrets-backup.yaml
</span></span><span style="display:flex;"><span>kubectl get secret -n litellm -o yaml &gt;&gt; secrets-backup.yaml
</span></span></code></pre></div><hr>
<h2 id="-장애-대응">🚨 장애 대응<a hidden class="anchor" aria-hidden="true" href="#-장애-대응">#</a></h2>
<h3 id="긴급-상황-대응-절차">긴급 상황 대응 절차<a hidden class="anchor" aria-hidden="true" href="#긴급-상황-대응-절차">#</a></h3>
<h4 id="1단계-상황-파악-5분-이내">1단계: 상황 파악 (5분 이내)<a hidden class="anchor" aria-hidden="true" href="#1단계-상황-파악-5분-이내">#</a></h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 전체 상태 빠른 확인</span>
</span></span><span style="display:flex;"><span>kubectl get pods -A | grep -v Running
</span></span><span style="display:flex;"><span>kubectl get nodes
</span></span><span style="display:flex;"><span>kubectl top nodes
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 최근 이벤트 확인</span>
</span></span><span style="display:flex;"><span>kubectl get events -A --sort-by<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;.lastTimestamp&#39;</span> | tail -20
</span></span></code></pre></div><h4 id="2단계-임시-조치-10분-이내">2단계: 임시 조치 (10분 이내)<a hidden class="anchor" aria-hidden="true" href="#2단계-임시-조치-10분-이내">#</a></h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 파드 재시작</span>
</span></span><span style="display:flex;"><span>kubectl rollout restart deployment/openwebui -n openwebui
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 트래픽 차단 (필요시)</span>
</span></span><span style="display:flex;"><span>kubectl patch ingress openwebui-ingress -n openwebui -p <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  <span style="color:#e6db74">&#39;{&#34;metadata&#34;:{&#34;annotations&#34;:{&#34;nginx.ingress.kubernetes.io/server-snippet&#34;:&#34;return 503;&#34;}}}&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 스케일 다운 (리소스 부족 시)</span>
</span></span><span style="display:flex;"><span>kubectl scale deployment openwebui --replicas<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span> -n openwebui
</span></span></code></pre></div><h4 id="3단계-근본-원인-분석">3단계: 근본 원인 분석<a hidden class="anchor" aria-hidden="true" href="#3단계-근본-원인-분석">#</a></h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 상세 로그 분석</span>
</span></span><span style="display:flex;"><span>kubectl logs deployment/openwebui -n openwebui --previous
</span></span><span style="display:flex;"><span>kubectl describe pod -l app<span style="color:#f92672">=</span>openwebui -n openwebui
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 리소스 사용량 분석</span>
</span></span><span style="display:flex;"><span>kubectl top pods -n openwebui --containers
</span></span><span style="display:flex;"><span>kubectl describe nodes
</span></span></code></pre></div><h3 id="일반적인-장애-시나리오">일반적인 장애 시나리오<a hidden class="anchor" aria-hidden="true" href="#일반적인-장애-시나리오">#</a></h3>
<h4 id="파드가-시작되지-않는-경우">파드가 시작되지 않는 경우<a hidden class="anchor" aria-hidden="true" href="#파드가-시작되지-않는-경우">#</a></h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 원인 확인</span>
</span></span><span style="display:flex;"><span>kubectl describe pod &lt;pod-name&gt; -n openwebui
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 일반적인 해결책</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 1. 이미지 문제</span>
</span></span><span style="display:flex;"><span>kubectl get pods -n openwebui -o jsonpath<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;{.items[*].spec.containers[*].image}&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 2. 리소스 부족</span>
</span></span><span style="display:flex;"><span>kubectl describe nodes | grep -A <span style="color:#ae81ff">5</span> <span style="color:#e6db74">&#34;Allocated resources&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 3. PVC 마운트 실패</span>
</span></span><span style="display:flex;"><span>kubectl get pvc -n openwebui
</span></span><span style="display:flex;"><span>kubectl describe pvc &lt;pvc-name&gt; -n openwebui
</span></span></code></pre></div><h4 id="데이터베이스-연결-실패">데이터베이스 연결 실패<a hidden class="anchor" aria-hidden="true" href="#데이터베이스-연결-실패">#</a></h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># PostgreSQL 상태 확인</span>
</span></span><span style="display:flex;"><span>kubectl get pods -l app<span style="color:#f92672">=</span>postgres -n openwebui
</span></span><span style="display:flex;"><span>kubectl logs deployment/postgres -n openwebui
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 연결 테스트</span>
</span></span><span style="display:flex;"><span>kubectl exec deployment/postgres -n openwebui -- pg_isready
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 네트워크 연결 확인</span>
</span></span><span style="display:flex;"><span>kubectl exec deployment/openwebui -n openwebui -- <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  nc -zv postgres-service <span style="color:#ae81ff">5432</span>
</span></span></code></pre></div><h4 id="높은-응답-시간">높은 응답 시간<a hidden class="anchor" aria-hidden="true" href="#높은-응답-시간">#</a></h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 리소스 사용량 확인</span>
</span></span><span style="display:flex;"><span>kubectl top pods -n openwebui
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># HPA 스케일링 강제 실행</span>
</span></span><span style="display:flex;"><span>kubectl patch hpa openwebui-hpa -n openwebui -p <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  <span style="color:#e6db74">&#39;{&#34;spec&#34;:{&#34;minReplicas&#34;:3}}&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 캐시 클리어 (애플리케이션별 방법)</span>
</span></span><span style="display:flex;"><span>kubectl exec deployment/openwebui -n openwebui -- <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  curl -X POST http://localhost:8080/api/v1/cache/clear
</span></span></code></pre></div><hr>
<h2 id="-유지보수">🔧 유지보수<a hidden class="anchor" aria-hidden="true" href="#-유지보수">#</a></h2>
<h3 id="정기-업데이트">정기 업데이트<a hidden class="anchor" aria-hidden="true" href="#정기-업데이트">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">#!/bin/bash
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#75715e"># update-system.sh</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;🔄 시스템 업데이트 시작...&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 1. EKS 클러스터 업데이트 확인</span>
</span></span><span style="display:flex;"><span>aws eks describe-cluster --name openwebui-eks-dev <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  --query <span style="color:#e6db74">&#39;cluster.version&#39;</span> --output text
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 2. 노드 그룹 업데이트 확인</span>
</span></span><span style="display:flex;"><span>aws eks describe-nodegroup --cluster-name openwebui-eks-dev <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  --nodegroup-name primary-nodes <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  --query <span style="color:#e6db74">&#39;nodegroup.version&#39;</span> --output text
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 3. Add-on 업데이트</span>
</span></span><span style="display:flex;"><span>kubectl get pods -n kube-system
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 4. 애플리케이션 이미지 업데이트</span>
</span></span><span style="display:flex;"><span>kubectl set image deployment/openwebui openwebui<span style="color:#f92672">=</span>ghcr.io/openwebui:latest -n openwebui
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;✅ 업데이트 완료&#34;</span>
</span></span></code></pre></div><h3 id="보안-패치">보안 패치<a hidden class="anchor" aria-hidden="true" href="#보안-패치">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 보안 스캔 실행</span>
</span></span><span style="display:flex;"><span>trivy image ghcr.io/openwebui:latest
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 취약점 있는 컨테이너 재배포</span>
</span></span><span style="display:flex;"><span>kubectl rollout restart deployment/openwebui -n openwebui
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 시크릿 로테이션</span>
</span></span><span style="display:flex;"><span>kubectl create secret generic api-keys <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  --from-literal<span style="color:#f92672">=</span>OPENAI_API_KEY<span style="color:#f92672">=</span>new-key <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  --dry-run<span style="color:#f92672">=</span>client -o yaml | kubectl apply -f -
</span></span></code></pre></div><h3 id="용량-관리">용량 관리<a hidden class="anchor" aria-hidden="true" href="#용량-관리">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 디스크 사용량 모니터링</span>
</span></span><span style="display:flex;"><span>kubectl get pvc -A -o custom-columns<span style="color:#f92672">=</span>NAME:.metadata.name,SIZE:.spec.resources.requests.storage,USED:.status.capacity.storage
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 로그 정리</span>
</span></span><span style="display:flex;"><span>kubectl logs deployment/openwebui -n openwebui --tail<span style="color:#f92672">=</span><span style="color:#ae81ff">1000</span> &gt; /dev/null
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 이미지 정리 (노드에서 직접)</span>
</span></span><span style="display:flex;"><span>docker system prune -a
</span></span></code></pre></div><hr>
<h2 id="-성능-튜닝">📈 성능 튜닝<a hidden class="anchor" aria-hidden="true" href="#-성능-튜닝">#</a></h2>
<h3 id="애플리케이션-최적화">애플리케이션 최적화<a hidden class="anchor" aria-hidden="true" href="#애플리케이션-최적화">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#75715e"># OpenWebUI 성능 설정</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">env</span>:
</span></span><span style="display:flex;"><span>- <span style="color:#f92672">name</span>: <span style="color:#ae81ff">WEBUI_SECRET_KEY</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">value</span>: <span style="color:#e6db74">&#34;optimized-secret-key&#34;</span>
</span></span><span style="display:flex;"><span>- <span style="color:#f92672">name</span>: <span style="color:#ae81ff">MAX_WORKERS</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">value</span>: <span style="color:#e6db74">&#34;4&#34;</span>
</span></span><span style="display:flex;"><span>- <span style="color:#f92672">name</span>: <span style="color:#ae81ff">TIMEOUT</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">value</span>: <span style="color:#e6db74">&#34;60&#34;</span>
</span></span><span style="display:flex;"><span>- <span style="color:#f92672">name</span>: <span style="color:#ae81ff">KEEP_ALIVE</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">value</span>: <span style="color:#e6db74">&#34;2&#34;</span>
</span></span></code></pre></div><h3 id="데이터베이스-튜닝">데이터베이스 튜닝<a hidden class="anchor" aria-hidden="true" href="#데이터베이스-튜닝">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#75715e">-- PostgreSQL 성능 튜닝
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">-- 연결 풀 설정
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">ALTER</span> <span style="color:#66d9ef">SYSTEM</span> <span style="color:#66d9ef">SET</span> max_connections <span style="color:#f92672">=</span> <span style="color:#ae81ff">100</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">ALTER</span> <span style="color:#66d9ef">SYSTEM</span> <span style="color:#66d9ef">SET</span> shared_buffers <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;256MB&#39;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">ALTER</span> <span style="color:#66d9ef">SYSTEM</span> <span style="color:#66d9ef">SET</span> effective_cache_size <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;1GB&#39;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">ALTER</span> <span style="color:#66d9ef">SYSTEM</span> <span style="color:#66d9ef">SET</span> work_mem <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;4MB&#39;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">-- 인덱스 확인 및 최적화
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">SELECT</span> schemaname, tablename, attname, n_distinct, correlation 
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> pg_stats <span style="color:#66d9ef">WHERE</span> tablename <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;your_table&#39;</span>;
</span></span></code></pre></div><h3 id="네트워크-최적화">네트워크 최적화<a hidden class="anchor" aria-hidden="true" href="#네트워크-최적화">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#75715e"># Ingress 설정 최적화</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">annotations</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">nginx.ingress.kubernetes.io/proxy-connect-timeout</span>: <span style="color:#e6db74">&#34;60&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">nginx.ingress.kubernetes.io/proxy-send-timeout</span>: <span style="color:#e6db74">&#34;60&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">nginx.ingress.kubernetes.io/proxy-read-timeout</span>: <span style="color:#e6db74">&#34;60&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">nginx.ingress.kubernetes.io/proxy-body-size</span>: <span style="color:#e6db74">&#34;50m&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">nginx.ingress.kubernetes.io/enable-cors</span>: <span style="color:#e6db74">&#34;true&#34;</span>
</span></span></code></pre></div><hr>
<h2 id="-비용-최적화">💰 비용 최적화<a hidden class="anchor" aria-hidden="true" href="#-비용-최적화">#</a></h2>
<h3 id="리소스-사용량-분석">리소스 사용량 분석<a hidden class="anchor" aria-hidden="true" href="#리소스-사용량-분석">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 노드 비용 분석</span>
</span></span><span style="display:flex;"><span>kubectl describe nodes | grep -A <span style="color:#ae81ff">3</span> <span style="color:#e6db74">&#34;Allocated resources&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Spot 인스턴스 활용률</span>
</span></span><span style="display:flex;"><span>kubectl get nodes -l node.kubernetes.io/instance-type
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 사용하지 않는 리소스 정리</span>
</span></span><span style="display:flex;"><span>kubectl get pods -A --field-selector<span style="color:#f92672">=</span>status.phase<span style="color:#f92672">=</span>Succeeded
</span></span><span style="display:flex;"><span>kubectl delete pods --field-selector<span style="color:#f92672">=</span>status.phase<span style="color:#f92672">=</span>Succeeded -A
</span></span></code></pre></div><h3 id="자동-스케일링-최적화">자동 스케일링 최적화<a hidden class="anchor" aria-hidden="true" href="#자동-스케일링-최적화">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#75715e"># 비용 효율적인 HPA 설정</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">spec</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">minReplicas</span>: <span style="color:#ae81ff">1</span>        <span style="color:#75715e"># 최소 비용</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">maxReplicas</span>: <span style="color:#ae81ff">10</span>       <span style="color:#75715e"># 트래픽 대응</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">targetCPUUtilizationPercentage</span>: <span style="color:#ae81ff">70</span>  <span style="color:#75715e"># 적절한 활용률</span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">behavior</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">scaleDown</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">stabilizationWindowSeconds</span>: <span style="color:#ae81ff">300</span>  <span style="color:#75715e"># 급격한 스케일 다운 방지</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">policies</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">type</span>: <span style="color:#ae81ff">Percent</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">value</span>: <span style="color:#ae81ff">50</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">periodSeconds</span>: <span style="color:#ae81ff">60</span>
</span></span></code></pre></div><hr>
<h2 id="-비상-연락-체계">📞 비상 연락 체계<a hidden class="anchor" aria-hidden="true" href="#-비상-연락-체계">#</a></h2>
<h3 id="장애-등급별-대응">장애 등급별 대응<a hidden class="anchor" aria-hidden="true" href="#장애-등급별-대응">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">P0 (Critical)</span>: 
</span></span><span style="display:flex;"><span>  - <span style="color:#ae81ff">서비스 완전 중단</span>
</span></span><span style="display:flex;"><span>  - <span style="color:#ae81ff">즉시 대응 (24/7)</span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">연락처</span>: [<span style="color:#ae81ff">긴급 연락처]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">P1 (High)</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#ae81ff">주요 기능 장애</span>
</span></span><span style="display:flex;"><span>  - <span style="color:#ae81ff">4시간 이내 대응</span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">연락처</span>: [<span style="color:#ae81ff">팀 리더]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">P2 (Medium)</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#ae81ff">부분 기능 장애  </span>
</span></span><span style="display:flex;"><span>  - <span style="color:#ae81ff">24시간 이내 대응</span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">연락처</span>: [<span style="color:#ae81ff">담당자]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">P3 (Low)</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#ae81ff">성능 저하</span>
</span></span><span style="display:flex;"><span>  - <span style="color:#ae81ff">72시간 이내 대응</span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">연락처</span>: [<span style="color:#ae81ff">팀 메일]</span>
</span></span></code></pre></div><h3 id="에스컬레이션-절차">에스컬레이션 절차<a hidden class="anchor" aria-hidden="true" href="#에스컬레이션-절차">#</a></h3>
<ol>
<li>1차 담당자 (30분 이내 응답)</li>
<li>팀 리더 (1시간 이내)</li>
<li>기술 책임자 (2시간 이내)</li>
<li>CTO (4시간 이내)</li>
</ol>
<hr>
<h2 id="-운영-도구-및-대시보드">📚 운영 도구 및 대시보드<a hidden class="anchor" aria-hidden="true" href="#-운영-도구-및-대시보드">#</a></h2>
<h3 id="필수-도구">필수 도구<a hidden class="anchor" aria-hidden="true" href="#필수-도구">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># kubectl 플러그인 설치</span>
</span></span><span style="display:flex;"><span>kubectl krew install ctx ns stern top
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 유용한 명령어 별칭</span>
</span></span><span style="display:flex;"><span>alias k<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;kubectl&#39;</span>
</span></span><span style="display:flex;"><span>alias kgp<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;kubectl get pods&#39;</span>
</span></span><span style="display:flex;"><span>alias kgs<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;kubectl get svc&#39;</span> 
</span></span><span style="display:flex;"><span>alias kgn<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;kubectl get nodes&#39;</span>
</span></span><span style="display:flex;"><span>alias kdp<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;kubectl describe pod&#39;</span>
</span></span><span style="display:flex;"><span>alias kl<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;kubectl logs&#39;</span>
</span></span></code></pre></div><h3 id="모니터링-대시보드">모니터링 대시보드<a hidden class="anchor" aria-hidden="true" href="#모니터링-대시보드">#</a></h3>
<ul>
<li><strong>Grafana</strong>: <code>http://grafana.your-domain.com</code></li>
<li><strong>Prometheus</strong>: <code>http://prometheus.your-domain.com</code></li>
<li><strong>Jaeger</strong>: <code>http://jaeger.your-domain.com</code> (트레이싱)</li>
<li><strong>ArgoCD</strong>: <code>http://argocd.your-domain.com</code> (GitOps)</li>
</ul>
<h3 id="로그-분석">로그 분석<a hidden class="anchor" aria-hidden="true" href="#로그-분석">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 중앙화된 로깅 (ELK Stack)</span>
</span></span><span style="display:flex;"><span>kubectl port-forward svc/kibana 5601:5601 -n logging
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 로그 쿼리 예시</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Kibana에서: kubernetes.namespace:&#34;openwebui&#34; AND level:&#34;ERROR&#34;</span>
</span></span></code></pre></div><hr>
<h2 id="-정기-작업-스케줄">🔄 정기 작업 스케줄<a hidden class="anchor" aria-hidden="true" href="#-정기-작업-스케줄">#</a></h2>
<h3 id="일일-작업-자동화">일일 작업 (자동화)<a hidden class="anchor" aria-hidden="true" href="#일일-작업-자동화">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#75715e"># CronJob 예시</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">batch/v1</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">CronJob</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">metadata</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">daily-cleanup</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">spec</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">schedule</span>: <span style="color:#e6db74">&#34;0 2 * * *&#34;</span>  <span style="color:#75715e"># 매일 오전 2시</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">jobTemplate</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">spec</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">template</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">spec</span>:
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">containers</span>:
</span></span><span style="display:flex;"><span>          - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">cleanup</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">image</span>: <span style="color:#ae81ff">alpine:latest</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">command</span>:
</span></span><span style="display:flex;"><span>            - <span style="color:#ae81ff">/bin/sh</span>
</span></span><span style="display:flex;"><span>            - -<span style="color:#ae81ff">c</span>
</span></span><span style="display:flex;"><span>            - |<span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">              # 로그 정리
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">              find /var/log -name &#34;*.log&#34; -mtime +7 -delete
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">              # 임시 파일 정리
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">              find /tmp -mtime +1 -delete</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">restartPolicy</span>: <span style="color:#ae81ff">OnFailure</span>
</span></span></code></pre></div><h3 id="주간-작업">주간 작업<a hidden class="anchor" aria-hidden="true" href="#주간-작업">#</a></h3>
<ul>
<li>백업 검증 테스트</li>
<li>보안 스캔 실행</li>
<li>성능 리포트 작성</li>
<li>비용 분석 리포트</li>
</ul>
<h3 id="월간-작업">월간 작업<a hidden class="anchor" aria-hidden="true" href="#월간-작업">#</a></h3>
<ul>
<li>DR(재해복구) 테스트</li>
<li>보안 감사</li>
<li>용량 계획 검토</li>
<li>아키텍처 리뷰</li>
</ul>
<p>이제 완전한 운영 매뉴얼이 준비되었습니다! 🛠️</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
<nav class="paginav">
  <a class="prev" href="https://8dobibim.github.io/backend/%EC%95%A0%ED%94%8C%EB%A6%AC%EC%BC%80%EC%9D%B4%EC%85%98-%EB%B0%B0%ED%8F%AC-%EA%B0%80%EC%9D%B4%EB%93%9C/">
    <span class="title">« Prev</span>
    <br>
    <span></span>
  </a>
  <a class="next" href="https://8dobibim.github.io/backend/%ED%8A%B8%EB%9F%AC%EB%B8%94%EC%8A%88%ED%8C%85-%EA%B0%80%EC%9D%B4%EB%93%9C--faq/">
    <span class="title">Next »</span>
    <br>
    <span></span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="https://8dobibim.github.io/">8dobibim Tech Blog</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
