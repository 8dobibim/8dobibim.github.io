<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>8dobibim Tech Blog</title>
<meta name="keywords" content="">
<meta name="description" content="ğŸ› ï¸ OpenWebUI ìš´ì˜ ë§¤ë‰´ì–¼

ğŸ‘¥ ëŒ€ìƒ: DevOps ì—”ì§€ë‹ˆì–´, SRE, ì‹œìŠ¤í…œ ê´€ë¦¬ì
ğŸ“… ì—…ë°ì´íŠ¸: ì •ê¸°ì ìœ¼ë¡œ ì—…ë°ì´íŠ¸ í•„ìš”
ğŸš¨ ë¹„ìƒ ì—°ë½ì²˜: [íŒ€ ì—°ë½ì²˜ ì •ë³´]

ğŸ“‹ ì¼ì¼ ìš´ì˜ ì²´í¬ë¦¬ìŠ¤íŠ¸
ë§¤ì¼ í™•ì¸ í•­ëª©
#!/bin/bash
# daily-check.sh

echo &#34;ğŸ“… $(date &#39;&#43;%Y-%m-%d %H:%M:%S&#39;) - ì¼ì¼ ìš´ì˜ ì²´í¬ ì‹œì‘&#34;

# 1. í´ëŸ¬ìŠ¤í„° ìƒíƒœ
kubectl get nodes
kubectl get pods -A | grep -v Running

# 2. ì• í”Œë¦¬ì¼€ì´ì…˜ ìƒíƒœ
kubectl get pods -n openwebui -n litellm

# 3. ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰
kubectl top nodes
kubectl top pods -A

# 4. ìµœê·¼ ì—ëŸ¬ ë¡œê·¸ (ìµœê·¼ 1ì‹œê°„)
kubectl logs --since=1h -n openwebui -l app=openwebui | grep -i error | tail -10

# 5. ë””ìŠ¤í¬ ì‚¬ìš©ëŸ‰
kubectl get pvc -A

echo &#34;âœ… ì¼ì¼ ì²´í¬ ì™„ë£Œ&#34;
ì£¼ê°„ í™•ì¸ í•­ëª©

 ë°±ì—… ìƒíƒœ í™•ì¸
 ë³´ì•ˆ íŒ¨ì¹˜ ê²€í† 
 ë¹„ìš© ì‚¬ìš©ëŸ‰ í™•ì¸
 ì„±ëŠ¥ ë©”íŠ¸ë¦­ ê²€í† 
 ë¡œê·¸ ì •ë¦¬


ğŸ” ëª¨ë‹ˆí„°ë§ ë° ì•ŒëŒ
í•µì‹¬ ë©”íŠ¸ë¦­
# prometheus-alerts.yml
groups:
- name: openwebui.rules
  rules:
  # íŒŒë“œ ìƒíƒœ ì•ŒëŒ
  - alert: PodCrashLooping
    expr: rate(kube_pod_container_status_restarts_total[5m]) &gt; 0
    for: 5m
    annotations:
      summary: &#34;Pod {{ $labels.pod }} is crash looping&#34;
  
  # ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰ ì•ŒëŒ
  - alert: HighCPUUsage
    expr: (cpu_usage_rate &gt; 80)
    for: 10m
    annotations:
      summary: &#34;High CPU usage: {{ $value }}%&#34;
  
  # ì‘ë‹µ ì‹œê°„ ì•ŒëŒ
  - alert: HighResponseTime
    expr: http_request_duration_seconds &gt; 2
    for: 5m
    annotations:
      summary: &#34;High response time: {{ $value }}s&#34;
ë¡œê·¸ ëª¨ë‹ˆí„°ë§
# ì‹¤ì‹œê°„ ë¡œê·¸ ëª¨ë‹ˆí„°ë§
kubectl logs -f deployment/openwebui -n openwebui

# ì—ëŸ¬ ë¡œê·¸ ê²€ìƒ‰
kubectl logs deployment/openwebui -n openwebui | grep -E &#34;(ERROR|FATAL|CRITICAL)&#34;

# íŠ¹ì • ì‹œê°„ëŒ€ ë¡œê·¸
kubectl logs --since=2h --until=1h deployment/openwebui -n openwebui

ğŸ“Š ì„±ëŠ¥ ê´€ë¦¬
ìŠ¤ì¼€ì¼ë§ ê´€ë¦¬
# ìˆ˜ë™ ìŠ¤ì¼€ì¼ë§
kubectl scale deployment openwebui --replicas=5 -n openwebui
kubectl scale deployment litellm --replicas=3 -n litellm

# HPA ìƒíƒœ í™•ì¸
kubectl get hpa -A

# ìŠ¤ì¼€ì¼ë§ ì´ë²¤íŠ¸ í™•ì¸
kubectl describe hpa openwebui-hpa -n openwebui
ë¦¬ì†ŒìŠ¤ ìµœì í™”
# ë¦¬ì†ŒìŠ¤ ìš”ì²­ëŸ‰ ì¡°ì • ì˜ˆì‹œ
resources:
  requests:
    memory: &#34;512Mi&#34;    # ì‹¤ì œ ì‚¬ìš©ëŸ‰ ê¸°ë°˜ ì¡°ì •
    cpu: &#34;250m&#34;
  limits:
    memory: &#34;1Gi&#34;      # OOM ë°©ì§€
    cpu: &#34;500m&#34;        # CPU ìŠ¤ë¡œí‹€ë§ ë°©ì§€
ë°ì´í„°ë² ì´ìŠ¤ ì„±ëŠ¥
# PostgreSQL ì—°ê²° ìˆ˜ í™•ì¸
kubectl exec deployment/postgres -n openwebui -- \
  psql -U openwebui -d openwebui -c \
  &#34;SELECT count(*) FROM pg_stat_activity WHERE state = &#39;active&#39;;&#34;

# ìŠ¬ë¡œìš° ì¿¼ë¦¬ í™•ì¸
kubectl exec deployment/postgres -n openwebui -- \
  psql -U openwebui -d openwebui -c \
  &#34;SELECT query, mean_exec_time FROM pg_stat_statements ORDER BY mean_exec_time DESC LIMIT 10;&#34;

# ë°ì´í„°ë² ì´ìŠ¤ í¬ê¸° í™•ì¸
kubectl exec deployment/postgres -n openwebui -- \
  psql -U openwebui -d openwebui -c \
  &#34;SELECT pg_size_pretty(pg_database_size(&#39;openwebui&#39;));&#34;

ğŸ”„ ë°±ì—… ë° ë³µì›
ë°ì´í„°ë² ì´ìŠ¤ ë°±ì—…
#!/bin/bash
# backup-database.sh

BACKUP_DATE=$(date &#43;%Y%m%d_%H%M%S)
BACKUP_FILE=&#34;openwebui_backup_${BACKUP_DATE}.sql&#34;

# PostgreSQL ë°±ì—…
kubectl exec deployment/postgres -n openwebui -- \
  pg_dump -U openwebui openwebui &gt; $BACKUP_FILE

# S3ì— ì—…ë¡œë“œ
aws s3 cp $BACKUP_FILE s3://openwebui-backups/database/

# ë¡œì»¬ íŒŒì¼ ì •ë¦¬ (7ì¼ ì´ìƒ ëœ íŒŒì¼)
find . -name &#34;openwebui_backup_*.sql&#34; -mtime &#43;7 -delete

echo &#34;âœ… ë°±ì—… ì™„ë£Œ: $BACKUP_FILE&#34;
ë°ì´í„°ë² ì´ìŠ¤ ë³µì›
#!/bin/bash
# restore-database.sh

BACKUP_FILE=$1

if [ -z &#34;$BACKUP_FILE&#34; ]; then
  echo &#34;ì‚¬ìš©ë²•: $0 &lt;backup_file&gt;&#34;
  exit 1
fi

# S3ì—ì„œ ë°±ì—… íŒŒì¼ ë‹¤ìš´ë¡œë“œ
aws s3 cp s3://openwebui-backups/database/$BACKUP_FILE .

# ì• í”Œë¦¬ì¼€ì´ì…˜ ì¤‘ì§€
kubectl scale deployment openwebui --replicas=0 -n openwebui
kubectl scale deployment litellm --replicas=0 -n litellm

# ë°ì´í„°ë² ì´ìŠ¤ ë³µì›
kubectl exec -i deployment/postgres -n openwebui -- \
  psql -U openwebui openwebui &lt; $BACKUP_FILE

# ì• í”Œë¦¬ì¼€ì´ì…˜ ì¬ì‹œì‘
kubectl scale deployment openwebui --replicas=2 -n openwebui
kubectl scale deployment litellm --replicas=2 -n litellm

echo &#34;âœ… ë³µì› ì™„ë£Œ&#34;
ì„¤ì • íŒŒì¼ ë°±ì—…
# ConfigMap ë°±ì—…
kubectl get configmap -n openwebui -o yaml &gt; configmaps-backup.yaml
kubectl get configmap -n litellm -o yaml &gt;&gt; configmaps-backup.yaml

# Secret ë°±ì—… (ì•”í˜¸í™”ëœ í˜•íƒœ)
kubectl get secret -n openwebui -o yaml &gt; secrets-backup.yaml
kubectl get secret -n litellm -o yaml &gt;&gt; secrets-backup.yaml

ğŸš¨ ì¥ì•  ëŒ€ì‘
ê¸´ê¸‰ ìƒí™© ëŒ€ì‘ ì ˆì°¨
1ë‹¨ê³„: ìƒí™© íŒŒì•… (5ë¶„ ì´ë‚´)
# ì „ì²´ ìƒíƒœ ë¹ ë¥¸ í™•ì¸
kubectl get pods -A | grep -v Running
kubectl get nodes
kubectl top nodes

# ìµœê·¼ ì´ë²¤íŠ¸ í™•ì¸
kubectl get events -A --sort-by=&#39;.lastTimestamp&#39; | tail -20
2ë‹¨ê³„: ì„ì‹œ ì¡°ì¹˜ (10ë¶„ ì´ë‚´)
# íŒŒë“œ ì¬ì‹œì‘
kubectl rollout restart deployment/openwebui -n openwebui

# íŠ¸ë˜í”½ ì°¨ë‹¨ (í•„ìš”ì‹œ)
kubectl patch ingress openwebui-ingress -n openwebui -p \
  &#39;{&#34;metadata&#34;:{&#34;annotations&#34;:{&#34;nginx.ingress.kubernetes.io/server-snippet&#34;:&#34;return 503;&#34;}}}&#39;

# ìŠ¤ì¼€ì¼ ë‹¤ìš´ (ë¦¬ì†ŒìŠ¤ ë¶€ì¡± ì‹œ)
kubectl scale deployment openwebui --replicas=1 -n openwebui
3ë‹¨ê³„: ê·¼ë³¸ ì›ì¸ ë¶„ì„
# ìƒì„¸ ë¡œê·¸ ë¶„ì„
kubectl logs deployment/openwebui -n openwebui --previous
kubectl describe pod -l app=openwebui -n openwebui

# ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰ ë¶„ì„
kubectl top pods -n openwebui --containers
kubectl describe nodes
ì¼ë°˜ì ì¸ ì¥ì•  ì‹œë‚˜ë¦¬ì˜¤
íŒŒë“œê°€ ì‹œì‘ë˜ì§€ ì•ŠëŠ” ê²½ìš°
# ì›ì¸ í™•ì¸
kubectl describe pod &lt;pod-name&gt; -n openwebui

# ì¼ë°˜ì ì¸ í•´ê²°ì±…
# 1. ì´ë¯¸ì§€ ë¬¸ì œ
kubectl get pods -n openwebui -o jsonpath=&#39;{.items[*].spec.containers[*].image}&#39;

# 2. ë¦¬ì†ŒìŠ¤ ë¶€ì¡±
kubectl describe nodes | grep -A 5 &#34;Allocated resources&#34;

# 3. PVC ë§ˆìš´íŠ¸ ì‹¤íŒ¨
kubectl get pvc -n openwebui
kubectl describe pvc &lt;pvc-name&gt; -n openwebui
ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì‹¤íŒ¨
# PostgreSQL ìƒíƒœ í™•ì¸
kubectl get pods -l app=postgres -n openwebui
kubectl logs deployment/postgres -n openwebui

# ì—°ê²° í…ŒìŠ¤íŠ¸
kubectl exec deployment/postgres -n openwebui -- pg_isready

# ë„¤íŠ¸ì›Œí¬ ì—°ê²° í™•ì¸
kubectl exec deployment/openwebui -n openwebui -- \
  nc -zv postgres-service 5432
ë†’ì€ ì‘ë‹µ ì‹œê°„
# ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰ í™•ì¸
kubectl top pods -n openwebui

# HPA ìŠ¤ì¼€ì¼ë§ ê°•ì œ ì‹¤í–‰
kubectl patch hpa openwebui-hpa -n openwebui -p \
  &#39;{&#34;spec&#34;:{&#34;minReplicas&#34;:3}}&#39;

# ìºì‹œ í´ë¦¬ì–´ (ì• í”Œë¦¬ì¼€ì´ì…˜ë³„ ë°©ë²•)
kubectl exec deployment/openwebui -n openwebui -- \
  curl -X POST http://localhost:8080/api/v1/cache/clear

ğŸ”§ ìœ ì§€ë³´ìˆ˜
ì •ê¸° ì—…ë°ì´íŠ¸
#!/bin/bash
# update-system.sh

echo &#34;ğŸ”„ ì‹œìŠ¤í…œ ì—…ë°ì´íŠ¸ ì‹œì‘...&#34;

# 1. EKS í´ëŸ¬ìŠ¤í„° ì—…ë°ì´íŠ¸ í™•ì¸
aws eks describe-cluster --name openwebui-eks-dev \
  --query &#39;cluster.version&#39; --output text

# 2. ë…¸ë“œ ê·¸ë£¹ ì—…ë°ì´íŠ¸ í™•ì¸
aws eks describe-nodegroup --cluster-name openwebui-eks-dev \
  --nodegroup-name primary-nodes \
  --query &#39;nodegroup.version&#39; --output text

# 3. Add-on ì—…ë°ì´íŠ¸
kubectl get pods -n kube-system

# 4. ì• í”Œë¦¬ì¼€ì´ì…˜ ì´ë¯¸ì§€ ì—…ë°ì´íŠ¸
kubectl set image deployment/openwebui openwebui=ghcr.io/openwebui:latest -n openwebui

echo &#34;âœ… ì—…ë°ì´íŠ¸ ì™„ë£Œ&#34;
ë³´ì•ˆ íŒ¨ì¹˜
# ë³´ì•ˆ ìŠ¤ìº” ì‹¤í–‰
trivy image ghcr.io/openwebui:latest

# ì·¨ì•½ì  ìˆëŠ” ì»¨í…Œì´ë„ˆ ì¬ë°°í¬
kubectl rollout restart deployment/openwebui -n openwebui

# ì‹œí¬ë¦¿ ë¡œí…Œì´ì…˜
kubectl create secret generic api-keys \
  --from-literal=OPENAI_API_KEY=new-key \
  --dry-run=client -o yaml | kubectl apply -f -
ìš©ëŸ‰ ê´€ë¦¬
# ë””ìŠ¤í¬ ì‚¬ìš©ëŸ‰ ëª¨ë‹ˆí„°ë§
kubectl get pvc -A -o custom-columns=NAME:.metadata.name,SIZE:.spec.resources.requests.storage,USED:.status.capacity.storage

# ë¡œê·¸ ì •ë¦¬
kubectl logs deployment/openwebui -n openwebui --tail=1000 &gt; /dev/null

# ì´ë¯¸ì§€ ì •ë¦¬ (ë…¸ë“œì—ì„œ ì§ì ‘)
docker system prune -a

ğŸ“ˆ ì„±ëŠ¥ íŠœë‹
ì• í”Œë¦¬ì¼€ì´ì…˜ ìµœì í™”
# OpenWebUI ì„±ëŠ¥ ì„¤ì •
env:
- name: WEBUI_SECRET_KEY
  value: &#34;optimized-secret-key&#34;
- name: MAX_WORKERS
  value: &#34;4&#34;
- name: TIMEOUT
  value: &#34;60&#34;
- name: KEEP_ALIVE
  value: &#34;2&#34;
ë°ì´í„°ë² ì´ìŠ¤ íŠœë‹
-- PostgreSQL ì„±ëŠ¥ íŠœë‹
-- ì—°ê²° í’€ ì„¤ì •
ALTER SYSTEM SET max_connections = 100;
ALTER SYSTEM SET shared_buffers = &#39;256MB&#39;;
ALTER SYSTEM SET effective_cache_size = &#39;1GB&#39;;
ALTER SYSTEM SET work_mem = &#39;4MB&#39;;

-- ì¸ë±ìŠ¤ í™•ì¸ ë° ìµœì í™”
SELECT schemaname, tablename, attname, n_distinct, correlation 
FROM pg_stats WHERE tablename = &#39;your_table&#39;;
ë„¤íŠ¸ì›Œí¬ ìµœì í™”
# Ingress ì„¤ì • ìµœì í™”
annotations:
  nginx.ingress.kubernetes.io/proxy-connect-timeout: &#34;60&#34;
  nginx.ingress.kubernetes.io/proxy-send-timeout: &#34;60&#34;
  nginx.ingress.kubernetes.io/proxy-read-timeout: &#34;60&#34;
  nginx.ingress.kubernetes.io/proxy-body-size: &#34;50m&#34;
  nginx.ingress.kubernetes.io/enable-cors: &#34;true&#34;

ğŸ’° ë¹„ìš© ìµœì í™”
ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰ ë¶„ì„
# ë…¸ë“œ ë¹„ìš© ë¶„ì„
kubectl describe nodes | grep -A 3 &#34;Allocated resources&#34;

# Spot ì¸ìŠ¤í„´ìŠ¤ í™œìš©ë¥ 
kubectl get nodes -l node.kubernetes.io/instance-type

# ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ë¦¬ì†ŒìŠ¤ ì •ë¦¬
kubectl get pods -A --field-selector=status.phase=Succeeded
kubectl delete pods --field-selector=status.phase=Succeeded -A
ìë™ ìŠ¤ì¼€ì¼ë§ ìµœì í™”
# ë¹„ìš© íš¨ìœ¨ì ì¸ HPA ì„¤ì •
spec:
  minReplicas: 1        # ìµœì†Œ ë¹„ìš©
  maxReplicas: 10       # íŠ¸ë˜í”½ ëŒ€ì‘
  targetCPUUtilizationPercentage: 70  # ì ì ˆí•œ í™œìš©ë¥ 
  
  behavior:
    scaleDown:
      stabilizationWindowSeconds: 300  # ê¸‰ê²©í•œ ìŠ¤ì¼€ì¼ ë‹¤ìš´ ë°©ì§€
      policies:
      - type: Percent
        value: 50
        periodSeconds: 60

ğŸ“ ë¹„ìƒ ì—°ë½ ì²´ê³„
ì¥ì•  ë“±ê¸‰ë³„ ëŒ€ì‘
P0 (Critical): 
  - ì„œë¹„ìŠ¤ ì™„ì „ ì¤‘ë‹¨
  - ì¦‰ì‹œ ëŒ€ì‘ (24/7)
  - ì—°ë½ì²˜: [ê¸´ê¸‰ ì—°ë½ì²˜]

P1 (High):
  - ì£¼ìš” ê¸°ëŠ¥ ì¥ì• 
  - 4ì‹œê°„ ì´ë‚´ ëŒ€ì‘
  - ì—°ë½ì²˜: [íŒ€ ë¦¬ë”]

P2 (Medium):
  - ë¶€ë¶„ ê¸°ëŠ¥ ì¥ì•   
  - 24ì‹œê°„ ì´ë‚´ ëŒ€ì‘
  - ì—°ë½ì²˜: [ë‹´ë‹¹ì]

P3 (Low):
  - ì„±ëŠ¥ ì €í•˜
  - 72ì‹œê°„ ì´ë‚´ ëŒ€ì‘
  - ì—°ë½ì²˜: [íŒ€ ë©”ì¼]
ì—ìŠ¤ì»¬ë ˆì´ì…˜ ì ˆì°¨

1ì°¨ ë‹´ë‹¹ì (30ë¶„ ì´ë‚´ ì‘ë‹µ)
íŒ€ ë¦¬ë” (1ì‹œê°„ ì´ë‚´)
ê¸°ìˆ  ì±…ì„ì (2ì‹œê°„ ì´ë‚´)
CTO (4ì‹œê°„ ì´ë‚´)


ğŸ“š ìš´ì˜ ë„êµ¬ ë° ëŒ€ì‹œë³´ë“œ
í•„ìˆ˜ ë„êµ¬
# kubectl í”ŒëŸ¬ê·¸ì¸ ì„¤ì¹˜
kubectl krew install ctx ns stern top

# ìœ ìš©í•œ ëª…ë ¹ì–´ ë³„ì¹­
alias k=&#39;kubectl&#39;
alias kgp=&#39;kubectl get pods&#39;
alias kgs=&#39;kubectl get svc&#39; 
alias kgn=&#39;kubectl get nodes&#39;
alias kdp=&#39;kubectl describe pod&#39;
alias kl=&#39;kubectl logs&#39;
ëª¨ë‹ˆí„°ë§ ëŒ€ì‹œë³´ë“œ

Grafana: http://grafana.your-domain.com
Prometheus: http://prometheus.your-domain.com
Jaeger: http://jaeger.your-domain.com (íŠ¸ë ˆì´ì‹±)
ArgoCD: http://argocd.your-domain.com (GitOps)

ë¡œê·¸ ë¶„ì„
# ì¤‘ì•™í™”ëœ ë¡œê¹… (ELK Stack)
kubectl port-forward svc/kibana 5601:5601 -n logging

# ë¡œê·¸ ì¿¼ë¦¬ ì˜ˆì‹œ
# Kibanaì—ì„œ: kubernetes.namespace:&#34;openwebui&#34; AND level:&#34;ERROR&#34;

ğŸ”„ ì •ê¸° ì‘ì—… ìŠ¤ì¼€ì¤„
ì¼ì¼ ì‘ì—… (ìë™í™”)
# CronJob ì˜ˆì‹œ
apiVersion: batch/v1
kind: CronJob
metadata:
  name: daily-cleanup
spec:
  schedule: &#34;0 2 * * *&#34;  # ë§¤ì¼ ì˜¤ì „ 2ì‹œ
  jobTemplate:
    spec:
      template:
        spec:
          containers:
          - name: cleanup
            image: alpine:latest
            command:
            - /bin/sh
            - -c
            - |
              # ë¡œê·¸ ì •ë¦¬
              find /var/log -name &#34;*.log&#34; -mtime &#43;7 -delete
              # ì„ì‹œ íŒŒì¼ ì •ë¦¬
              find /tmp -mtime &#43;1 -delete
          restartPolicy: OnFailure
ì£¼ê°„ ì‘ì—…

ë°±ì—… ê²€ì¦ í…ŒìŠ¤íŠ¸
ë³´ì•ˆ ìŠ¤ìº” ì‹¤í–‰
ì„±ëŠ¥ ë¦¬í¬íŠ¸ ì‘ì„±
ë¹„ìš© ë¶„ì„ ë¦¬í¬íŠ¸

ì›”ê°„ ì‘ì—…

DR(ì¬í•´ë³µêµ¬) í…ŒìŠ¤íŠ¸
ë³´ì•ˆ ê°ì‚¬
ìš©ëŸ‰ ê³„íš ê²€í† 
ì•„í‚¤í…ì²˜ ë¦¬ë·°

ì´ì œ ì™„ì „í•œ ìš´ì˜ ë§¤ë‰´ì–¼ì´ ì¤€ë¹„ë˜ì—ˆìŠµë‹ˆë‹¤! ğŸ› ï¸">
<meta name="author" content="">
<link rel="canonical" href="https://8dobibim.github.io/backend/%EC%9A%B4%EC%98%81-%EB%A9%94%EB%89%B4%EC%96%BC/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.css" rel="preload stylesheet" as="style">
<link rel="icon" href="https://8dobibim.github.io/%3Clink%20/%20abs%20url%3E">
<link rel="icon" type="image/png" sizes="16x16" href="https://8dobibim.github.io/%3Clink%20/%20abs%20url%3E">
<link rel="icon" type="image/png" sizes="32x32" href="https://8dobibim.github.io/%3Clink%20/%20abs%20url%3E">
<link rel="apple-touch-icon" href="https://8dobibim.github.io/%3Clink%20/%20abs%20url%3E">
<link rel="mask-icon" href="https://8dobibim.github.io/%3Clink%20/%20abs%20url%3E">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://8dobibim.github.io/backend/%EC%9A%B4%EC%98%81-%EB%A9%94%EB%89%B4%EC%96%BC/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:url" content="https://8dobibim.github.io/backend/%EC%9A%B4%EC%98%81-%EB%A9%94%EB%89%B4%EC%96%BC/">
  <meta property="og:site_name" content="8dobibim Tech Blog">
  <meta property="og:title" content="8dobibim Tech Blog">
  <meta property="og:description" content="ğŸ› ï¸ OpenWebUI ìš´ì˜ ë§¤ë‰´ì–¼ ğŸ‘¥ ëŒ€ìƒ: DevOps ì—”ì§€ë‹ˆì–´, SRE, ì‹œìŠ¤í…œ ê´€ë¦¬ì
ğŸ“… ì—…ë°ì´íŠ¸: ì •ê¸°ì ìœ¼ë¡œ ì—…ë°ì´íŠ¸ í•„ìš”
ğŸš¨ ë¹„ìƒ ì—°ë½ì²˜: [íŒ€ ì—°ë½ì²˜ ì •ë³´]
ğŸ“‹ ì¼ì¼ ìš´ì˜ ì²´í¬ë¦¬ìŠ¤íŠ¸ ë§¤ì¼ í™•ì¸ í•­ëª© #!/bin/bash # daily-check.sh echo &#34;ğŸ“… $(date &#39;&#43;%Y-%m-%d %H:%M:%S&#39;) - ì¼ì¼ ìš´ì˜ ì²´í¬ ì‹œì‘&#34; # 1. í´ëŸ¬ìŠ¤í„° ìƒíƒœ kubectl get nodes kubectl get pods -A | grep -v Running # 2. ì• í”Œë¦¬ì¼€ì´ì…˜ ìƒíƒœ kubectl get pods -n openwebui -n litellm # 3. ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰ kubectl top nodes kubectl top pods -A # 4. ìµœê·¼ ì—ëŸ¬ ë¡œê·¸ (ìµœê·¼ 1ì‹œê°„) kubectl logs --since=1h -n openwebui -l app=openwebui | grep -i error | tail -10 # 5. ë””ìŠ¤í¬ ì‚¬ìš©ëŸ‰ kubectl get pvc -A echo &#34;âœ… ì¼ì¼ ì²´í¬ ì™„ë£Œ&#34; ì£¼ê°„ í™•ì¸ í•­ëª© ë°±ì—… ìƒíƒœ í™•ì¸ ë³´ì•ˆ íŒ¨ì¹˜ ê²€í†  ë¹„ìš© ì‚¬ìš©ëŸ‰ í™•ì¸ ì„±ëŠ¥ ë©”íŠ¸ë¦­ ê²€í†  ë¡œê·¸ ì •ë¦¬ ğŸ” ëª¨ë‹ˆí„°ë§ ë° ì•ŒëŒ í•µì‹¬ ë©”íŠ¸ë¦­ # prometheus-alerts.yml groups: - name: openwebui.rules rules: # íŒŒë“œ ìƒíƒœ ì•ŒëŒ - alert: PodCrashLooping expr: rate(kube_pod_container_status_restarts_total[5m]) &gt; 0 for: 5m annotations: summary: &#34;Pod {{ $labels.pod }} is crash looping&#34; # ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰ ì•ŒëŒ - alert: HighCPUUsage expr: (cpu_usage_rate &gt; 80) for: 10m annotations: summary: &#34;High CPU usage: {{ $value }}%&#34; # ì‘ë‹µ ì‹œê°„ ì•ŒëŒ - alert: HighResponseTime expr: http_request_duration_seconds &gt; 2 for: 5m annotations: summary: &#34;High response time: {{ $value }}s&#34; ë¡œê·¸ ëª¨ë‹ˆí„°ë§ # ì‹¤ì‹œê°„ ë¡œê·¸ ëª¨ë‹ˆí„°ë§ kubectl logs -f deployment/openwebui -n openwebui # ì—ëŸ¬ ë¡œê·¸ ê²€ìƒ‰ kubectl logs deployment/openwebui -n openwebui | grep -E &#34;(ERROR|FATAL|CRITICAL)&#34; # íŠ¹ì • ì‹œê°„ëŒ€ ë¡œê·¸ kubectl logs --since=2h --until=1h deployment/openwebui -n openwebui ğŸ“Š ì„±ëŠ¥ ê´€ë¦¬ ìŠ¤ì¼€ì¼ë§ ê´€ë¦¬ # ìˆ˜ë™ ìŠ¤ì¼€ì¼ë§ kubectl scale deployment openwebui --replicas=5 -n openwebui kubectl scale deployment litellm --replicas=3 -n litellm # HPA ìƒíƒœ í™•ì¸ kubectl get hpa -A # ìŠ¤ì¼€ì¼ë§ ì´ë²¤íŠ¸ í™•ì¸ kubectl describe hpa openwebui-hpa -n openwebui ë¦¬ì†ŒìŠ¤ ìµœì í™” # ë¦¬ì†ŒìŠ¤ ìš”ì²­ëŸ‰ ì¡°ì • ì˜ˆì‹œ resources: requests: memory: &#34;512Mi&#34; # ì‹¤ì œ ì‚¬ìš©ëŸ‰ ê¸°ë°˜ ì¡°ì • cpu: &#34;250m&#34; limits: memory: &#34;1Gi&#34; # OOM ë°©ì§€ cpu: &#34;500m&#34; # CPU ìŠ¤ë¡œí‹€ë§ ë°©ì§€ ë°ì´í„°ë² ì´ìŠ¤ ì„±ëŠ¥ # PostgreSQL ì—°ê²° ìˆ˜ í™•ì¸ kubectl exec deployment/postgres -n openwebui -- \ psql -U openwebui -d openwebui -c \ &#34;SELECT count(*) FROM pg_stat_activity WHERE state = &#39;active&#39;;&#34; # ìŠ¬ë¡œìš° ì¿¼ë¦¬ í™•ì¸ kubectl exec deployment/postgres -n openwebui -- \ psql -U openwebui -d openwebui -c \ &#34;SELECT query, mean_exec_time FROM pg_stat_statements ORDER BY mean_exec_time DESC LIMIT 10;&#34; # ë°ì´í„°ë² ì´ìŠ¤ í¬ê¸° í™•ì¸ kubectl exec deployment/postgres -n openwebui -- \ psql -U openwebui -d openwebui -c \ &#34;SELECT pg_size_pretty(pg_database_size(&#39;openwebui&#39;));&#34; ğŸ”„ ë°±ì—… ë° ë³µì› ë°ì´í„°ë² ì´ìŠ¤ ë°±ì—… #!/bin/bash # backup-database.sh BACKUP_DATE=$(date &#43;%Y%m%d_%H%M%S) BACKUP_FILE=&#34;openwebui_backup_${BACKUP_DATE}.sql&#34; # PostgreSQL ë°±ì—… kubectl exec deployment/postgres -n openwebui -- \ pg_dump -U openwebui openwebui &gt; $BACKUP_FILE # S3ì— ì—…ë¡œë“œ aws s3 cp $BACKUP_FILE s3://openwebui-backups/database/ # ë¡œì»¬ íŒŒì¼ ì •ë¦¬ (7ì¼ ì´ìƒ ëœ íŒŒì¼) find . -name &#34;openwebui_backup_*.sql&#34; -mtime &#43;7 -delete echo &#34;âœ… ë°±ì—… ì™„ë£Œ: $BACKUP_FILE&#34; ë°ì´í„°ë² ì´ìŠ¤ ë³µì› #!/bin/bash # restore-database.sh BACKUP_FILE=$1 if [ -z &#34;$BACKUP_FILE&#34; ]; then echo &#34;ì‚¬ìš©ë²•: $0 &lt;backup_file&gt;&#34; exit 1 fi # S3ì—ì„œ ë°±ì—… íŒŒì¼ ë‹¤ìš´ë¡œë“œ aws s3 cp s3://openwebui-backups/database/$BACKUP_FILE . # ì• í”Œë¦¬ì¼€ì´ì…˜ ì¤‘ì§€ kubectl scale deployment openwebui --replicas=0 -n openwebui kubectl scale deployment litellm --replicas=0 -n litellm # ë°ì´í„°ë² ì´ìŠ¤ ë³µì› kubectl exec -i deployment/postgres -n openwebui -- \ psql -U openwebui openwebui &lt; $BACKUP_FILE # ì• í”Œë¦¬ì¼€ì´ì…˜ ì¬ì‹œì‘ kubectl scale deployment openwebui --replicas=2 -n openwebui kubectl scale deployment litellm --replicas=2 -n litellm echo &#34;âœ… ë³µì› ì™„ë£Œ&#34; ì„¤ì • íŒŒì¼ ë°±ì—… # ConfigMap ë°±ì—… kubectl get configmap -n openwebui -o yaml &gt; configmaps-backup.yaml kubectl get configmap -n litellm -o yaml &gt;&gt; configmaps-backup.yaml # Secret ë°±ì—… (ì•”í˜¸í™”ëœ í˜•íƒœ) kubectl get secret -n openwebui -o yaml &gt; secrets-backup.yaml kubectl get secret -n litellm -o yaml &gt;&gt; secrets-backup.yaml ğŸš¨ ì¥ì•  ëŒ€ì‘ ê¸´ê¸‰ ìƒí™© ëŒ€ì‘ ì ˆì°¨ 1ë‹¨ê³„: ìƒí™© íŒŒì•… (5ë¶„ ì´ë‚´) # ì „ì²´ ìƒíƒœ ë¹ ë¥¸ í™•ì¸ kubectl get pods -A | grep -v Running kubectl get nodes kubectl top nodes # ìµœê·¼ ì´ë²¤íŠ¸ í™•ì¸ kubectl get events -A --sort-by=&#39;.lastTimestamp&#39; | tail -20 2ë‹¨ê³„: ì„ì‹œ ì¡°ì¹˜ (10ë¶„ ì´ë‚´) # íŒŒë“œ ì¬ì‹œì‘ kubectl rollout restart deployment/openwebui -n openwebui # íŠ¸ë˜í”½ ì°¨ë‹¨ (í•„ìš”ì‹œ) kubectl patch ingress openwebui-ingress -n openwebui -p \ &#39;{&#34;metadata&#34;:{&#34;annotations&#34;:{&#34;nginx.ingress.kubernetes.io/server-snippet&#34;:&#34;return 503;&#34;}}}&#39; # ìŠ¤ì¼€ì¼ ë‹¤ìš´ (ë¦¬ì†ŒìŠ¤ ë¶€ì¡± ì‹œ) kubectl scale deployment openwebui --replicas=1 -n openwebui 3ë‹¨ê³„: ê·¼ë³¸ ì›ì¸ ë¶„ì„ # ìƒì„¸ ë¡œê·¸ ë¶„ì„ kubectl logs deployment/openwebui -n openwebui --previous kubectl describe pod -l app=openwebui -n openwebui # ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰ ë¶„ì„ kubectl top pods -n openwebui --containers kubectl describe nodes ì¼ë°˜ì ì¸ ì¥ì•  ì‹œë‚˜ë¦¬ì˜¤ íŒŒë“œê°€ ì‹œì‘ë˜ì§€ ì•ŠëŠ” ê²½ìš° # ì›ì¸ í™•ì¸ kubectl describe pod &lt;pod-name&gt; -n openwebui # ì¼ë°˜ì ì¸ í•´ê²°ì±… # 1. ì´ë¯¸ì§€ ë¬¸ì œ kubectl get pods -n openwebui -o jsonpath=&#39;{.items[*].spec.containers[*].image}&#39; # 2. ë¦¬ì†ŒìŠ¤ ë¶€ì¡± kubectl describe nodes | grep -A 5 &#34;Allocated resources&#34; # 3. PVC ë§ˆìš´íŠ¸ ì‹¤íŒ¨ kubectl get pvc -n openwebui kubectl describe pvc &lt;pvc-name&gt; -n openwebui ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì‹¤íŒ¨ # PostgreSQL ìƒíƒœ í™•ì¸ kubectl get pods -l app=postgres -n openwebui kubectl logs deployment/postgres -n openwebui # ì—°ê²° í…ŒìŠ¤íŠ¸ kubectl exec deployment/postgres -n openwebui -- pg_isready # ë„¤íŠ¸ì›Œí¬ ì—°ê²° í™•ì¸ kubectl exec deployment/openwebui -n openwebui -- \ nc -zv postgres-service 5432 ë†’ì€ ì‘ë‹µ ì‹œê°„ # ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰ í™•ì¸ kubectl top pods -n openwebui # HPA ìŠ¤ì¼€ì¼ë§ ê°•ì œ ì‹¤í–‰ kubectl patch hpa openwebui-hpa -n openwebui -p \ &#39;{&#34;spec&#34;:{&#34;minReplicas&#34;:3}}&#39; # ìºì‹œ í´ë¦¬ì–´ (ì• í”Œë¦¬ì¼€ì´ì…˜ë³„ ë°©ë²•) kubectl exec deployment/openwebui -n openwebui -- \ curl -X POST http://localhost:8080/api/v1/cache/clear ğŸ”§ ìœ ì§€ë³´ìˆ˜ ì •ê¸° ì—…ë°ì´íŠ¸ #!/bin/bash # update-system.sh echo &#34;ğŸ”„ ì‹œìŠ¤í…œ ì—…ë°ì´íŠ¸ ì‹œì‘...&#34; # 1. EKS í´ëŸ¬ìŠ¤í„° ì—…ë°ì´íŠ¸ í™•ì¸ aws eks describe-cluster --name openwebui-eks-dev \ --query &#39;cluster.version&#39; --output text # 2. ë…¸ë“œ ê·¸ë£¹ ì—…ë°ì´íŠ¸ í™•ì¸ aws eks describe-nodegroup --cluster-name openwebui-eks-dev \ --nodegroup-name primary-nodes \ --query &#39;nodegroup.version&#39; --output text # 3. Add-on ì—…ë°ì´íŠ¸ kubectl get pods -n kube-system # 4. ì• í”Œë¦¬ì¼€ì´ì…˜ ì´ë¯¸ì§€ ì—…ë°ì´íŠ¸ kubectl set image deployment/openwebui openwebui=ghcr.io/openwebui:latest -n openwebui echo &#34;âœ… ì—…ë°ì´íŠ¸ ì™„ë£Œ&#34; ë³´ì•ˆ íŒ¨ì¹˜ # ë³´ì•ˆ ìŠ¤ìº” ì‹¤í–‰ trivy image ghcr.io/openwebui:latest # ì·¨ì•½ì  ìˆëŠ” ì»¨í…Œì´ë„ˆ ì¬ë°°í¬ kubectl rollout restart deployment/openwebui -n openwebui # ì‹œí¬ë¦¿ ë¡œí…Œì´ì…˜ kubectl create secret generic api-keys \ --from-literal=OPENAI_API_KEY=new-key \ --dry-run=client -o yaml | kubectl apply -f - ìš©ëŸ‰ ê´€ë¦¬ # ë””ìŠ¤í¬ ì‚¬ìš©ëŸ‰ ëª¨ë‹ˆí„°ë§ kubectl get pvc -A -o custom-columns=NAME:.metadata.name,SIZE:.spec.resources.requests.storage,USED:.status.capacity.storage # ë¡œê·¸ ì •ë¦¬ kubectl logs deployment/openwebui -n openwebui --tail=1000 &gt; /dev/null # ì´ë¯¸ì§€ ì •ë¦¬ (ë…¸ë“œì—ì„œ ì§ì ‘) docker system prune -a ğŸ“ˆ ì„±ëŠ¥ íŠœë‹ ì• í”Œë¦¬ì¼€ì´ì…˜ ìµœì í™” # OpenWebUI ì„±ëŠ¥ ì„¤ì • env: - name: WEBUI_SECRET_KEY value: &#34;optimized-secret-key&#34; - name: MAX_WORKERS value: &#34;4&#34; - name: TIMEOUT value: &#34;60&#34; - name: KEEP_ALIVE value: &#34;2&#34; ë°ì´í„°ë² ì´ìŠ¤ íŠœë‹ -- PostgreSQL ì„±ëŠ¥ íŠœë‹ -- ì—°ê²° í’€ ì„¤ì • ALTER SYSTEM SET max_connections = 100; ALTER SYSTEM SET shared_buffers = &#39;256MB&#39;; ALTER SYSTEM SET effective_cache_size = &#39;1GB&#39;; ALTER SYSTEM SET work_mem = &#39;4MB&#39;; -- ì¸ë±ìŠ¤ í™•ì¸ ë° ìµœì í™” SELECT schemaname, tablename, attname, n_distinct, correlation FROM pg_stats WHERE tablename = &#39;your_table&#39;; ë„¤íŠ¸ì›Œí¬ ìµœì í™” # Ingress ì„¤ì • ìµœì í™” annotations: nginx.ingress.kubernetes.io/proxy-connect-timeout: &#34;60&#34; nginx.ingress.kubernetes.io/proxy-send-timeout: &#34;60&#34; nginx.ingress.kubernetes.io/proxy-read-timeout: &#34;60&#34; nginx.ingress.kubernetes.io/proxy-body-size: &#34;50m&#34; nginx.ingress.kubernetes.io/enable-cors: &#34;true&#34; ğŸ’° ë¹„ìš© ìµœì í™” ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰ ë¶„ì„ # ë…¸ë“œ ë¹„ìš© ë¶„ì„ kubectl describe nodes | grep -A 3 &#34;Allocated resources&#34; # Spot ì¸ìŠ¤í„´ìŠ¤ í™œìš©ë¥  kubectl get nodes -l node.kubernetes.io/instance-type # ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ë¦¬ì†ŒìŠ¤ ì •ë¦¬ kubectl get pods -A --field-selector=status.phase=Succeeded kubectl delete pods --field-selector=status.phase=Succeeded -A ìë™ ìŠ¤ì¼€ì¼ë§ ìµœì í™” # ë¹„ìš© íš¨ìœ¨ì ì¸ HPA ì„¤ì • spec: minReplicas: 1 # ìµœì†Œ ë¹„ìš© maxReplicas: 10 # íŠ¸ë˜í”½ ëŒ€ì‘ targetCPUUtilizationPercentage: 70 # ì ì ˆí•œ í™œìš©ë¥  behavior: scaleDown: stabilizationWindowSeconds: 300 # ê¸‰ê²©í•œ ìŠ¤ì¼€ì¼ ë‹¤ìš´ ë°©ì§€ policies: - type: Percent value: 50 periodSeconds: 60 ğŸ“ ë¹„ìƒ ì—°ë½ ì²´ê³„ ì¥ì•  ë“±ê¸‰ë³„ ëŒ€ì‘ P0 (Critical): - ì„œë¹„ìŠ¤ ì™„ì „ ì¤‘ë‹¨ - ì¦‰ì‹œ ëŒ€ì‘ (24/7) - ì—°ë½ì²˜: [ê¸´ê¸‰ ì—°ë½ì²˜] P1 (High): - ì£¼ìš” ê¸°ëŠ¥ ì¥ì•  - 4ì‹œê°„ ì´ë‚´ ëŒ€ì‘ - ì—°ë½ì²˜: [íŒ€ ë¦¬ë”] P2 (Medium): - ë¶€ë¶„ ê¸°ëŠ¥ ì¥ì•  - 24ì‹œê°„ ì´ë‚´ ëŒ€ì‘ - ì—°ë½ì²˜: [ë‹´ë‹¹ì] P3 (Low): - ì„±ëŠ¥ ì €í•˜ - 72ì‹œê°„ ì´ë‚´ ëŒ€ì‘ - ì—°ë½ì²˜: [íŒ€ ë©”ì¼] ì—ìŠ¤ì»¬ë ˆì´ì…˜ ì ˆì°¨ 1ì°¨ ë‹´ë‹¹ì (30ë¶„ ì´ë‚´ ì‘ë‹µ) íŒ€ ë¦¬ë” (1ì‹œê°„ ì´ë‚´) ê¸°ìˆ  ì±…ì„ì (2ì‹œê°„ ì´ë‚´) CTO (4ì‹œê°„ ì´ë‚´) ğŸ“š ìš´ì˜ ë„êµ¬ ë° ëŒ€ì‹œë³´ë“œ í•„ìˆ˜ ë„êµ¬ # kubectl í”ŒëŸ¬ê·¸ì¸ ì„¤ì¹˜ kubectl krew install ctx ns stern top # ìœ ìš©í•œ ëª…ë ¹ì–´ ë³„ì¹­ alias k=&#39;kubectl&#39; alias kgp=&#39;kubectl get pods&#39; alias kgs=&#39;kubectl get svc&#39; alias kgn=&#39;kubectl get nodes&#39; alias kdp=&#39;kubectl describe pod&#39; alias kl=&#39;kubectl logs&#39; ëª¨ë‹ˆí„°ë§ ëŒ€ì‹œë³´ë“œ Grafana: http://grafana.your-domain.com Prometheus: http://prometheus.your-domain.com Jaeger: http://jaeger.your-domain.com (íŠ¸ë ˆì´ì‹±) ArgoCD: http://argocd.your-domain.com (GitOps) ë¡œê·¸ ë¶„ì„ # ì¤‘ì•™í™”ëœ ë¡œê¹… (ELK Stack) kubectl port-forward svc/kibana 5601:5601 -n logging # ë¡œê·¸ ì¿¼ë¦¬ ì˜ˆì‹œ # Kibanaì—ì„œ: kubernetes.namespace:&#34;openwebui&#34; AND level:&#34;ERROR&#34; ğŸ”„ ì •ê¸° ì‘ì—… ìŠ¤ì¼€ì¤„ ì¼ì¼ ì‘ì—… (ìë™í™”) # CronJob ì˜ˆì‹œ apiVersion: batch/v1 kind: CronJob metadata: name: daily-cleanup spec: schedule: &#34;0 2 * * *&#34; # ë§¤ì¼ ì˜¤ì „ 2ì‹œ jobTemplate: spec: template: spec: containers: - name: cleanup image: alpine:latest command: - /bin/sh - -c - | # ë¡œê·¸ ì •ë¦¬ find /var/log -name &#34;*.log&#34; -mtime &#43;7 -delete # ì„ì‹œ íŒŒì¼ ì •ë¦¬ find /tmp -mtime &#43;1 -delete restartPolicy: OnFailure ì£¼ê°„ ì‘ì—… ë°±ì—… ê²€ì¦ í…ŒìŠ¤íŠ¸ ë³´ì•ˆ ìŠ¤ìº” ì‹¤í–‰ ì„±ëŠ¥ ë¦¬í¬íŠ¸ ì‘ì„± ë¹„ìš© ë¶„ì„ ë¦¬í¬íŠ¸ ì›”ê°„ ì‘ì—… DR(ì¬í•´ë³µêµ¬) í…ŒìŠ¤íŠ¸ ë³´ì•ˆ ê°ì‚¬ ìš©ëŸ‰ ê³„íš ê²€í†  ì•„í‚¤í…ì²˜ ë¦¬ë·° ì´ì œ ì™„ì „í•œ ìš´ì˜ ë§¤ë‰´ì–¼ì´ ì¤€ë¹„ë˜ì—ˆìŠµë‹ˆë‹¤! ğŸ› ï¸">
  <meta property="og:locale" content="ko">
  <meta property="og:type" content="article">
    <meta property="article:section" content="backend">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="">
<meta name="twitter:description" content="ğŸ› ï¸ OpenWebUI ìš´ì˜ ë§¤ë‰´ì–¼

ğŸ‘¥ ëŒ€ìƒ: DevOps ì—”ì§€ë‹ˆì–´, SRE, ì‹œìŠ¤í…œ ê´€ë¦¬ì
ğŸ“… ì—…ë°ì´íŠ¸: ì •ê¸°ì ìœ¼ë¡œ ì—…ë°ì´íŠ¸ í•„ìš”
ğŸš¨ ë¹„ìƒ ì—°ë½ì²˜: [íŒ€ ì—°ë½ì²˜ ì •ë³´]

ğŸ“‹ ì¼ì¼ ìš´ì˜ ì²´í¬ë¦¬ìŠ¤íŠ¸
ë§¤ì¼ í™•ì¸ í•­ëª©
#!/bin/bash
# daily-check.sh

echo &#34;ğŸ“… $(date &#39;&#43;%Y-%m-%d %H:%M:%S&#39;) - ì¼ì¼ ìš´ì˜ ì²´í¬ ì‹œì‘&#34;

# 1. í´ëŸ¬ìŠ¤í„° ìƒíƒœ
kubectl get nodes
kubectl get pods -A | grep -v Running

# 2. ì• í”Œë¦¬ì¼€ì´ì…˜ ìƒíƒœ
kubectl get pods -n openwebui -n litellm

# 3. ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰
kubectl top nodes
kubectl top pods -A

# 4. ìµœê·¼ ì—ëŸ¬ ë¡œê·¸ (ìµœê·¼ 1ì‹œê°„)
kubectl logs --since=1h -n openwebui -l app=openwebui | grep -i error | tail -10

# 5. ë””ìŠ¤í¬ ì‚¬ìš©ëŸ‰
kubectl get pvc -A

echo &#34;âœ… ì¼ì¼ ì²´í¬ ì™„ë£Œ&#34;
ì£¼ê°„ í™•ì¸ í•­ëª©

 ë°±ì—… ìƒíƒœ í™•ì¸
 ë³´ì•ˆ íŒ¨ì¹˜ ê²€í† 
 ë¹„ìš© ì‚¬ìš©ëŸ‰ í™•ì¸
 ì„±ëŠ¥ ë©”íŠ¸ë¦­ ê²€í† 
 ë¡œê·¸ ì •ë¦¬


ğŸ” ëª¨ë‹ˆí„°ë§ ë° ì•ŒëŒ
í•µì‹¬ ë©”íŠ¸ë¦­
# prometheus-alerts.yml
groups:
- name: openwebui.rules
  rules:
  # íŒŒë“œ ìƒíƒœ ì•ŒëŒ
  - alert: PodCrashLooping
    expr: rate(kube_pod_container_status_restarts_total[5m]) &gt; 0
    for: 5m
    annotations:
      summary: &#34;Pod {{ $labels.pod }} is crash looping&#34;
  
  # ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰ ì•ŒëŒ
  - alert: HighCPUUsage
    expr: (cpu_usage_rate &gt; 80)
    for: 10m
    annotations:
      summary: &#34;High CPU usage: {{ $value }}%&#34;
  
  # ì‘ë‹µ ì‹œê°„ ì•ŒëŒ
  - alert: HighResponseTime
    expr: http_request_duration_seconds &gt; 2
    for: 5m
    annotations:
      summary: &#34;High response time: {{ $value }}s&#34;
ë¡œê·¸ ëª¨ë‹ˆí„°ë§
# ì‹¤ì‹œê°„ ë¡œê·¸ ëª¨ë‹ˆí„°ë§
kubectl logs -f deployment/openwebui -n openwebui

# ì—ëŸ¬ ë¡œê·¸ ê²€ìƒ‰
kubectl logs deployment/openwebui -n openwebui | grep -E &#34;(ERROR|FATAL|CRITICAL)&#34;

# íŠ¹ì • ì‹œê°„ëŒ€ ë¡œê·¸
kubectl logs --since=2h --until=1h deployment/openwebui -n openwebui

ğŸ“Š ì„±ëŠ¥ ê´€ë¦¬
ìŠ¤ì¼€ì¼ë§ ê´€ë¦¬
# ìˆ˜ë™ ìŠ¤ì¼€ì¼ë§
kubectl scale deployment openwebui --replicas=5 -n openwebui
kubectl scale deployment litellm --replicas=3 -n litellm

# HPA ìƒíƒœ í™•ì¸
kubectl get hpa -A

# ìŠ¤ì¼€ì¼ë§ ì´ë²¤íŠ¸ í™•ì¸
kubectl describe hpa openwebui-hpa -n openwebui
ë¦¬ì†ŒìŠ¤ ìµœì í™”
# ë¦¬ì†ŒìŠ¤ ìš”ì²­ëŸ‰ ì¡°ì • ì˜ˆì‹œ
resources:
  requests:
    memory: &#34;512Mi&#34;    # ì‹¤ì œ ì‚¬ìš©ëŸ‰ ê¸°ë°˜ ì¡°ì •
    cpu: &#34;250m&#34;
  limits:
    memory: &#34;1Gi&#34;      # OOM ë°©ì§€
    cpu: &#34;500m&#34;        # CPU ìŠ¤ë¡œí‹€ë§ ë°©ì§€
ë°ì´í„°ë² ì´ìŠ¤ ì„±ëŠ¥
# PostgreSQL ì—°ê²° ìˆ˜ í™•ì¸
kubectl exec deployment/postgres -n openwebui -- \
  psql -U openwebui -d openwebui -c \
  &#34;SELECT count(*) FROM pg_stat_activity WHERE state = &#39;active&#39;;&#34;

# ìŠ¬ë¡œìš° ì¿¼ë¦¬ í™•ì¸
kubectl exec deployment/postgres -n openwebui -- \
  psql -U openwebui -d openwebui -c \
  &#34;SELECT query, mean_exec_time FROM pg_stat_statements ORDER BY mean_exec_time DESC LIMIT 10;&#34;

# ë°ì´í„°ë² ì´ìŠ¤ í¬ê¸° í™•ì¸
kubectl exec deployment/postgres -n openwebui -- \
  psql -U openwebui -d openwebui -c \
  &#34;SELECT pg_size_pretty(pg_database_size(&#39;openwebui&#39;));&#34;

ğŸ”„ ë°±ì—… ë° ë³µì›
ë°ì´í„°ë² ì´ìŠ¤ ë°±ì—…
#!/bin/bash
# backup-database.sh

BACKUP_DATE=$(date &#43;%Y%m%d_%H%M%S)
BACKUP_FILE=&#34;openwebui_backup_${BACKUP_DATE}.sql&#34;

# PostgreSQL ë°±ì—…
kubectl exec deployment/postgres -n openwebui -- \
  pg_dump -U openwebui openwebui &gt; $BACKUP_FILE

# S3ì— ì—…ë¡œë“œ
aws s3 cp $BACKUP_FILE s3://openwebui-backups/database/

# ë¡œì»¬ íŒŒì¼ ì •ë¦¬ (7ì¼ ì´ìƒ ëœ íŒŒì¼)
find . -name &#34;openwebui_backup_*.sql&#34; -mtime &#43;7 -delete

echo &#34;âœ… ë°±ì—… ì™„ë£Œ: $BACKUP_FILE&#34;
ë°ì´í„°ë² ì´ìŠ¤ ë³µì›
#!/bin/bash
# restore-database.sh

BACKUP_FILE=$1

if [ -z &#34;$BACKUP_FILE&#34; ]; then
  echo &#34;ì‚¬ìš©ë²•: $0 &lt;backup_file&gt;&#34;
  exit 1
fi

# S3ì—ì„œ ë°±ì—… íŒŒì¼ ë‹¤ìš´ë¡œë“œ
aws s3 cp s3://openwebui-backups/database/$BACKUP_FILE .

# ì• í”Œë¦¬ì¼€ì´ì…˜ ì¤‘ì§€
kubectl scale deployment openwebui --replicas=0 -n openwebui
kubectl scale deployment litellm --replicas=0 -n litellm

# ë°ì´í„°ë² ì´ìŠ¤ ë³µì›
kubectl exec -i deployment/postgres -n openwebui -- \
  psql -U openwebui openwebui &lt; $BACKUP_FILE

# ì• í”Œë¦¬ì¼€ì´ì…˜ ì¬ì‹œì‘
kubectl scale deployment openwebui --replicas=2 -n openwebui
kubectl scale deployment litellm --replicas=2 -n litellm

echo &#34;âœ… ë³µì› ì™„ë£Œ&#34;
ì„¤ì • íŒŒì¼ ë°±ì—…
# ConfigMap ë°±ì—…
kubectl get configmap -n openwebui -o yaml &gt; configmaps-backup.yaml
kubectl get configmap -n litellm -o yaml &gt;&gt; configmaps-backup.yaml

# Secret ë°±ì—… (ì•”í˜¸í™”ëœ í˜•íƒœ)
kubectl get secret -n openwebui -o yaml &gt; secrets-backup.yaml
kubectl get secret -n litellm -o yaml &gt;&gt; secrets-backup.yaml

ğŸš¨ ì¥ì•  ëŒ€ì‘
ê¸´ê¸‰ ìƒí™© ëŒ€ì‘ ì ˆì°¨
1ë‹¨ê³„: ìƒí™© íŒŒì•… (5ë¶„ ì´ë‚´)
# ì „ì²´ ìƒíƒœ ë¹ ë¥¸ í™•ì¸
kubectl get pods -A | grep -v Running
kubectl get nodes
kubectl top nodes

# ìµœê·¼ ì´ë²¤íŠ¸ í™•ì¸
kubectl get events -A --sort-by=&#39;.lastTimestamp&#39; | tail -20
2ë‹¨ê³„: ì„ì‹œ ì¡°ì¹˜ (10ë¶„ ì´ë‚´)
# íŒŒë“œ ì¬ì‹œì‘
kubectl rollout restart deployment/openwebui -n openwebui

# íŠ¸ë˜í”½ ì°¨ë‹¨ (í•„ìš”ì‹œ)
kubectl patch ingress openwebui-ingress -n openwebui -p \
  &#39;{&#34;metadata&#34;:{&#34;annotations&#34;:{&#34;nginx.ingress.kubernetes.io/server-snippet&#34;:&#34;return 503;&#34;}}}&#39;

# ìŠ¤ì¼€ì¼ ë‹¤ìš´ (ë¦¬ì†ŒìŠ¤ ë¶€ì¡± ì‹œ)
kubectl scale deployment openwebui --replicas=1 -n openwebui
3ë‹¨ê³„: ê·¼ë³¸ ì›ì¸ ë¶„ì„
# ìƒì„¸ ë¡œê·¸ ë¶„ì„
kubectl logs deployment/openwebui -n openwebui --previous
kubectl describe pod -l app=openwebui -n openwebui

# ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰ ë¶„ì„
kubectl top pods -n openwebui --containers
kubectl describe nodes
ì¼ë°˜ì ì¸ ì¥ì•  ì‹œë‚˜ë¦¬ì˜¤
íŒŒë“œê°€ ì‹œì‘ë˜ì§€ ì•ŠëŠ” ê²½ìš°
# ì›ì¸ í™•ì¸
kubectl describe pod &lt;pod-name&gt; -n openwebui

# ì¼ë°˜ì ì¸ í•´ê²°ì±…
# 1. ì´ë¯¸ì§€ ë¬¸ì œ
kubectl get pods -n openwebui -o jsonpath=&#39;{.items[*].spec.containers[*].image}&#39;

# 2. ë¦¬ì†ŒìŠ¤ ë¶€ì¡±
kubectl describe nodes | grep -A 5 &#34;Allocated resources&#34;

# 3. PVC ë§ˆìš´íŠ¸ ì‹¤íŒ¨
kubectl get pvc -n openwebui
kubectl describe pvc &lt;pvc-name&gt; -n openwebui
ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì‹¤íŒ¨
# PostgreSQL ìƒíƒœ í™•ì¸
kubectl get pods -l app=postgres -n openwebui
kubectl logs deployment/postgres -n openwebui

# ì—°ê²° í…ŒìŠ¤íŠ¸
kubectl exec deployment/postgres -n openwebui -- pg_isready

# ë„¤íŠ¸ì›Œí¬ ì—°ê²° í™•ì¸
kubectl exec deployment/openwebui -n openwebui -- \
  nc -zv postgres-service 5432
ë†’ì€ ì‘ë‹µ ì‹œê°„
# ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰ í™•ì¸
kubectl top pods -n openwebui

# HPA ìŠ¤ì¼€ì¼ë§ ê°•ì œ ì‹¤í–‰
kubectl patch hpa openwebui-hpa -n openwebui -p \
  &#39;{&#34;spec&#34;:{&#34;minReplicas&#34;:3}}&#39;

# ìºì‹œ í´ë¦¬ì–´ (ì• í”Œë¦¬ì¼€ì´ì…˜ë³„ ë°©ë²•)
kubectl exec deployment/openwebui -n openwebui -- \
  curl -X POST http://localhost:8080/api/v1/cache/clear

ğŸ”§ ìœ ì§€ë³´ìˆ˜
ì •ê¸° ì—…ë°ì´íŠ¸
#!/bin/bash
# update-system.sh

echo &#34;ğŸ”„ ì‹œìŠ¤í…œ ì—…ë°ì´íŠ¸ ì‹œì‘...&#34;

# 1. EKS í´ëŸ¬ìŠ¤í„° ì—…ë°ì´íŠ¸ í™•ì¸
aws eks describe-cluster --name openwebui-eks-dev \
  --query &#39;cluster.version&#39; --output text

# 2. ë…¸ë“œ ê·¸ë£¹ ì—…ë°ì´íŠ¸ í™•ì¸
aws eks describe-nodegroup --cluster-name openwebui-eks-dev \
  --nodegroup-name primary-nodes \
  --query &#39;nodegroup.version&#39; --output text

# 3. Add-on ì—…ë°ì´íŠ¸
kubectl get pods -n kube-system

# 4. ì• í”Œë¦¬ì¼€ì´ì…˜ ì´ë¯¸ì§€ ì—…ë°ì´íŠ¸
kubectl set image deployment/openwebui openwebui=ghcr.io/openwebui:latest -n openwebui

echo &#34;âœ… ì—…ë°ì´íŠ¸ ì™„ë£Œ&#34;
ë³´ì•ˆ íŒ¨ì¹˜
# ë³´ì•ˆ ìŠ¤ìº” ì‹¤í–‰
trivy image ghcr.io/openwebui:latest

# ì·¨ì•½ì  ìˆëŠ” ì»¨í…Œì´ë„ˆ ì¬ë°°í¬
kubectl rollout restart deployment/openwebui -n openwebui

# ì‹œí¬ë¦¿ ë¡œí…Œì´ì…˜
kubectl create secret generic api-keys \
  --from-literal=OPENAI_API_KEY=new-key \
  --dry-run=client -o yaml | kubectl apply -f -
ìš©ëŸ‰ ê´€ë¦¬
# ë””ìŠ¤í¬ ì‚¬ìš©ëŸ‰ ëª¨ë‹ˆí„°ë§
kubectl get pvc -A -o custom-columns=NAME:.metadata.name,SIZE:.spec.resources.requests.storage,USED:.status.capacity.storage

# ë¡œê·¸ ì •ë¦¬
kubectl logs deployment/openwebui -n openwebui --tail=1000 &gt; /dev/null

# ì´ë¯¸ì§€ ì •ë¦¬ (ë…¸ë“œì—ì„œ ì§ì ‘)
docker system prune -a

ğŸ“ˆ ì„±ëŠ¥ íŠœë‹
ì• í”Œë¦¬ì¼€ì´ì…˜ ìµœì í™”
# OpenWebUI ì„±ëŠ¥ ì„¤ì •
env:
- name: WEBUI_SECRET_KEY
  value: &#34;optimized-secret-key&#34;
- name: MAX_WORKERS
  value: &#34;4&#34;
- name: TIMEOUT
  value: &#34;60&#34;
- name: KEEP_ALIVE
  value: &#34;2&#34;
ë°ì´í„°ë² ì´ìŠ¤ íŠœë‹
-- PostgreSQL ì„±ëŠ¥ íŠœë‹
-- ì—°ê²° í’€ ì„¤ì •
ALTER SYSTEM SET max_connections = 100;
ALTER SYSTEM SET shared_buffers = &#39;256MB&#39;;
ALTER SYSTEM SET effective_cache_size = &#39;1GB&#39;;
ALTER SYSTEM SET work_mem = &#39;4MB&#39;;

-- ì¸ë±ìŠ¤ í™•ì¸ ë° ìµœì í™”
SELECT schemaname, tablename, attname, n_distinct, correlation 
FROM pg_stats WHERE tablename = &#39;your_table&#39;;
ë„¤íŠ¸ì›Œí¬ ìµœì í™”
# Ingress ì„¤ì • ìµœì í™”
annotations:
  nginx.ingress.kubernetes.io/proxy-connect-timeout: &#34;60&#34;
  nginx.ingress.kubernetes.io/proxy-send-timeout: &#34;60&#34;
  nginx.ingress.kubernetes.io/proxy-read-timeout: &#34;60&#34;
  nginx.ingress.kubernetes.io/proxy-body-size: &#34;50m&#34;
  nginx.ingress.kubernetes.io/enable-cors: &#34;true&#34;

ğŸ’° ë¹„ìš© ìµœì í™”
ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰ ë¶„ì„
# ë…¸ë“œ ë¹„ìš© ë¶„ì„
kubectl describe nodes | grep -A 3 &#34;Allocated resources&#34;

# Spot ì¸ìŠ¤í„´ìŠ¤ í™œìš©ë¥ 
kubectl get nodes -l node.kubernetes.io/instance-type

# ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ë¦¬ì†ŒìŠ¤ ì •ë¦¬
kubectl get pods -A --field-selector=status.phase=Succeeded
kubectl delete pods --field-selector=status.phase=Succeeded -A
ìë™ ìŠ¤ì¼€ì¼ë§ ìµœì í™”
# ë¹„ìš© íš¨ìœ¨ì ì¸ HPA ì„¤ì •
spec:
  minReplicas: 1        # ìµœì†Œ ë¹„ìš©
  maxReplicas: 10       # íŠ¸ë˜í”½ ëŒ€ì‘
  targetCPUUtilizationPercentage: 70  # ì ì ˆí•œ í™œìš©ë¥ 
  
  behavior:
    scaleDown:
      stabilizationWindowSeconds: 300  # ê¸‰ê²©í•œ ìŠ¤ì¼€ì¼ ë‹¤ìš´ ë°©ì§€
      policies:
      - type: Percent
        value: 50
        periodSeconds: 60

ğŸ“ ë¹„ìƒ ì—°ë½ ì²´ê³„
ì¥ì•  ë“±ê¸‰ë³„ ëŒ€ì‘
P0 (Critical): 
  - ì„œë¹„ìŠ¤ ì™„ì „ ì¤‘ë‹¨
  - ì¦‰ì‹œ ëŒ€ì‘ (24/7)
  - ì—°ë½ì²˜: [ê¸´ê¸‰ ì—°ë½ì²˜]

P1 (High):
  - ì£¼ìš” ê¸°ëŠ¥ ì¥ì• 
  - 4ì‹œê°„ ì´ë‚´ ëŒ€ì‘
  - ì—°ë½ì²˜: [íŒ€ ë¦¬ë”]

P2 (Medium):
  - ë¶€ë¶„ ê¸°ëŠ¥ ì¥ì•   
  - 24ì‹œê°„ ì´ë‚´ ëŒ€ì‘
  - ì—°ë½ì²˜: [ë‹´ë‹¹ì]

P3 (Low):
  - ì„±ëŠ¥ ì €í•˜
  - 72ì‹œê°„ ì´ë‚´ ëŒ€ì‘
  - ì—°ë½ì²˜: [íŒ€ ë©”ì¼]
ì—ìŠ¤ì»¬ë ˆì´ì…˜ ì ˆì°¨

1ì°¨ ë‹´ë‹¹ì (30ë¶„ ì´ë‚´ ì‘ë‹µ)
íŒ€ ë¦¬ë” (1ì‹œê°„ ì´ë‚´)
ê¸°ìˆ  ì±…ì„ì (2ì‹œê°„ ì´ë‚´)
CTO (4ì‹œê°„ ì´ë‚´)


ğŸ“š ìš´ì˜ ë„êµ¬ ë° ëŒ€ì‹œë³´ë“œ
í•„ìˆ˜ ë„êµ¬
# kubectl í”ŒëŸ¬ê·¸ì¸ ì„¤ì¹˜
kubectl krew install ctx ns stern top

# ìœ ìš©í•œ ëª…ë ¹ì–´ ë³„ì¹­
alias k=&#39;kubectl&#39;
alias kgp=&#39;kubectl get pods&#39;
alias kgs=&#39;kubectl get svc&#39; 
alias kgn=&#39;kubectl get nodes&#39;
alias kdp=&#39;kubectl describe pod&#39;
alias kl=&#39;kubectl logs&#39;
ëª¨ë‹ˆí„°ë§ ëŒ€ì‹œë³´ë“œ

Grafana: http://grafana.your-domain.com
Prometheus: http://prometheus.your-domain.com
Jaeger: http://jaeger.your-domain.com (íŠ¸ë ˆì´ì‹±)
ArgoCD: http://argocd.your-domain.com (GitOps)

ë¡œê·¸ ë¶„ì„
# ì¤‘ì•™í™”ëœ ë¡œê¹… (ELK Stack)
kubectl port-forward svc/kibana 5601:5601 -n logging

# ë¡œê·¸ ì¿¼ë¦¬ ì˜ˆì‹œ
# Kibanaì—ì„œ: kubernetes.namespace:&#34;openwebui&#34; AND level:&#34;ERROR&#34;

ğŸ”„ ì •ê¸° ì‘ì—… ìŠ¤ì¼€ì¤„
ì¼ì¼ ì‘ì—… (ìë™í™”)
# CronJob ì˜ˆì‹œ
apiVersion: batch/v1
kind: CronJob
metadata:
  name: daily-cleanup
spec:
  schedule: &#34;0 2 * * *&#34;  # ë§¤ì¼ ì˜¤ì „ 2ì‹œ
  jobTemplate:
    spec:
      template:
        spec:
          containers:
          - name: cleanup
            image: alpine:latest
            command:
            - /bin/sh
            - -c
            - |
              # ë¡œê·¸ ì •ë¦¬
              find /var/log -name &#34;*.log&#34; -mtime &#43;7 -delete
              # ì„ì‹œ íŒŒì¼ ì •ë¦¬
              find /tmp -mtime &#43;1 -delete
          restartPolicy: OnFailure
ì£¼ê°„ ì‘ì—…

ë°±ì—… ê²€ì¦ í…ŒìŠ¤íŠ¸
ë³´ì•ˆ ìŠ¤ìº” ì‹¤í–‰
ì„±ëŠ¥ ë¦¬í¬íŠ¸ ì‘ì„±
ë¹„ìš© ë¶„ì„ ë¦¬í¬íŠ¸

ì›”ê°„ ì‘ì—…

DR(ì¬í•´ë³µêµ¬) í…ŒìŠ¤íŠ¸
ë³´ì•ˆ ê°ì‚¬
ìš©ëŸ‰ ê³„íš ê²€í† 
ì•„í‚¤í…ì²˜ ë¦¬ë·°

ì´ì œ ì™„ì „í•œ ìš´ì˜ ë§¤ë‰´ì–¼ì´ ì¤€ë¹„ë˜ì—ˆìŠµë‹ˆë‹¤! ğŸ› ï¸">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Backend ë¬¸ì„œ",
      "item": "https://8dobibim.github.io/backend/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "",
      "item": "https://8dobibim.github.io/backend/%EC%9A%B4%EC%98%81-%EB%A9%94%EB%89%B4%EC%96%BC/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "",
  "name": "",
  "description": "ğŸ› ï¸ OpenWebUI ìš´ì˜ ë§¤ë‰´ì–¼ ğŸ‘¥ ëŒ€ìƒ: DevOps ì—”ì§€ë‹ˆì–´, SRE, ì‹œìŠ¤í…œ ê´€ë¦¬ì\nğŸ“… ì—…ë°ì´íŠ¸: ì •ê¸°ì ìœ¼ë¡œ ì—…ë°ì´íŠ¸ í•„ìš”\nğŸš¨ ë¹„ìƒ ì—°ë½ì²˜: [íŒ€ ì—°ë½ì²˜ ì •ë³´]\nğŸ“‹ ì¼ì¼ ìš´ì˜ ì²´í¬ë¦¬ìŠ¤íŠ¸ ë§¤ì¼ í™•ì¸ í•­ëª© #!/bin/bash # daily-check.sh echo \u0026#34;ğŸ“… $(date \u0026#39;+%Y-%m-%d %H:%M:%S\u0026#39;) - ì¼ì¼ ìš´ì˜ ì²´í¬ ì‹œì‘\u0026#34; # 1. í´ëŸ¬ìŠ¤í„° ìƒíƒœ kubectl get nodes kubectl get pods -A | grep -v Running # 2. ì• í”Œë¦¬ì¼€ì´ì…˜ ìƒíƒœ kubectl get pods -n openwebui -n litellm # 3. ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰ kubectl top nodes kubectl top pods -A # 4. ìµœê·¼ ì—ëŸ¬ ë¡œê·¸ (ìµœê·¼ 1ì‹œê°„) kubectl logs --since=1h -n openwebui -l app=openwebui | grep -i error | tail -10 # 5. ë””ìŠ¤í¬ ì‚¬ìš©ëŸ‰ kubectl get pvc -A echo \u0026#34;âœ… ì¼ì¼ ì²´í¬ ì™„ë£Œ\u0026#34; ì£¼ê°„ í™•ì¸ í•­ëª© ë°±ì—… ìƒíƒœ í™•ì¸ ë³´ì•ˆ íŒ¨ì¹˜ ê²€í†  ë¹„ìš© ì‚¬ìš©ëŸ‰ í™•ì¸ ì„±ëŠ¥ ë©”íŠ¸ë¦­ ê²€í†  ë¡œê·¸ ì •ë¦¬ ğŸ” ëª¨ë‹ˆí„°ë§ ë° ì•ŒëŒ í•µì‹¬ ë©”íŠ¸ë¦­ # prometheus-alerts.yml groups: - name: openwebui.rules rules: # íŒŒë“œ ìƒíƒœ ì•ŒëŒ - alert: PodCrashLooping expr: rate(kube_pod_container_status_restarts_total[5m]) \u0026gt; 0 for: 5m annotations: summary: \u0026#34;Pod {{ $labels.pod }} is crash looping\u0026#34; # ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰ ì•ŒëŒ - alert: HighCPUUsage expr: (cpu_usage_rate \u0026gt; 80) for: 10m annotations: summary: \u0026#34;High CPU usage: {{ $value }}%\u0026#34; # ì‘ë‹µ ì‹œê°„ ì•ŒëŒ - alert: HighResponseTime expr: http_request_duration_seconds \u0026gt; 2 for: 5m annotations: summary: \u0026#34;High response time: {{ $value }}s\u0026#34; ë¡œê·¸ ëª¨ë‹ˆí„°ë§ # ì‹¤ì‹œê°„ ë¡œê·¸ ëª¨ë‹ˆí„°ë§ kubectl logs -f deployment/openwebui -n openwebui # ì—ëŸ¬ ë¡œê·¸ ê²€ìƒ‰ kubectl logs deployment/openwebui -n openwebui | grep -E \u0026#34;(ERROR|FATAL|CRITICAL)\u0026#34; # íŠ¹ì • ì‹œê°„ëŒ€ ë¡œê·¸ kubectl logs --since=2h --until=1h deployment/openwebui -n openwebui ğŸ“Š ì„±ëŠ¥ ê´€ë¦¬ ìŠ¤ì¼€ì¼ë§ ê´€ë¦¬ # ìˆ˜ë™ ìŠ¤ì¼€ì¼ë§ kubectl scale deployment openwebui --replicas=5 -n openwebui kubectl scale deployment litellm --replicas=3 -n litellm # HPA ìƒíƒœ í™•ì¸ kubectl get hpa -A # ìŠ¤ì¼€ì¼ë§ ì´ë²¤íŠ¸ í™•ì¸ kubectl describe hpa openwebui-hpa -n openwebui ë¦¬ì†ŒìŠ¤ ìµœì í™” # ë¦¬ì†ŒìŠ¤ ìš”ì²­ëŸ‰ ì¡°ì • ì˜ˆì‹œ resources: requests: memory: \u0026#34;512Mi\u0026#34; # ì‹¤ì œ ì‚¬ìš©ëŸ‰ ê¸°ë°˜ ì¡°ì • cpu: \u0026#34;250m\u0026#34; limits: memory: \u0026#34;1Gi\u0026#34; # OOM ë°©ì§€ cpu: \u0026#34;500m\u0026#34; # CPU ìŠ¤ë¡œí‹€ë§ ë°©ì§€ ë°ì´í„°ë² ì´ìŠ¤ ì„±ëŠ¥ # PostgreSQL ì—°ê²° ìˆ˜ í™•ì¸ kubectl exec deployment/postgres -n openwebui -- \\ psql -U openwebui -d openwebui -c \\ \u0026#34;SELECT count(*) FROM pg_stat_activity WHERE state = \u0026#39;active\u0026#39;;\u0026#34; # ìŠ¬ë¡œìš° ì¿¼ë¦¬ í™•ì¸ kubectl exec deployment/postgres -n openwebui -- \\ psql -U openwebui -d openwebui -c \\ \u0026#34;SELECT query, mean_exec_time FROM pg_stat_statements ORDER BY mean_exec_time DESC LIMIT 10;\u0026#34; # ë°ì´í„°ë² ì´ìŠ¤ í¬ê¸° í™•ì¸ kubectl exec deployment/postgres -n openwebui -- \\ psql -U openwebui -d openwebui -c \\ \u0026#34;SELECT pg_size_pretty(pg_database_size(\u0026#39;openwebui\u0026#39;));\u0026#34; ğŸ”„ ë°±ì—… ë° ë³µì› ë°ì´í„°ë² ì´ìŠ¤ ë°±ì—… #!/bin/bash # backup-database.sh BACKUP_DATE=$(date +%Y%m%d_%H%M%S) BACKUP_FILE=\u0026#34;openwebui_backup_${BACKUP_DATE}.sql\u0026#34; # PostgreSQL ë°±ì—… kubectl exec deployment/postgres -n openwebui -- \\ pg_dump -U openwebui openwebui \u0026gt; $BACKUP_FILE # S3ì— ì—…ë¡œë“œ aws s3 cp $BACKUP_FILE s3://openwebui-backups/database/ # ë¡œì»¬ íŒŒì¼ ì •ë¦¬ (7ì¼ ì´ìƒ ëœ íŒŒì¼) find . -name \u0026#34;openwebui_backup_*.sql\u0026#34; -mtime +7 -delete echo \u0026#34;âœ… ë°±ì—… ì™„ë£Œ: $BACKUP_FILE\u0026#34; ë°ì´í„°ë² ì´ìŠ¤ ë³µì› #!/bin/bash # restore-database.sh BACKUP_FILE=$1 if [ -z \u0026#34;$BACKUP_FILE\u0026#34; ]; then echo \u0026#34;ì‚¬ìš©ë²•: $0 \u0026lt;backup_file\u0026gt;\u0026#34; exit 1 fi # S3ì—ì„œ ë°±ì—… íŒŒì¼ ë‹¤ìš´ë¡œë“œ aws s3 cp s3://openwebui-backups/database/$BACKUP_FILE . # ì• í”Œë¦¬ì¼€ì´ì…˜ ì¤‘ì§€ kubectl scale deployment openwebui --replicas=0 -n openwebui kubectl scale deployment litellm --replicas=0 -n litellm # ë°ì´í„°ë² ì´ìŠ¤ ë³µì› kubectl exec -i deployment/postgres -n openwebui -- \\ psql -U openwebui openwebui \u0026lt; $BACKUP_FILE # ì• í”Œë¦¬ì¼€ì´ì…˜ ì¬ì‹œì‘ kubectl scale deployment openwebui --replicas=2 -n openwebui kubectl scale deployment litellm --replicas=2 -n litellm echo \u0026#34;âœ… ë³µì› ì™„ë£Œ\u0026#34; ì„¤ì • íŒŒì¼ ë°±ì—… # ConfigMap ë°±ì—… kubectl get configmap -n openwebui -o yaml \u0026gt; configmaps-backup.yaml kubectl get configmap -n litellm -o yaml \u0026gt;\u0026gt; configmaps-backup.yaml # Secret ë°±ì—… (ì•”í˜¸í™”ëœ í˜•íƒœ) kubectl get secret -n openwebui -o yaml \u0026gt; secrets-backup.yaml kubectl get secret -n litellm -o yaml \u0026gt;\u0026gt; secrets-backup.yaml ğŸš¨ ì¥ì•  ëŒ€ì‘ ê¸´ê¸‰ ìƒí™© ëŒ€ì‘ ì ˆì°¨ 1ë‹¨ê³„: ìƒí™© íŒŒì•… (5ë¶„ ì´ë‚´) # ì „ì²´ ìƒíƒœ ë¹ ë¥¸ í™•ì¸ kubectl get pods -A | grep -v Running kubectl get nodes kubectl top nodes # ìµœê·¼ ì´ë²¤íŠ¸ í™•ì¸ kubectl get events -A --sort-by=\u0026#39;.lastTimestamp\u0026#39; | tail -20 2ë‹¨ê³„: ì„ì‹œ ì¡°ì¹˜ (10ë¶„ ì´ë‚´) # íŒŒë“œ ì¬ì‹œì‘ kubectl rollout restart deployment/openwebui -n openwebui # íŠ¸ë˜í”½ ì°¨ë‹¨ (í•„ìš”ì‹œ) kubectl patch ingress openwebui-ingress -n openwebui -p \\ \u0026#39;{\u0026#34;metadata\u0026#34;:{\u0026#34;annotations\u0026#34;:{\u0026#34;nginx.ingress.kubernetes.io/server-snippet\u0026#34;:\u0026#34;return 503;\u0026#34;}}}\u0026#39; # ìŠ¤ì¼€ì¼ ë‹¤ìš´ (ë¦¬ì†ŒìŠ¤ ë¶€ì¡± ì‹œ) kubectl scale deployment openwebui --replicas=1 -n openwebui 3ë‹¨ê³„: ê·¼ë³¸ ì›ì¸ ë¶„ì„ # ìƒì„¸ ë¡œê·¸ ë¶„ì„ kubectl logs deployment/openwebui -n openwebui --previous kubectl describe pod -l app=openwebui -n openwebui # ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰ ë¶„ì„ kubectl top pods -n openwebui --containers kubectl describe nodes ì¼ë°˜ì ì¸ ì¥ì•  ì‹œë‚˜ë¦¬ì˜¤ íŒŒë“œê°€ ì‹œì‘ë˜ì§€ ì•ŠëŠ” ê²½ìš° # ì›ì¸ í™•ì¸ kubectl describe pod \u0026lt;pod-name\u0026gt; -n openwebui # ì¼ë°˜ì ì¸ í•´ê²°ì±… # 1. ì´ë¯¸ì§€ ë¬¸ì œ kubectl get pods -n openwebui -o jsonpath=\u0026#39;{.items[*].spec.containers[*].image}\u0026#39; # 2. ë¦¬ì†ŒìŠ¤ ë¶€ì¡± kubectl describe nodes | grep -A 5 \u0026#34;Allocated resources\u0026#34; # 3. PVC ë§ˆìš´íŠ¸ ì‹¤íŒ¨ kubectl get pvc -n openwebui kubectl describe pvc \u0026lt;pvc-name\u0026gt; -n openwebui ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì‹¤íŒ¨ # PostgreSQL ìƒíƒœ í™•ì¸ kubectl get pods -l app=postgres -n openwebui kubectl logs deployment/postgres -n openwebui # ì—°ê²° í…ŒìŠ¤íŠ¸ kubectl exec deployment/postgres -n openwebui -- pg_isready # ë„¤íŠ¸ì›Œí¬ ì—°ê²° í™•ì¸ kubectl exec deployment/openwebui -n openwebui -- \\ nc -zv postgres-service 5432 ë†’ì€ ì‘ë‹µ ì‹œê°„ # ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰ í™•ì¸ kubectl top pods -n openwebui # HPA ìŠ¤ì¼€ì¼ë§ ê°•ì œ ì‹¤í–‰ kubectl patch hpa openwebui-hpa -n openwebui -p \\ \u0026#39;{\u0026#34;spec\u0026#34;:{\u0026#34;minReplicas\u0026#34;:3}}\u0026#39; # ìºì‹œ í´ë¦¬ì–´ (ì• í”Œë¦¬ì¼€ì´ì…˜ë³„ ë°©ë²•) kubectl exec deployment/openwebui -n openwebui -- \\ curl -X POST http://localhost:8080/api/v1/cache/clear ğŸ”§ ìœ ì§€ë³´ìˆ˜ ì •ê¸° ì—…ë°ì´íŠ¸ #!/bin/bash # update-system.sh echo \u0026#34;ğŸ”„ ì‹œìŠ¤í…œ ì—…ë°ì´íŠ¸ ì‹œì‘...\u0026#34; # 1. EKS í´ëŸ¬ìŠ¤í„° ì—…ë°ì´íŠ¸ í™•ì¸ aws eks describe-cluster --name openwebui-eks-dev \\ --query \u0026#39;cluster.version\u0026#39; --output text # 2. ë…¸ë“œ ê·¸ë£¹ ì—…ë°ì´íŠ¸ í™•ì¸ aws eks describe-nodegroup --cluster-name openwebui-eks-dev \\ --nodegroup-name primary-nodes \\ --query \u0026#39;nodegroup.version\u0026#39; --output text # 3. Add-on ì—…ë°ì´íŠ¸ kubectl get pods -n kube-system # 4. ì• í”Œë¦¬ì¼€ì´ì…˜ ì´ë¯¸ì§€ ì—…ë°ì´íŠ¸ kubectl set image deployment/openwebui openwebui=ghcr.io/openwebui:latest -n openwebui echo \u0026#34;âœ… ì—…ë°ì´íŠ¸ ì™„ë£Œ\u0026#34; ë³´ì•ˆ íŒ¨ì¹˜ # ë³´ì•ˆ ìŠ¤ìº” ì‹¤í–‰ trivy image ghcr.io/openwebui:latest # ì·¨ì•½ì  ìˆëŠ” ì»¨í…Œì´ë„ˆ ì¬ë°°í¬ kubectl rollout restart deployment/openwebui -n openwebui # ì‹œí¬ë¦¿ ë¡œí…Œì´ì…˜ kubectl create secret generic api-keys \\ --from-literal=OPENAI_API_KEY=new-key \\ --dry-run=client -o yaml | kubectl apply -f - ìš©ëŸ‰ ê´€ë¦¬ # ë””ìŠ¤í¬ ì‚¬ìš©ëŸ‰ ëª¨ë‹ˆí„°ë§ kubectl get pvc -A -o custom-columns=NAME:.metadata.name,SIZE:.spec.resources.requests.storage,USED:.status.capacity.storage # ë¡œê·¸ ì •ë¦¬ kubectl logs deployment/openwebui -n openwebui --tail=1000 \u0026gt; /dev/null # ì´ë¯¸ì§€ ì •ë¦¬ (ë…¸ë“œì—ì„œ ì§ì ‘) docker system prune -a ğŸ“ˆ ì„±ëŠ¥ íŠœë‹ ì• í”Œë¦¬ì¼€ì´ì…˜ ìµœì í™” # OpenWebUI ì„±ëŠ¥ ì„¤ì • env: - name: WEBUI_SECRET_KEY value: \u0026#34;optimized-secret-key\u0026#34; - name: MAX_WORKERS value: \u0026#34;4\u0026#34; - name: TIMEOUT value: \u0026#34;60\u0026#34; - name: KEEP_ALIVE value: \u0026#34;2\u0026#34; ë°ì´í„°ë² ì´ìŠ¤ íŠœë‹ -- PostgreSQL ì„±ëŠ¥ íŠœë‹ -- ì—°ê²° í’€ ì„¤ì • ALTER SYSTEM SET max_connections = 100; ALTER SYSTEM SET shared_buffers = \u0026#39;256MB\u0026#39;; ALTER SYSTEM SET effective_cache_size = \u0026#39;1GB\u0026#39;; ALTER SYSTEM SET work_mem = \u0026#39;4MB\u0026#39;; -- ì¸ë±ìŠ¤ í™•ì¸ ë° ìµœì í™” SELECT schemaname, tablename, attname, n_distinct, correlation FROM pg_stats WHERE tablename = \u0026#39;your_table\u0026#39;; ë„¤íŠ¸ì›Œí¬ ìµœì í™” # Ingress ì„¤ì • ìµœì í™” annotations: nginx.ingress.kubernetes.io/proxy-connect-timeout: \u0026#34;60\u0026#34; nginx.ingress.kubernetes.io/proxy-send-timeout: \u0026#34;60\u0026#34; nginx.ingress.kubernetes.io/proxy-read-timeout: \u0026#34;60\u0026#34; nginx.ingress.kubernetes.io/proxy-body-size: \u0026#34;50m\u0026#34; nginx.ingress.kubernetes.io/enable-cors: \u0026#34;true\u0026#34; ğŸ’° ë¹„ìš© ìµœì í™” ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰ ë¶„ì„ # ë…¸ë“œ ë¹„ìš© ë¶„ì„ kubectl describe nodes | grep -A 3 \u0026#34;Allocated resources\u0026#34; # Spot ì¸ìŠ¤í„´ìŠ¤ í™œìš©ë¥  kubectl get nodes -l node.kubernetes.io/instance-type # ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ë¦¬ì†ŒìŠ¤ ì •ë¦¬ kubectl get pods -A --field-selector=status.phase=Succeeded kubectl delete pods --field-selector=status.phase=Succeeded -A ìë™ ìŠ¤ì¼€ì¼ë§ ìµœì í™” # ë¹„ìš© íš¨ìœ¨ì ì¸ HPA ì„¤ì • spec: minReplicas: 1 # ìµœì†Œ ë¹„ìš© maxReplicas: 10 # íŠ¸ë˜í”½ ëŒ€ì‘ targetCPUUtilizationPercentage: 70 # ì ì ˆí•œ í™œìš©ë¥  behavior: scaleDown: stabilizationWindowSeconds: 300 # ê¸‰ê²©í•œ ìŠ¤ì¼€ì¼ ë‹¤ìš´ ë°©ì§€ policies: - type: Percent value: 50 periodSeconds: 60 ğŸ“ ë¹„ìƒ ì—°ë½ ì²´ê³„ ì¥ì•  ë“±ê¸‰ë³„ ëŒ€ì‘ P0 (Critical): - ì„œë¹„ìŠ¤ ì™„ì „ ì¤‘ë‹¨ - ì¦‰ì‹œ ëŒ€ì‘ (24/7) - ì—°ë½ì²˜: [ê¸´ê¸‰ ì—°ë½ì²˜] P1 (High): - ì£¼ìš” ê¸°ëŠ¥ ì¥ì•  - 4ì‹œê°„ ì´ë‚´ ëŒ€ì‘ - ì—°ë½ì²˜: [íŒ€ ë¦¬ë”] P2 (Medium): - ë¶€ë¶„ ê¸°ëŠ¥ ì¥ì•  - 24ì‹œê°„ ì´ë‚´ ëŒ€ì‘ - ì—°ë½ì²˜: [ë‹´ë‹¹ì] P3 (Low): - ì„±ëŠ¥ ì €í•˜ - 72ì‹œê°„ ì´ë‚´ ëŒ€ì‘ - ì—°ë½ì²˜: [íŒ€ ë©”ì¼] ì—ìŠ¤ì»¬ë ˆì´ì…˜ ì ˆì°¨ 1ì°¨ ë‹´ë‹¹ì (30ë¶„ ì´ë‚´ ì‘ë‹µ) íŒ€ ë¦¬ë” (1ì‹œê°„ ì´ë‚´) ê¸°ìˆ  ì±…ì„ì (2ì‹œê°„ ì´ë‚´) CTO (4ì‹œê°„ ì´ë‚´) ğŸ“š ìš´ì˜ ë„êµ¬ ë° ëŒ€ì‹œë³´ë“œ í•„ìˆ˜ ë„êµ¬ # kubectl í”ŒëŸ¬ê·¸ì¸ ì„¤ì¹˜ kubectl krew install ctx ns stern top # ìœ ìš©í•œ ëª…ë ¹ì–´ ë³„ì¹­ alias k=\u0026#39;kubectl\u0026#39; alias kgp=\u0026#39;kubectl get pods\u0026#39; alias kgs=\u0026#39;kubectl get svc\u0026#39; alias kgn=\u0026#39;kubectl get nodes\u0026#39; alias kdp=\u0026#39;kubectl describe pod\u0026#39; alias kl=\u0026#39;kubectl logs\u0026#39; ëª¨ë‹ˆí„°ë§ ëŒ€ì‹œë³´ë“œ Grafana: http://grafana.your-domain.com Prometheus: http://prometheus.your-domain.com Jaeger: http://jaeger.your-domain.com (íŠ¸ë ˆì´ì‹±) ArgoCD: http://argocd.your-domain.com (GitOps) ë¡œê·¸ ë¶„ì„ # ì¤‘ì•™í™”ëœ ë¡œê¹… (ELK Stack) kubectl port-forward svc/kibana 5601:5601 -n logging # ë¡œê·¸ ì¿¼ë¦¬ ì˜ˆì‹œ # Kibanaì—ì„œ: kubernetes.namespace:\u0026#34;openwebui\u0026#34; AND level:\u0026#34;ERROR\u0026#34; ğŸ”„ ì •ê¸° ì‘ì—… ìŠ¤ì¼€ì¤„ ì¼ì¼ ì‘ì—… (ìë™í™”) # CronJob ì˜ˆì‹œ apiVersion: batch/v1 kind: CronJob metadata: name: daily-cleanup spec: schedule: \u0026#34;0 2 * * *\u0026#34; # ë§¤ì¼ ì˜¤ì „ 2ì‹œ jobTemplate: spec: template: spec: containers: - name: cleanup image: alpine:latest command: - /bin/sh - -c - | # ë¡œê·¸ ì •ë¦¬ find /var/log -name \u0026#34;*.log\u0026#34; -mtime +7 -delete # ì„ì‹œ íŒŒì¼ ì •ë¦¬ find /tmp -mtime +1 -delete restartPolicy: OnFailure ì£¼ê°„ ì‘ì—… ë°±ì—… ê²€ì¦ í…ŒìŠ¤íŠ¸ ë³´ì•ˆ ìŠ¤ìº” ì‹¤í–‰ ì„±ëŠ¥ ë¦¬í¬íŠ¸ ì‘ì„± ë¹„ìš© ë¶„ì„ ë¦¬í¬íŠ¸ ì›”ê°„ ì‘ì—… DR(ì¬í•´ë³µêµ¬) í…ŒìŠ¤íŠ¸ ë³´ì•ˆ ê°ì‚¬ ìš©ëŸ‰ ê³„íš ê²€í†  ì•„í‚¤í…ì²˜ ë¦¬ë·° ì´ì œ ì™„ì „í•œ ìš´ì˜ ë§¤ë‰´ì–¼ì´ ì¤€ë¹„ë˜ì—ˆìŠµë‹ˆë‹¤! ğŸ› ï¸\n",
  "keywords": [
    
  ],
  "articleBody": "ğŸ› ï¸ OpenWebUI ìš´ì˜ ë§¤ë‰´ì–¼ ğŸ‘¥ ëŒ€ìƒ: DevOps ì—”ì§€ë‹ˆì–´, SRE, ì‹œìŠ¤í…œ ê´€ë¦¬ì\nğŸ“… ì—…ë°ì´íŠ¸: ì •ê¸°ì ìœ¼ë¡œ ì—…ë°ì´íŠ¸ í•„ìš”\nğŸš¨ ë¹„ìƒ ì—°ë½ì²˜: [íŒ€ ì—°ë½ì²˜ ì •ë³´]\nğŸ“‹ ì¼ì¼ ìš´ì˜ ì²´í¬ë¦¬ìŠ¤íŠ¸ ë§¤ì¼ í™•ì¸ í•­ëª© #!/bin/bash # daily-check.sh echo \"ğŸ“… $(date '+%Y-%m-%d %H:%M:%S') - ì¼ì¼ ìš´ì˜ ì²´í¬ ì‹œì‘\" # 1. í´ëŸ¬ìŠ¤í„° ìƒíƒœ kubectl get nodes kubectl get pods -A | grep -v Running # 2. ì• í”Œë¦¬ì¼€ì´ì…˜ ìƒíƒœ kubectl get pods -n openwebui -n litellm # 3. ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰ kubectl top nodes kubectl top pods -A # 4. ìµœê·¼ ì—ëŸ¬ ë¡œê·¸ (ìµœê·¼ 1ì‹œê°„) kubectl logs --since=1h -n openwebui -l app=openwebui | grep -i error | tail -10 # 5. ë””ìŠ¤í¬ ì‚¬ìš©ëŸ‰ kubectl get pvc -A echo \"âœ… ì¼ì¼ ì²´í¬ ì™„ë£Œ\" ì£¼ê°„ í™•ì¸ í•­ëª© ë°±ì—… ìƒíƒœ í™•ì¸ ë³´ì•ˆ íŒ¨ì¹˜ ê²€í†  ë¹„ìš© ì‚¬ìš©ëŸ‰ í™•ì¸ ì„±ëŠ¥ ë©”íŠ¸ë¦­ ê²€í†  ë¡œê·¸ ì •ë¦¬ ğŸ” ëª¨ë‹ˆí„°ë§ ë° ì•ŒëŒ í•µì‹¬ ë©”íŠ¸ë¦­ # prometheus-alerts.yml groups: - name: openwebui.rules rules: # íŒŒë“œ ìƒíƒœ ì•ŒëŒ - alert: PodCrashLooping expr: rate(kube_pod_container_status_restarts_total[5m]) \u003e 0 for: 5m annotations: summary: \"Pod {{ $labels.pod }} is crash looping\" # ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰ ì•ŒëŒ - alert: HighCPUUsage expr: (cpu_usage_rate \u003e 80) for: 10m annotations: summary: \"High CPU usage: {{ $value }}%\" # ì‘ë‹µ ì‹œê°„ ì•ŒëŒ - alert: HighResponseTime expr: http_request_duration_seconds \u003e 2 for: 5m annotations: summary: \"High response time: {{ $value }}s\" ë¡œê·¸ ëª¨ë‹ˆí„°ë§ # ì‹¤ì‹œê°„ ë¡œê·¸ ëª¨ë‹ˆí„°ë§ kubectl logs -f deployment/openwebui -n openwebui # ì—ëŸ¬ ë¡œê·¸ ê²€ìƒ‰ kubectl logs deployment/openwebui -n openwebui | grep -E \"(ERROR|FATAL|CRITICAL)\" # íŠ¹ì • ì‹œê°„ëŒ€ ë¡œê·¸ kubectl logs --since=2h --until=1h deployment/openwebui -n openwebui ğŸ“Š ì„±ëŠ¥ ê´€ë¦¬ ìŠ¤ì¼€ì¼ë§ ê´€ë¦¬ # ìˆ˜ë™ ìŠ¤ì¼€ì¼ë§ kubectl scale deployment openwebui --replicas=5 -n openwebui kubectl scale deployment litellm --replicas=3 -n litellm # HPA ìƒíƒœ í™•ì¸ kubectl get hpa -A # ìŠ¤ì¼€ì¼ë§ ì´ë²¤íŠ¸ í™•ì¸ kubectl describe hpa openwebui-hpa -n openwebui ë¦¬ì†ŒìŠ¤ ìµœì í™” # ë¦¬ì†ŒìŠ¤ ìš”ì²­ëŸ‰ ì¡°ì • ì˜ˆì‹œ resources: requests: memory: \"512Mi\" # ì‹¤ì œ ì‚¬ìš©ëŸ‰ ê¸°ë°˜ ì¡°ì • cpu: \"250m\" limits: memory: \"1Gi\" # OOM ë°©ì§€ cpu: \"500m\" # CPU ìŠ¤ë¡œí‹€ë§ ë°©ì§€ ë°ì´í„°ë² ì´ìŠ¤ ì„±ëŠ¥ # PostgreSQL ì—°ê²° ìˆ˜ í™•ì¸ kubectl exec deployment/postgres -n openwebui -- \\ psql -U openwebui -d openwebui -c \\ \"SELECT count(*) FROM pg_stat_activity WHERE state = 'active';\" # ìŠ¬ë¡œìš° ì¿¼ë¦¬ í™•ì¸ kubectl exec deployment/postgres -n openwebui -- \\ psql -U openwebui -d openwebui -c \\ \"SELECT query, mean_exec_time FROM pg_stat_statements ORDER BY mean_exec_time DESC LIMIT 10;\" # ë°ì´í„°ë² ì´ìŠ¤ í¬ê¸° í™•ì¸ kubectl exec deployment/postgres -n openwebui -- \\ psql -U openwebui -d openwebui -c \\ \"SELECT pg_size_pretty(pg_database_size('openwebui'));\" ğŸ”„ ë°±ì—… ë° ë³µì› ë°ì´í„°ë² ì´ìŠ¤ ë°±ì—… #!/bin/bash # backup-database.sh BACKUP_DATE=$(date +%Y%m%d_%H%M%S) BACKUP_FILE=\"openwebui_backup_${BACKUP_DATE}.sql\" # PostgreSQL ë°±ì—… kubectl exec deployment/postgres -n openwebui -- \\ pg_dump -U openwebui openwebui \u003e $BACKUP_FILE # S3ì— ì—…ë¡œë“œ aws s3 cp $BACKUP_FILE s3://openwebui-backups/database/ # ë¡œì»¬ íŒŒì¼ ì •ë¦¬ (7ì¼ ì´ìƒ ëœ íŒŒì¼) find . -name \"openwebui_backup_*.sql\" -mtime +7 -delete echo \"âœ… ë°±ì—… ì™„ë£Œ: $BACKUP_FILE\" ë°ì´í„°ë² ì´ìŠ¤ ë³µì› #!/bin/bash # restore-database.sh BACKUP_FILE=$1 if [ -z \"$BACKUP_FILE\" ]; then echo \"ì‚¬ìš©ë²•: $0 \" exit 1 fi # S3ì—ì„œ ë°±ì—… íŒŒì¼ ë‹¤ìš´ë¡œë“œ aws s3 cp s3://openwebui-backups/database/$BACKUP_FILE . # ì• í”Œë¦¬ì¼€ì´ì…˜ ì¤‘ì§€ kubectl scale deployment openwebui --replicas=0 -n openwebui kubectl scale deployment litellm --replicas=0 -n litellm # ë°ì´í„°ë² ì´ìŠ¤ ë³µì› kubectl exec -i deployment/postgres -n openwebui -- \\ psql -U openwebui openwebui \u003c $BACKUP_FILE # ì• í”Œë¦¬ì¼€ì´ì…˜ ì¬ì‹œì‘ kubectl scale deployment openwebui --replicas=2 -n openwebui kubectl scale deployment litellm --replicas=2 -n litellm echo \"âœ… ë³µì› ì™„ë£Œ\" ì„¤ì • íŒŒì¼ ë°±ì—… # ConfigMap ë°±ì—… kubectl get configmap -n openwebui -o yaml \u003e configmaps-backup.yaml kubectl get configmap -n litellm -o yaml \u003e\u003e configmaps-backup.yaml # Secret ë°±ì—… (ì•”í˜¸í™”ëœ í˜•íƒœ) kubectl get secret -n openwebui -o yaml \u003e secrets-backup.yaml kubectl get secret -n litellm -o yaml \u003e\u003e secrets-backup.yaml ğŸš¨ ì¥ì•  ëŒ€ì‘ ê¸´ê¸‰ ìƒí™© ëŒ€ì‘ ì ˆì°¨ 1ë‹¨ê³„: ìƒí™© íŒŒì•… (5ë¶„ ì´ë‚´) # ì „ì²´ ìƒíƒœ ë¹ ë¥¸ í™•ì¸ kubectl get pods -A | grep -v Running kubectl get nodes kubectl top nodes # ìµœê·¼ ì´ë²¤íŠ¸ í™•ì¸ kubectl get events -A --sort-by='.lastTimestamp' | tail -20 2ë‹¨ê³„: ì„ì‹œ ì¡°ì¹˜ (10ë¶„ ì´ë‚´) # íŒŒë“œ ì¬ì‹œì‘ kubectl rollout restart deployment/openwebui -n openwebui # íŠ¸ë˜í”½ ì°¨ë‹¨ (í•„ìš”ì‹œ) kubectl patch ingress openwebui-ingress -n openwebui -p \\ '{\"metadata\":{\"annotations\":{\"nginx.ingress.kubernetes.io/server-snippet\":\"return 503;\"}}}' # ìŠ¤ì¼€ì¼ ë‹¤ìš´ (ë¦¬ì†ŒìŠ¤ ë¶€ì¡± ì‹œ) kubectl scale deployment openwebui --replicas=1 -n openwebui 3ë‹¨ê³„: ê·¼ë³¸ ì›ì¸ ë¶„ì„ # ìƒì„¸ ë¡œê·¸ ë¶„ì„ kubectl logs deployment/openwebui -n openwebui --previous kubectl describe pod -l app=openwebui -n openwebui # ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰ ë¶„ì„ kubectl top pods -n openwebui --containers kubectl describe nodes ì¼ë°˜ì ì¸ ì¥ì•  ì‹œë‚˜ë¦¬ì˜¤ íŒŒë“œê°€ ì‹œì‘ë˜ì§€ ì•ŠëŠ” ê²½ìš° # ì›ì¸ í™•ì¸ kubectl describe pod -n openwebui # ì¼ë°˜ì ì¸ í•´ê²°ì±… # 1. ì´ë¯¸ì§€ ë¬¸ì œ kubectl get pods -n openwebui -o jsonpath='{.items[*].spec.containers[*].image}' # 2. ë¦¬ì†ŒìŠ¤ ë¶€ì¡± kubectl describe nodes | grep -A 5 \"Allocated resources\" # 3. PVC ë§ˆìš´íŠ¸ ì‹¤íŒ¨ kubectl get pvc -n openwebui kubectl describe pvc -n openwebui ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì‹¤íŒ¨ # PostgreSQL ìƒíƒœ í™•ì¸ kubectl get pods -l app=postgres -n openwebui kubectl logs deployment/postgres -n openwebui # ì—°ê²° í…ŒìŠ¤íŠ¸ kubectl exec deployment/postgres -n openwebui -- pg_isready # ë„¤íŠ¸ì›Œí¬ ì—°ê²° í™•ì¸ kubectl exec deployment/openwebui -n openwebui -- \\ nc -zv postgres-service 5432 ë†’ì€ ì‘ë‹µ ì‹œê°„ # ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰ í™•ì¸ kubectl top pods -n openwebui # HPA ìŠ¤ì¼€ì¼ë§ ê°•ì œ ì‹¤í–‰ kubectl patch hpa openwebui-hpa -n openwebui -p \\ '{\"spec\":{\"minReplicas\":3}}' # ìºì‹œ í´ë¦¬ì–´ (ì• í”Œë¦¬ì¼€ì´ì…˜ë³„ ë°©ë²•) kubectl exec deployment/openwebui -n openwebui -- \\ curl -X POST http://localhost:8080/api/v1/cache/clear ğŸ”§ ìœ ì§€ë³´ìˆ˜ ì •ê¸° ì—…ë°ì´íŠ¸ #!/bin/bash # update-system.sh echo \"ğŸ”„ ì‹œìŠ¤í…œ ì—…ë°ì´íŠ¸ ì‹œì‘...\" # 1. EKS í´ëŸ¬ìŠ¤í„° ì—…ë°ì´íŠ¸ í™•ì¸ aws eks describe-cluster --name openwebui-eks-dev \\ --query 'cluster.version' --output text # 2. ë…¸ë“œ ê·¸ë£¹ ì—…ë°ì´íŠ¸ í™•ì¸ aws eks describe-nodegroup --cluster-name openwebui-eks-dev \\ --nodegroup-name primary-nodes \\ --query 'nodegroup.version' --output text # 3. Add-on ì—…ë°ì´íŠ¸ kubectl get pods -n kube-system # 4. ì• í”Œë¦¬ì¼€ì´ì…˜ ì´ë¯¸ì§€ ì—…ë°ì´íŠ¸ kubectl set image deployment/openwebui openwebui=ghcr.io/openwebui:latest -n openwebui echo \"âœ… ì—…ë°ì´íŠ¸ ì™„ë£Œ\" ë³´ì•ˆ íŒ¨ì¹˜ # ë³´ì•ˆ ìŠ¤ìº” ì‹¤í–‰ trivy image ghcr.io/openwebui:latest # ì·¨ì•½ì  ìˆëŠ” ì»¨í…Œì´ë„ˆ ì¬ë°°í¬ kubectl rollout restart deployment/openwebui -n openwebui # ì‹œí¬ë¦¿ ë¡œí…Œì´ì…˜ kubectl create secret generic api-keys \\ --from-literal=OPENAI_API_KEY=new-key \\ --dry-run=client -o yaml | kubectl apply -f - ìš©ëŸ‰ ê´€ë¦¬ # ë””ìŠ¤í¬ ì‚¬ìš©ëŸ‰ ëª¨ë‹ˆí„°ë§ kubectl get pvc -A -o custom-columns=NAME:.metadata.name,SIZE:.spec.resources.requests.storage,USED:.status.capacity.storage # ë¡œê·¸ ì •ë¦¬ kubectl logs deployment/openwebui -n openwebui --tail=1000 \u003e /dev/null # ì´ë¯¸ì§€ ì •ë¦¬ (ë…¸ë“œì—ì„œ ì§ì ‘) docker system prune -a ğŸ“ˆ ì„±ëŠ¥ íŠœë‹ ì• í”Œë¦¬ì¼€ì´ì…˜ ìµœì í™” # OpenWebUI ì„±ëŠ¥ ì„¤ì • env: - name: WEBUI_SECRET_KEY value: \"optimized-secret-key\" - name: MAX_WORKERS value: \"4\" - name: TIMEOUT value: \"60\" - name: KEEP_ALIVE value: \"2\" ë°ì´í„°ë² ì´ìŠ¤ íŠœë‹ -- PostgreSQL ì„±ëŠ¥ íŠœë‹ -- ì—°ê²° í’€ ì„¤ì • ALTER SYSTEM SET max_connections = 100; ALTER SYSTEM SET shared_buffers = '256MB'; ALTER SYSTEM SET effective_cache_size = '1GB'; ALTER SYSTEM SET work_mem = '4MB'; -- ì¸ë±ìŠ¤ í™•ì¸ ë° ìµœì í™” SELECT schemaname, tablename, attname, n_distinct, correlation FROM pg_stats WHERE tablename = 'your_table'; ë„¤íŠ¸ì›Œí¬ ìµœì í™” # Ingress ì„¤ì • ìµœì í™” annotations: nginx.ingress.kubernetes.io/proxy-connect-timeout: \"60\" nginx.ingress.kubernetes.io/proxy-send-timeout: \"60\" nginx.ingress.kubernetes.io/proxy-read-timeout: \"60\" nginx.ingress.kubernetes.io/proxy-body-size: \"50m\" nginx.ingress.kubernetes.io/enable-cors: \"true\" ğŸ’° ë¹„ìš© ìµœì í™” ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰ ë¶„ì„ # ë…¸ë“œ ë¹„ìš© ë¶„ì„ kubectl describe nodes | grep -A 3 \"Allocated resources\" # Spot ì¸ìŠ¤í„´ìŠ¤ í™œìš©ë¥  kubectl get nodes -l node.kubernetes.io/instance-type # ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ë¦¬ì†ŒìŠ¤ ì •ë¦¬ kubectl get pods -A --field-selector=status.phase=Succeeded kubectl delete pods --field-selector=status.phase=Succeeded -A ìë™ ìŠ¤ì¼€ì¼ë§ ìµœì í™” # ë¹„ìš© íš¨ìœ¨ì ì¸ HPA ì„¤ì • spec: minReplicas: 1 # ìµœì†Œ ë¹„ìš© maxReplicas: 10 # íŠ¸ë˜í”½ ëŒ€ì‘ targetCPUUtilizationPercentage: 70 # ì ì ˆí•œ í™œìš©ë¥  behavior: scaleDown: stabilizationWindowSeconds: 300 # ê¸‰ê²©í•œ ìŠ¤ì¼€ì¼ ë‹¤ìš´ ë°©ì§€ policies: - type: Percent value: 50 periodSeconds: 60 ğŸ“ ë¹„ìƒ ì—°ë½ ì²´ê³„ ì¥ì•  ë“±ê¸‰ë³„ ëŒ€ì‘ P0 (Critical): - ì„œë¹„ìŠ¤ ì™„ì „ ì¤‘ë‹¨ - ì¦‰ì‹œ ëŒ€ì‘ (24/7) - ì—°ë½ì²˜: [ê¸´ê¸‰ ì—°ë½ì²˜] P1 (High): - ì£¼ìš” ê¸°ëŠ¥ ì¥ì•  - 4ì‹œê°„ ì´ë‚´ ëŒ€ì‘ - ì—°ë½ì²˜: [íŒ€ ë¦¬ë”] P2 (Medium): - ë¶€ë¶„ ê¸°ëŠ¥ ì¥ì•  - 24ì‹œê°„ ì´ë‚´ ëŒ€ì‘ - ì—°ë½ì²˜: [ë‹´ë‹¹ì] P3 (Low): - ì„±ëŠ¥ ì €í•˜ - 72ì‹œê°„ ì´ë‚´ ëŒ€ì‘ - ì—°ë½ì²˜: [íŒ€ ë©”ì¼] ì—ìŠ¤ì»¬ë ˆì´ì…˜ ì ˆì°¨ 1ì°¨ ë‹´ë‹¹ì (30ë¶„ ì´ë‚´ ì‘ë‹µ) íŒ€ ë¦¬ë” (1ì‹œê°„ ì´ë‚´) ê¸°ìˆ  ì±…ì„ì (2ì‹œê°„ ì´ë‚´) CTO (4ì‹œê°„ ì´ë‚´) ğŸ“š ìš´ì˜ ë„êµ¬ ë° ëŒ€ì‹œë³´ë“œ í•„ìˆ˜ ë„êµ¬ # kubectl í”ŒëŸ¬ê·¸ì¸ ì„¤ì¹˜ kubectl krew install ctx ns stern top # ìœ ìš©í•œ ëª…ë ¹ì–´ ë³„ì¹­ alias k='kubectl' alias kgp='kubectl get pods' alias kgs='kubectl get svc' alias kgn='kubectl get nodes' alias kdp='kubectl describe pod' alias kl='kubectl logs' ëª¨ë‹ˆí„°ë§ ëŒ€ì‹œë³´ë“œ Grafana: http://grafana.your-domain.com Prometheus: http://prometheus.your-domain.com Jaeger: http://jaeger.your-domain.com (íŠ¸ë ˆì´ì‹±) ArgoCD: http://argocd.your-domain.com (GitOps) ë¡œê·¸ ë¶„ì„ # ì¤‘ì•™í™”ëœ ë¡œê¹… (ELK Stack) kubectl port-forward svc/kibana 5601:5601 -n logging # ë¡œê·¸ ì¿¼ë¦¬ ì˜ˆì‹œ # Kibanaì—ì„œ: kubernetes.namespace:\"openwebui\" AND level:\"ERROR\" ğŸ”„ ì •ê¸° ì‘ì—… ìŠ¤ì¼€ì¤„ ì¼ì¼ ì‘ì—… (ìë™í™”) # CronJob ì˜ˆì‹œ apiVersion: batch/v1 kind: CronJob metadata: name: daily-cleanup spec: schedule: \"0 2 * * *\" # ë§¤ì¼ ì˜¤ì „ 2ì‹œ jobTemplate: spec: template: spec: containers: - name: cleanup image: alpine:latest command: - /bin/sh - -c - | # ë¡œê·¸ ì •ë¦¬ find /var/log -name \"*.log\" -mtime +7 -delete # ì„ì‹œ íŒŒì¼ ì •ë¦¬ find /tmp -mtime +1 -delete restartPolicy: OnFailure ì£¼ê°„ ì‘ì—… ë°±ì—… ê²€ì¦ í…ŒìŠ¤íŠ¸ ë³´ì•ˆ ìŠ¤ìº” ì‹¤í–‰ ì„±ëŠ¥ ë¦¬í¬íŠ¸ ì‘ì„± ë¹„ìš© ë¶„ì„ ë¦¬í¬íŠ¸ ì›”ê°„ ì‘ì—… DR(ì¬í•´ë³µêµ¬) í…ŒìŠ¤íŠ¸ ë³´ì•ˆ ê°ì‚¬ ìš©ëŸ‰ ê³„íš ê²€í†  ì•„í‚¤í…ì²˜ ë¦¬ë·° ì´ì œ ì™„ì „í•œ ìš´ì˜ ë§¤ë‰´ì–¼ì´ ì¤€ë¹„ë˜ì—ˆìŠµë‹ˆë‹¤! ğŸ› ï¸\n",
  "wordCount" : "1419",
  "inLanguage": "en",
  "datePublished": "0001-01-01T00:00:00Z",
  "dateModified": "0001-01-01T00:00:00Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://8dobibim.github.io/backend/%EC%9A%B4%EC%98%81-%EB%A9%94%EB%89%B4%EC%96%BC/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "8dobibim Tech Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://8dobibim.github.io/%3Clink%20/%20abs%20url%3E"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://8dobibim.github.io/" accesskey="h" title="8dobibim Tech Blog (Alt + H)">8dobibim Tech Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://8dobibim.github.io/frontend/" title="ğŸ–¥ í”„ë¡ íŠ¸ì—”ë“œ">
                    <span>ğŸ–¥ í”„ë¡ íŠ¸ì—”ë“œ</span>
                </a>
            </li>
            <li>
                <a href="https://8dobibim.github.io/backend/" title="ğŸ’¾ ë°±ì—”ë“œ">
                    <span>ğŸ’¾ ë°±ì—”ë“œ</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://8dobibim.github.io/">Home</a>&nbsp;Â»&nbsp;<a href="https://8dobibim.github.io/backend/">Backend ë¬¸ì„œ</a></div>
    <h1 class="post-title entry-hint-parent">
      
    </h1>
    <div class="post-meta">7 min&nbsp;Â·&nbsp;1419 words

</div>
  </header> <div class="toc">
    <details  open>
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#-openwebui-%ec%9a%b4%ec%98%81-%eb%a7%a4%eb%89%b4%ec%96%bc" aria-label="ğŸ› ï¸ OpenWebUI ìš´ì˜ ë§¤ë‰´ì–¼">ğŸ› ï¸ OpenWebUI ìš´ì˜ ë§¤ë‰´ì–¼</a><ul>
                        
                <li>
                    <a href="#-%ec%9d%bc%ec%9d%bc-%ec%9a%b4%ec%98%81-%ec%b2%b4%ed%81%ac%eb%a6%ac%ec%8a%a4%ed%8a%b8" aria-label="ğŸ“‹ ì¼ì¼ ìš´ì˜ ì²´í¬ë¦¬ìŠ¤íŠ¸">ğŸ“‹ ì¼ì¼ ìš´ì˜ ì²´í¬ë¦¬ìŠ¤íŠ¸</a><ul>
                        
                <li>
                    <a href="#%eb%a7%a4%ec%9d%bc-%ed%99%95%ec%9d%b8-%ed%95%ad%eb%aa%a9" aria-label="ë§¤ì¼ í™•ì¸ í•­ëª©">ë§¤ì¼ í™•ì¸ í•­ëª©</a></li>
                <li>
                    <a href="#%ec%a3%bc%ea%b0%84-%ed%99%95%ec%9d%b8-%ed%95%ad%eb%aa%a9" aria-label="ì£¼ê°„ í™•ì¸ í•­ëª©">ì£¼ê°„ í™•ì¸ í•­ëª©</a></li></ul>
                </li>
                <li>
                    <a href="#-%eb%aa%a8%eb%8b%88%ed%84%b0%eb%a7%81-%eb%b0%8f-%ec%95%8c%eb%9e%8c" aria-label="ğŸ” ëª¨ë‹ˆí„°ë§ ë° ì•ŒëŒ">ğŸ” ëª¨ë‹ˆí„°ë§ ë° ì•ŒëŒ</a><ul>
                        
                <li>
                    <a href="#%ed%95%b5%ec%8b%ac-%eb%a9%94%ed%8a%b8%eb%a6%ad" aria-label="í•µì‹¬ ë©”íŠ¸ë¦­">í•µì‹¬ ë©”íŠ¸ë¦­</a></li>
                <li>
                    <a href="#%eb%a1%9c%ea%b7%b8-%eb%aa%a8%eb%8b%88%ed%84%b0%eb%a7%81" aria-label="ë¡œê·¸ ëª¨ë‹ˆí„°ë§">ë¡œê·¸ ëª¨ë‹ˆí„°ë§</a></li></ul>
                </li>
                <li>
                    <a href="#-%ec%84%b1%eb%8a%a5-%ea%b4%80%eb%a6%ac" aria-label="ğŸ“Š ì„±ëŠ¥ ê´€ë¦¬">ğŸ“Š ì„±ëŠ¥ ê´€ë¦¬</a><ul>
                        
                <li>
                    <a href="#%ec%8a%a4%ec%bc%80%ec%9d%bc%eb%a7%81-%ea%b4%80%eb%a6%ac" aria-label="ìŠ¤ì¼€ì¼ë§ ê´€ë¦¬">ìŠ¤ì¼€ì¼ë§ ê´€ë¦¬</a></li>
                <li>
                    <a href="#%eb%a6%ac%ec%86%8c%ec%8a%a4-%ec%b5%9c%ec%a0%81%ed%99%94" aria-label="ë¦¬ì†ŒìŠ¤ ìµœì í™”">ë¦¬ì†ŒìŠ¤ ìµœì í™”</a></li>
                <li>
                    <a href="#%eb%8d%b0%ec%9d%b4%ed%84%b0%eb%b2%a0%ec%9d%b4%ec%8a%a4-%ec%84%b1%eb%8a%a5" aria-label="ë°ì´í„°ë² ì´ìŠ¤ ì„±ëŠ¥">ë°ì´í„°ë² ì´ìŠ¤ ì„±ëŠ¥</a></li></ul>
                </li>
                <li>
                    <a href="#-%eb%b0%b1%ec%97%85-%eb%b0%8f-%eb%b3%b5%ec%9b%90" aria-label="ğŸ”„ ë°±ì—… ë° ë³µì›">ğŸ”„ ë°±ì—… ë° ë³µì›</a><ul>
                        
                <li>
                    <a href="#%eb%8d%b0%ec%9d%b4%ed%84%b0%eb%b2%a0%ec%9d%b4%ec%8a%a4-%eb%b0%b1%ec%97%85" aria-label="ë°ì´í„°ë² ì´ìŠ¤ ë°±ì—…">ë°ì´í„°ë² ì´ìŠ¤ ë°±ì—…</a></li>
                <li>
                    <a href="#%eb%8d%b0%ec%9d%b4%ed%84%b0%eb%b2%a0%ec%9d%b4%ec%8a%a4-%eb%b3%b5%ec%9b%90" aria-label="ë°ì´í„°ë² ì´ìŠ¤ ë³µì›">ë°ì´í„°ë² ì´ìŠ¤ ë³µì›</a></li>
                <li>
                    <a href="#%ec%84%a4%ec%a0%95-%ed%8c%8c%ec%9d%bc-%eb%b0%b1%ec%97%85" aria-label="ì„¤ì • íŒŒì¼ ë°±ì—…">ì„¤ì • íŒŒì¼ ë°±ì—…</a></li></ul>
                </li>
                <li>
                    <a href="#-%ec%9e%a5%ec%95%a0-%eb%8c%80%ec%9d%91" aria-label="ğŸš¨ ì¥ì•  ëŒ€ì‘">ğŸš¨ ì¥ì•  ëŒ€ì‘</a><ul>
                        
                <li>
                    <a href="#%ea%b8%b4%ea%b8%89-%ec%83%81%ed%99%a9-%eb%8c%80%ec%9d%91-%ec%a0%88%ec%b0%a8" aria-label="ê¸´ê¸‰ ìƒí™© ëŒ€ì‘ ì ˆì°¨">ê¸´ê¸‰ ìƒí™© ëŒ€ì‘ ì ˆì°¨</a><ul>
                        
                <li>
                    <a href="#1%eb%8b%a8%ea%b3%84-%ec%83%81%ed%99%a9-%ed%8c%8c%ec%95%85-5%eb%b6%84-%ec%9d%b4%eb%82%b4" aria-label="1ë‹¨ê³„: ìƒí™© íŒŒì•… (5ë¶„ ì´ë‚´)">1ë‹¨ê³„: ìƒí™© íŒŒì•… (5ë¶„ ì´ë‚´)</a></li>
                <li>
                    <a href="#2%eb%8b%a8%ea%b3%84-%ec%9e%84%ec%8b%9c-%ec%a1%b0%ec%b9%98-10%eb%b6%84-%ec%9d%b4%eb%82%b4" aria-label="2ë‹¨ê³„: ì„ì‹œ ì¡°ì¹˜ (10ë¶„ ì´ë‚´)">2ë‹¨ê³„: ì„ì‹œ ì¡°ì¹˜ (10ë¶„ ì´ë‚´)</a></li>
                <li>
                    <a href="#3%eb%8b%a8%ea%b3%84-%ea%b7%bc%eb%b3%b8-%ec%9b%90%ec%9d%b8-%eb%b6%84%ec%84%9d" aria-label="3ë‹¨ê³„: ê·¼ë³¸ ì›ì¸ ë¶„ì„">3ë‹¨ê³„: ê·¼ë³¸ ì›ì¸ ë¶„ì„</a></li></ul>
                </li>
                <li>
                    <a href="#%ec%9d%bc%eb%b0%98%ec%a0%81%ec%9d%b8-%ec%9e%a5%ec%95%a0-%ec%8b%9c%eb%82%98%eb%a6%ac%ec%98%a4" aria-label="ì¼ë°˜ì ì¸ ì¥ì•  ì‹œë‚˜ë¦¬ì˜¤">ì¼ë°˜ì ì¸ ì¥ì•  ì‹œë‚˜ë¦¬ì˜¤</a><ul>
                        
                <li>
                    <a href="#%ed%8c%8c%eb%93%9c%ea%b0%80-%ec%8b%9c%ec%9e%91%eb%90%98%ec%a7%80-%ec%95%8a%eb%8a%94-%ea%b2%bd%ec%9a%b0" aria-label="íŒŒë“œê°€ ì‹œì‘ë˜ì§€ ì•ŠëŠ” ê²½ìš°">íŒŒë“œê°€ ì‹œì‘ë˜ì§€ ì•ŠëŠ” ê²½ìš°</a></li>
                <li>
                    <a href="#%eb%8d%b0%ec%9d%b4%ed%84%b0%eb%b2%a0%ec%9d%b4%ec%8a%a4-%ec%97%b0%ea%b2%b0-%ec%8b%a4%ed%8c%a8" aria-label="ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì‹¤íŒ¨">ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì‹¤íŒ¨</a></li>
                <li>
                    <a href="#%eb%86%92%ec%9d%80-%ec%9d%91%eb%8b%b5-%ec%8b%9c%ea%b0%84" aria-label="ë†’ì€ ì‘ë‹µ ì‹œê°„">ë†’ì€ ì‘ë‹µ ì‹œê°„</a></li></ul>
                </li></ul>
                </li>
                <li>
                    <a href="#-%ec%9c%a0%ec%a7%80%eb%b3%b4%ec%88%98" aria-label="ğŸ”§ ìœ ì§€ë³´ìˆ˜">ğŸ”§ ìœ ì§€ë³´ìˆ˜</a><ul>
                        
                <li>
                    <a href="#%ec%a0%95%ea%b8%b0-%ec%97%85%eb%8d%b0%ec%9d%b4%ed%8a%b8" aria-label="ì •ê¸° ì—…ë°ì´íŠ¸">ì •ê¸° ì—…ë°ì´íŠ¸</a></li>
                <li>
                    <a href="#%eb%b3%b4%ec%95%88-%ed%8c%a8%ec%b9%98" aria-label="ë³´ì•ˆ íŒ¨ì¹˜">ë³´ì•ˆ íŒ¨ì¹˜</a></li>
                <li>
                    <a href="#%ec%9a%a9%eb%9f%89-%ea%b4%80%eb%a6%ac" aria-label="ìš©ëŸ‰ ê´€ë¦¬">ìš©ëŸ‰ ê´€ë¦¬</a></li></ul>
                </li>
                <li>
                    <a href="#-%ec%84%b1%eb%8a%a5-%ed%8a%9c%eb%8b%9d" aria-label="ğŸ“ˆ ì„±ëŠ¥ íŠœë‹">ğŸ“ˆ ì„±ëŠ¥ íŠœë‹</a><ul>
                        
                <li>
                    <a href="#%ec%95%a0%ed%94%8c%eb%a6%ac%ec%bc%80%ec%9d%b4%ec%85%98-%ec%b5%9c%ec%a0%81%ed%99%94" aria-label="ì• í”Œë¦¬ì¼€ì´ì…˜ ìµœì í™”">ì• í”Œë¦¬ì¼€ì´ì…˜ ìµœì í™”</a></li>
                <li>
                    <a href="#%eb%8d%b0%ec%9d%b4%ed%84%b0%eb%b2%a0%ec%9d%b4%ec%8a%a4-%ed%8a%9c%eb%8b%9d" aria-label="ë°ì´í„°ë² ì´ìŠ¤ íŠœë‹">ë°ì´í„°ë² ì´ìŠ¤ íŠœë‹</a></li>
                <li>
                    <a href="#%eb%84%a4%ed%8a%b8%ec%9b%8c%ed%81%ac-%ec%b5%9c%ec%a0%81%ed%99%94" aria-label="ë„¤íŠ¸ì›Œí¬ ìµœì í™”">ë„¤íŠ¸ì›Œí¬ ìµœì í™”</a></li></ul>
                </li>
                <li>
                    <a href="#-%eb%b9%84%ec%9a%a9-%ec%b5%9c%ec%a0%81%ed%99%94" aria-label="ğŸ’° ë¹„ìš© ìµœì í™”">ğŸ’° ë¹„ìš© ìµœì í™”</a><ul>
                        
                <li>
                    <a href="#%eb%a6%ac%ec%86%8c%ec%8a%a4-%ec%82%ac%ec%9a%a9%eb%9f%89-%eb%b6%84%ec%84%9d" aria-label="ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰ ë¶„ì„">ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰ ë¶„ì„</a></li>
                <li>
                    <a href="#%ec%9e%90%eb%8f%99-%ec%8a%a4%ec%bc%80%ec%9d%bc%eb%a7%81-%ec%b5%9c%ec%a0%81%ed%99%94" aria-label="ìë™ ìŠ¤ì¼€ì¼ë§ ìµœì í™”">ìë™ ìŠ¤ì¼€ì¼ë§ ìµœì í™”</a></li></ul>
                </li>
                <li>
                    <a href="#-%eb%b9%84%ec%83%81-%ec%97%b0%eb%9d%bd-%ec%b2%b4%ea%b3%84" aria-label="ğŸ“ ë¹„ìƒ ì—°ë½ ì²´ê³„">ğŸ“ ë¹„ìƒ ì—°ë½ ì²´ê³„</a><ul>
                        
                <li>
                    <a href="#%ec%9e%a5%ec%95%a0-%eb%93%b1%ea%b8%89%eb%b3%84-%eb%8c%80%ec%9d%91" aria-label="ì¥ì•  ë“±ê¸‰ë³„ ëŒ€ì‘">ì¥ì•  ë“±ê¸‰ë³„ ëŒ€ì‘</a></li>
                <li>
                    <a href="#%ec%97%90%ec%8a%a4%ec%bb%ac%eb%a0%88%ec%9d%b4%ec%85%98-%ec%a0%88%ec%b0%a8" aria-label="ì—ìŠ¤ì»¬ë ˆì´ì…˜ ì ˆì°¨">ì—ìŠ¤ì»¬ë ˆì´ì…˜ ì ˆì°¨</a></li></ul>
                </li>
                <li>
                    <a href="#-%ec%9a%b4%ec%98%81-%eb%8f%84%ea%b5%ac-%eb%b0%8f-%eb%8c%80%ec%8b%9c%eb%b3%b4%eb%93%9c" aria-label="ğŸ“š ìš´ì˜ ë„êµ¬ ë° ëŒ€ì‹œë³´ë“œ">ğŸ“š ìš´ì˜ ë„êµ¬ ë° ëŒ€ì‹œë³´ë“œ</a><ul>
                        
                <li>
                    <a href="#%ed%95%84%ec%88%98-%eb%8f%84%ea%b5%ac" aria-label="í•„ìˆ˜ ë„êµ¬">í•„ìˆ˜ ë„êµ¬</a></li>
                <li>
                    <a href="#%eb%aa%a8%eb%8b%88%ed%84%b0%eb%a7%81-%eb%8c%80%ec%8b%9c%eb%b3%b4%eb%93%9c" aria-label="ëª¨ë‹ˆí„°ë§ ëŒ€ì‹œë³´ë“œ">ëª¨ë‹ˆí„°ë§ ëŒ€ì‹œë³´ë“œ</a></li>
                <li>
                    <a href="#%eb%a1%9c%ea%b7%b8-%eb%b6%84%ec%84%9d" aria-label="ë¡œê·¸ ë¶„ì„">ë¡œê·¸ ë¶„ì„</a></li></ul>
                </li>
                <li>
                    <a href="#-%ec%a0%95%ea%b8%b0-%ec%9e%91%ec%97%85-%ec%8a%a4%ec%bc%80%ec%a4%84" aria-label="ğŸ”„ ì •ê¸° ì‘ì—… ìŠ¤ì¼€ì¤„">ğŸ”„ ì •ê¸° ì‘ì—… ìŠ¤ì¼€ì¤„</a><ul>
                        
                <li>
                    <a href="#%ec%9d%bc%ec%9d%bc-%ec%9e%91%ec%97%85-%ec%9e%90%eb%8f%99%ed%99%94" aria-label="ì¼ì¼ ì‘ì—… (ìë™í™”)">ì¼ì¼ ì‘ì—… (ìë™í™”)</a></li>
                <li>
                    <a href="#%ec%a3%bc%ea%b0%84-%ec%9e%91%ec%97%85" aria-label="ì£¼ê°„ ì‘ì—…">ì£¼ê°„ ì‘ì—…</a></li>
                <li>
                    <a href="#%ec%9b%94%ea%b0%84-%ec%9e%91%ec%97%85" aria-label="ì›”ê°„ ì‘ì—…">ì›”ê°„ ì‘ì—…</a>
                </li>
            </ul>
            </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h1 id="-openwebui-ìš´ì˜-ë§¤ë‰´ì–¼">ğŸ› ï¸ OpenWebUI ìš´ì˜ ë§¤ë‰´ì–¼<a hidden class="anchor" aria-hidden="true" href="#-openwebui-ìš´ì˜-ë§¤ë‰´ì–¼">#</a></h1>
<blockquote>
<p><strong>ğŸ‘¥ ëŒ€ìƒ</strong>: DevOps ì—”ì§€ë‹ˆì–´, SRE, ì‹œìŠ¤í…œ ê´€ë¦¬ì<br>
<strong>ğŸ“… ì—…ë°ì´íŠ¸</strong>: ì •ê¸°ì ìœ¼ë¡œ ì—…ë°ì´íŠ¸ í•„ìš”<br>
<strong>ğŸš¨ ë¹„ìƒ ì—°ë½ì²˜</strong>: [íŒ€ ì—°ë½ì²˜ ì •ë³´]</p></blockquote>
<hr>
<h2 id="-ì¼ì¼-ìš´ì˜-ì²´í¬ë¦¬ìŠ¤íŠ¸">ğŸ“‹ ì¼ì¼ ìš´ì˜ ì²´í¬ë¦¬ìŠ¤íŠ¸<a hidden class="anchor" aria-hidden="true" href="#-ì¼ì¼-ìš´ì˜-ì²´í¬ë¦¬ìŠ¤íŠ¸">#</a></h2>
<h3 id="ë§¤ì¼-í™•ì¸-í•­ëª©">ë§¤ì¼ í™•ì¸ í•­ëª©<a hidden class="anchor" aria-hidden="true" href="#ë§¤ì¼-í™•ì¸-í•­ëª©">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">#!/bin/bash
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#75715e"># daily-check.sh</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;ğŸ“… </span><span style="color:#66d9ef">$(</span>date <span style="color:#e6db74">&#39;+%Y-%m-%d %H:%M:%S&#39;</span><span style="color:#66d9ef">)</span><span style="color:#e6db74"> - ì¼ì¼ ìš´ì˜ ì²´í¬ ì‹œì‘&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 1. í´ëŸ¬ìŠ¤í„° ìƒíƒœ</span>
</span></span><span style="display:flex;"><span>kubectl get nodes
</span></span><span style="display:flex;"><span>kubectl get pods -A | grep -v Running
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 2. ì• í”Œë¦¬ì¼€ì´ì…˜ ìƒíƒœ</span>
</span></span><span style="display:flex;"><span>kubectl get pods -n openwebui -n litellm
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 3. ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰</span>
</span></span><span style="display:flex;"><span>kubectl top nodes
</span></span><span style="display:flex;"><span>kubectl top pods -A
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 4. ìµœê·¼ ì—ëŸ¬ ë¡œê·¸ (ìµœê·¼ 1ì‹œê°„)</span>
</span></span><span style="display:flex;"><span>kubectl logs --since<span style="color:#f92672">=</span>1h -n openwebui -l app<span style="color:#f92672">=</span>openwebui | grep -i error | tail -10
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 5. ë””ìŠ¤í¬ ì‚¬ìš©ëŸ‰</span>
</span></span><span style="display:flex;"><span>kubectl get pvc -A
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;âœ… ì¼ì¼ ì²´í¬ ì™„ë£Œ&#34;</span>
</span></span></code></pre></div><h3 id="ì£¼ê°„-í™•ì¸-í•­ëª©">ì£¼ê°„ í™•ì¸ í•­ëª©<a hidden class="anchor" aria-hidden="true" href="#ì£¼ê°„-í™•ì¸-í•­ëª©">#</a></h3>
<ul>
<li><input disabled="" type="checkbox"> ë°±ì—… ìƒíƒœ í™•ì¸</li>
<li><input disabled="" type="checkbox"> ë³´ì•ˆ íŒ¨ì¹˜ ê²€í† </li>
<li><input disabled="" type="checkbox"> ë¹„ìš© ì‚¬ìš©ëŸ‰ í™•ì¸</li>
<li><input disabled="" type="checkbox"> ì„±ëŠ¥ ë©”íŠ¸ë¦­ ê²€í† </li>
<li><input disabled="" type="checkbox"> ë¡œê·¸ ì •ë¦¬</li>
</ul>
<hr>
<h2 id="-ëª¨ë‹ˆí„°ë§-ë°-ì•ŒëŒ">ğŸ” ëª¨ë‹ˆí„°ë§ ë° ì•ŒëŒ<a hidden class="anchor" aria-hidden="true" href="#-ëª¨ë‹ˆí„°ë§-ë°-ì•ŒëŒ">#</a></h2>
<h3 id="í•µì‹¬-ë©”íŠ¸ë¦­">í•µì‹¬ ë©”íŠ¸ë¦­<a hidden class="anchor" aria-hidden="true" href="#í•µì‹¬-ë©”íŠ¸ë¦­">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#75715e"># prometheus-alerts.yml</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">groups</span>:
</span></span><span style="display:flex;"><span>- <span style="color:#f92672">name</span>: <span style="color:#ae81ff">openwebui.rules</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">rules</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># íŒŒë“œ ìƒíƒœ ì•ŒëŒ</span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">alert</span>: <span style="color:#ae81ff">PodCrashLooping</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">expr</span>: <span style="color:#ae81ff">rate(kube_pod_container_status_restarts_total[5m]) &gt; 0</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">for</span>: <span style="color:#ae81ff">5m</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">annotations</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">summary</span>: <span style="color:#e6db74">&#34;Pod {{ $labels.pod }} is crash looping&#34;</span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰ ì•ŒëŒ</span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">alert</span>: <span style="color:#ae81ff">HighCPUUsage</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">expr</span>: <span style="color:#ae81ff">(cpu_usage_rate &gt; 80)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">for</span>: <span style="color:#ae81ff">10m</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">annotations</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">summary</span>: <span style="color:#e6db74">&#34;High CPU usage: {{ $value }}%&#34;</span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># ì‘ë‹µ ì‹œê°„ ì•ŒëŒ</span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">alert</span>: <span style="color:#ae81ff">HighResponseTime</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">expr</span>: <span style="color:#ae81ff">http_request_duration_seconds &gt; 2</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">for</span>: <span style="color:#ae81ff">5m</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">annotations</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">summary</span>: <span style="color:#e6db74">&#34;High response time: {{ $value }}s&#34;</span>
</span></span></code></pre></div><h3 id="ë¡œê·¸-ëª¨ë‹ˆí„°ë§">ë¡œê·¸ ëª¨ë‹ˆí„°ë§<a hidden class="anchor" aria-hidden="true" href="#ë¡œê·¸-ëª¨ë‹ˆí„°ë§">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># ì‹¤ì‹œê°„ ë¡œê·¸ ëª¨ë‹ˆí„°ë§</span>
</span></span><span style="display:flex;"><span>kubectl logs -f deployment/openwebui -n openwebui
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ì—ëŸ¬ ë¡œê·¸ ê²€ìƒ‰</span>
</span></span><span style="display:flex;"><span>kubectl logs deployment/openwebui -n openwebui | grep -E <span style="color:#e6db74">&#34;(ERROR|FATAL|CRITICAL)&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># íŠ¹ì • ì‹œê°„ëŒ€ ë¡œê·¸</span>
</span></span><span style="display:flex;"><span>kubectl logs --since<span style="color:#f92672">=</span>2h --until<span style="color:#f92672">=</span>1h deployment/openwebui -n openwebui
</span></span></code></pre></div><hr>
<h2 id="-ì„±ëŠ¥-ê´€ë¦¬">ğŸ“Š ì„±ëŠ¥ ê´€ë¦¬<a hidden class="anchor" aria-hidden="true" href="#-ì„±ëŠ¥-ê´€ë¦¬">#</a></h2>
<h3 id="ìŠ¤ì¼€ì¼ë§-ê´€ë¦¬">ìŠ¤ì¼€ì¼ë§ ê´€ë¦¬<a hidden class="anchor" aria-hidden="true" href="#ìŠ¤ì¼€ì¼ë§-ê´€ë¦¬">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># ìˆ˜ë™ ìŠ¤ì¼€ì¼ë§</span>
</span></span><span style="display:flex;"><span>kubectl scale deployment openwebui --replicas<span style="color:#f92672">=</span><span style="color:#ae81ff">5</span> -n openwebui
</span></span><span style="display:flex;"><span>kubectl scale deployment litellm --replicas<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span> -n litellm
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># HPA ìƒíƒœ í™•ì¸</span>
</span></span><span style="display:flex;"><span>kubectl get hpa -A
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ìŠ¤ì¼€ì¼ë§ ì´ë²¤íŠ¸ í™•ì¸</span>
</span></span><span style="display:flex;"><span>kubectl describe hpa openwebui-hpa -n openwebui
</span></span></code></pre></div><h3 id="ë¦¬ì†ŒìŠ¤-ìµœì í™”">ë¦¬ì†ŒìŠ¤ ìµœì í™”<a hidden class="anchor" aria-hidden="true" href="#ë¦¬ì†ŒìŠ¤-ìµœì í™”">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#75715e"># ë¦¬ì†ŒìŠ¤ ìš”ì²­ëŸ‰ ì¡°ì • ì˜ˆì‹œ</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">resources</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">requests</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">memory</span>: <span style="color:#e6db74">&#34;512Mi&#34;</span>    <span style="color:#75715e"># ì‹¤ì œ ì‚¬ìš©ëŸ‰ ê¸°ë°˜ ì¡°ì •</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">cpu</span>: <span style="color:#e6db74">&#34;250m&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">limits</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">memory</span>: <span style="color:#e6db74">&#34;1Gi&#34;</span>      <span style="color:#75715e"># OOM ë°©ì§€</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">cpu</span>: <span style="color:#e6db74">&#34;500m&#34;</span>        <span style="color:#75715e"># CPU ìŠ¤ë¡œí‹€ë§ ë°©ì§€</span>
</span></span></code></pre></div><h3 id="ë°ì´í„°ë² ì´ìŠ¤-ì„±ëŠ¥">ë°ì´í„°ë² ì´ìŠ¤ ì„±ëŠ¥<a hidden class="anchor" aria-hidden="true" href="#ë°ì´í„°ë² ì´ìŠ¤-ì„±ëŠ¥">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># PostgreSQL ì—°ê²° ìˆ˜ í™•ì¸</span>
</span></span><span style="display:flex;"><span>kubectl exec deployment/postgres -n openwebui -- <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  psql -U openwebui -d openwebui -c <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  <span style="color:#e6db74">&#34;SELECT count(*) FROM pg_stat_activity WHERE state = &#39;active&#39;;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ìŠ¬ë¡œìš° ì¿¼ë¦¬ í™•ì¸</span>
</span></span><span style="display:flex;"><span>kubectl exec deployment/postgres -n openwebui -- <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  psql -U openwebui -d openwebui -c <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  <span style="color:#e6db74">&#34;SELECT query, mean_exec_time FROM pg_stat_statements ORDER BY mean_exec_time DESC LIMIT 10;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ë°ì´í„°ë² ì´ìŠ¤ í¬ê¸° í™•ì¸</span>
</span></span><span style="display:flex;"><span>kubectl exec deployment/postgres -n openwebui -- <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  psql -U openwebui -d openwebui -c <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  <span style="color:#e6db74">&#34;SELECT pg_size_pretty(pg_database_size(&#39;openwebui&#39;));&#34;</span>
</span></span></code></pre></div><hr>
<h2 id="-ë°±ì—…-ë°-ë³µì›">ğŸ”„ ë°±ì—… ë° ë³µì›<a hidden class="anchor" aria-hidden="true" href="#-ë°±ì—…-ë°-ë³µì›">#</a></h2>
<h3 id="ë°ì´í„°ë² ì´ìŠ¤-ë°±ì—…">ë°ì´í„°ë² ì´ìŠ¤ ë°±ì—…<a hidden class="anchor" aria-hidden="true" href="#ë°ì´í„°ë² ì´ìŠ¤-ë°±ì—…">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">#!/bin/bash
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#75715e"># backup-database.sh</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>BACKUP_DATE<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>date +%Y%m%d_%H%M%S<span style="color:#66d9ef">)</span>
</span></span><span style="display:flex;"><span>BACKUP_FILE<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;openwebui_backup_</span><span style="color:#e6db74">${</span>BACKUP_DATE<span style="color:#e6db74">}</span><span style="color:#e6db74">.sql&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># PostgreSQL ë°±ì—…</span>
</span></span><span style="display:flex;"><span>kubectl exec deployment/postgres -n openwebui -- <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  pg_dump -U openwebui openwebui &gt; $BACKUP_FILE
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># S3ì— ì—…ë¡œë“œ</span>
</span></span><span style="display:flex;"><span>aws s3 cp $BACKUP_FILE s3://openwebui-backups/database/
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ë¡œì»¬ íŒŒì¼ ì •ë¦¬ (7ì¼ ì´ìƒ ëœ íŒŒì¼)</span>
</span></span><span style="display:flex;"><span>find . -name <span style="color:#e6db74">&#34;openwebui_backup_*.sql&#34;</span> -mtime +7 -delete
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;âœ… ë°±ì—… ì™„ë£Œ: </span>$BACKUP_FILE<span style="color:#e6db74">&#34;</span>
</span></span></code></pre></div><h3 id="ë°ì´í„°ë² ì´ìŠ¤-ë³µì›">ë°ì´í„°ë² ì´ìŠ¤ ë³µì›<a hidden class="anchor" aria-hidden="true" href="#ë°ì´í„°ë² ì´ìŠ¤-ë³µì›">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">#!/bin/bash
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#75715e"># restore-database.sh</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>BACKUP_FILE<span style="color:#f92672">=</span>$1
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> -z <span style="color:#e6db74">&#34;</span>$BACKUP_FILE<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>  echo <span style="color:#e6db74">&#34;ì‚¬ìš©ë²•: </span>$0<span style="color:#e6db74"> &lt;backup_file&gt;&#34;</span>
</span></span><span style="display:flex;"><span>  exit <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># S3ì—ì„œ ë°±ì—… íŒŒì¼ ë‹¤ìš´ë¡œë“œ</span>
</span></span><span style="display:flex;"><span>aws s3 cp s3://openwebui-backups/database/$BACKUP_FILE .
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ì• í”Œë¦¬ì¼€ì´ì…˜ ì¤‘ì§€</span>
</span></span><span style="display:flex;"><span>kubectl scale deployment openwebui --replicas<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span> -n openwebui
</span></span><span style="display:flex;"><span>kubectl scale deployment litellm --replicas<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span> -n litellm
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ë°ì´í„°ë² ì´ìŠ¤ ë³µì›</span>
</span></span><span style="display:flex;"><span>kubectl exec -i deployment/postgres -n openwebui -- <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  psql -U openwebui openwebui &lt; $BACKUP_FILE
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ì• í”Œë¦¬ì¼€ì´ì…˜ ì¬ì‹œì‘</span>
</span></span><span style="display:flex;"><span>kubectl scale deployment openwebui --replicas<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span> -n openwebui
</span></span><span style="display:flex;"><span>kubectl scale deployment litellm --replicas<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span> -n litellm
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;âœ… ë³µì› ì™„ë£Œ&#34;</span>
</span></span></code></pre></div><h3 id="ì„¤ì •-íŒŒì¼-ë°±ì—…">ì„¤ì • íŒŒì¼ ë°±ì—…<a hidden class="anchor" aria-hidden="true" href="#ì„¤ì •-íŒŒì¼-ë°±ì—…">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># ConfigMap ë°±ì—…</span>
</span></span><span style="display:flex;"><span>kubectl get configmap -n openwebui -o yaml &gt; configmaps-backup.yaml
</span></span><span style="display:flex;"><span>kubectl get configmap -n litellm -o yaml &gt;&gt; configmaps-backup.yaml
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Secret ë°±ì—… (ì•”í˜¸í™”ëœ í˜•íƒœ)</span>
</span></span><span style="display:flex;"><span>kubectl get secret -n openwebui -o yaml &gt; secrets-backup.yaml
</span></span><span style="display:flex;"><span>kubectl get secret -n litellm -o yaml &gt;&gt; secrets-backup.yaml
</span></span></code></pre></div><hr>
<h2 id="-ì¥ì• -ëŒ€ì‘">ğŸš¨ ì¥ì•  ëŒ€ì‘<a hidden class="anchor" aria-hidden="true" href="#-ì¥ì• -ëŒ€ì‘">#</a></h2>
<h3 id="ê¸´ê¸‰-ìƒí™©-ëŒ€ì‘-ì ˆì°¨">ê¸´ê¸‰ ìƒí™© ëŒ€ì‘ ì ˆì°¨<a hidden class="anchor" aria-hidden="true" href="#ê¸´ê¸‰-ìƒí™©-ëŒ€ì‘-ì ˆì°¨">#</a></h3>
<h4 id="1ë‹¨ê³„-ìƒí™©-íŒŒì•…-5ë¶„-ì´ë‚´">1ë‹¨ê³„: ìƒí™© íŒŒì•… (5ë¶„ ì´ë‚´)<a hidden class="anchor" aria-hidden="true" href="#1ë‹¨ê³„-ìƒí™©-íŒŒì•…-5ë¶„-ì´ë‚´">#</a></h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># ì „ì²´ ìƒíƒœ ë¹ ë¥¸ í™•ì¸</span>
</span></span><span style="display:flex;"><span>kubectl get pods -A | grep -v Running
</span></span><span style="display:flex;"><span>kubectl get nodes
</span></span><span style="display:flex;"><span>kubectl top nodes
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ìµœê·¼ ì´ë²¤íŠ¸ í™•ì¸</span>
</span></span><span style="display:flex;"><span>kubectl get events -A --sort-by<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;.lastTimestamp&#39;</span> | tail -20
</span></span></code></pre></div><h4 id="2ë‹¨ê³„-ì„ì‹œ-ì¡°ì¹˜-10ë¶„-ì´ë‚´">2ë‹¨ê³„: ì„ì‹œ ì¡°ì¹˜ (10ë¶„ ì´ë‚´)<a hidden class="anchor" aria-hidden="true" href="#2ë‹¨ê³„-ì„ì‹œ-ì¡°ì¹˜-10ë¶„-ì´ë‚´">#</a></h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># íŒŒë“œ ì¬ì‹œì‘</span>
</span></span><span style="display:flex;"><span>kubectl rollout restart deployment/openwebui -n openwebui
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># íŠ¸ë˜í”½ ì°¨ë‹¨ (í•„ìš”ì‹œ)</span>
</span></span><span style="display:flex;"><span>kubectl patch ingress openwebui-ingress -n openwebui -p <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  <span style="color:#e6db74">&#39;{&#34;metadata&#34;:{&#34;annotations&#34;:{&#34;nginx.ingress.kubernetes.io/server-snippet&#34;:&#34;return 503;&#34;}}}&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ìŠ¤ì¼€ì¼ ë‹¤ìš´ (ë¦¬ì†ŒìŠ¤ ë¶€ì¡± ì‹œ)</span>
</span></span><span style="display:flex;"><span>kubectl scale deployment openwebui --replicas<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span> -n openwebui
</span></span></code></pre></div><h4 id="3ë‹¨ê³„-ê·¼ë³¸-ì›ì¸-ë¶„ì„">3ë‹¨ê³„: ê·¼ë³¸ ì›ì¸ ë¶„ì„<a hidden class="anchor" aria-hidden="true" href="#3ë‹¨ê³„-ê·¼ë³¸-ì›ì¸-ë¶„ì„">#</a></h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># ìƒì„¸ ë¡œê·¸ ë¶„ì„</span>
</span></span><span style="display:flex;"><span>kubectl logs deployment/openwebui -n openwebui --previous
</span></span><span style="display:flex;"><span>kubectl describe pod -l app<span style="color:#f92672">=</span>openwebui -n openwebui
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰ ë¶„ì„</span>
</span></span><span style="display:flex;"><span>kubectl top pods -n openwebui --containers
</span></span><span style="display:flex;"><span>kubectl describe nodes
</span></span></code></pre></div><h3 id="ì¼ë°˜ì ì¸-ì¥ì• -ì‹œë‚˜ë¦¬ì˜¤">ì¼ë°˜ì ì¸ ì¥ì•  ì‹œë‚˜ë¦¬ì˜¤<a hidden class="anchor" aria-hidden="true" href="#ì¼ë°˜ì ì¸-ì¥ì• -ì‹œë‚˜ë¦¬ì˜¤">#</a></h3>
<h4 id="íŒŒë“œê°€-ì‹œì‘ë˜ì§€-ì•ŠëŠ”-ê²½ìš°">íŒŒë“œê°€ ì‹œì‘ë˜ì§€ ì•ŠëŠ” ê²½ìš°<a hidden class="anchor" aria-hidden="true" href="#íŒŒë“œê°€-ì‹œì‘ë˜ì§€-ì•ŠëŠ”-ê²½ìš°">#</a></h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># ì›ì¸ í™•ì¸</span>
</span></span><span style="display:flex;"><span>kubectl describe pod &lt;pod-name&gt; -n openwebui
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ì¼ë°˜ì ì¸ í•´ê²°ì±…</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 1. ì´ë¯¸ì§€ ë¬¸ì œ</span>
</span></span><span style="display:flex;"><span>kubectl get pods -n openwebui -o jsonpath<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;{.items[*].spec.containers[*].image}&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 2. ë¦¬ì†ŒìŠ¤ ë¶€ì¡±</span>
</span></span><span style="display:flex;"><span>kubectl describe nodes | grep -A <span style="color:#ae81ff">5</span> <span style="color:#e6db74">&#34;Allocated resources&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 3. PVC ë§ˆìš´íŠ¸ ì‹¤íŒ¨</span>
</span></span><span style="display:flex;"><span>kubectl get pvc -n openwebui
</span></span><span style="display:flex;"><span>kubectl describe pvc &lt;pvc-name&gt; -n openwebui
</span></span></code></pre></div><h4 id="ë°ì´í„°ë² ì´ìŠ¤-ì—°ê²°-ì‹¤íŒ¨">ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì‹¤íŒ¨<a hidden class="anchor" aria-hidden="true" href="#ë°ì´í„°ë² ì´ìŠ¤-ì—°ê²°-ì‹¤íŒ¨">#</a></h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># PostgreSQL ìƒíƒœ í™•ì¸</span>
</span></span><span style="display:flex;"><span>kubectl get pods -l app<span style="color:#f92672">=</span>postgres -n openwebui
</span></span><span style="display:flex;"><span>kubectl logs deployment/postgres -n openwebui
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ì—°ê²° í…ŒìŠ¤íŠ¸</span>
</span></span><span style="display:flex;"><span>kubectl exec deployment/postgres -n openwebui -- pg_isready
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ë„¤íŠ¸ì›Œí¬ ì—°ê²° í™•ì¸</span>
</span></span><span style="display:flex;"><span>kubectl exec deployment/openwebui -n openwebui -- <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  nc -zv postgres-service <span style="color:#ae81ff">5432</span>
</span></span></code></pre></div><h4 id="ë†’ì€-ì‘ë‹µ-ì‹œê°„">ë†’ì€ ì‘ë‹µ ì‹œê°„<a hidden class="anchor" aria-hidden="true" href="#ë†’ì€-ì‘ë‹µ-ì‹œê°„">#</a></h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰ í™•ì¸</span>
</span></span><span style="display:flex;"><span>kubectl top pods -n openwebui
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># HPA ìŠ¤ì¼€ì¼ë§ ê°•ì œ ì‹¤í–‰</span>
</span></span><span style="display:flex;"><span>kubectl patch hpa openwebui-hpa -n openwebui -p <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  <span style="color:#e6db74">&#39;{&#34;spec&#34;:{&#34;minReplicas&#34;:3}}&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ìºì‹œ í´ë¦¬ì–´ (ì• í”Œë¦¬ì¼€ì´ì…˜ë³„ ë°©ë²•)</span>
</span></span><span style="display:flex;"><span>kubectl exec deployment/openwebui -n openwebui -- <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  curl -X POST http://localhost:8080/api/v1/cache/clear
</span></span></code></pre></div><hr>
<h2 id="-ìœ ì§€ë³´ìˆ˜">ğŸ”§ ìœ ì§€ë³´ìˆ˜<a hidden class="anchor" aria-hidden="true" href="#-ìœ ì§€ë³´ìˆ˜">#</a></h2>
<h3 id="ì •ê¸°-ì—…ë°ì´íŠ¸">ì •ê¸° ì—…ë°ì´íŠ¸<a hidden class="anchor" aria-hidden="true" href="#ì •ê¸°-ì—…ë°ì´íŠ¸">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">#!/bin/bash
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#75715e"># update-system.sh</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;ğŸ”„ ì‹œìŠ¤í…œ ì—…ë°ì´íŠ¸ ì‹œì‘...&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 1. EKS í´ëŸ¬ìŠ¤í„° ì—…ë°ì´íŠ¸ í™•ì¸</span>
</span></span><span style="display:flex;"><span>aws eks describe-cluster --name openwebui-eks-dev <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  --query <span style="color:#e6db74">&#39;cluster.version&#39;</span> --output text
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 2. ë…¸ë“œ ê·¸ë£¹ ì—…ë°ì´íŠ¸ í™•ì¸</span>
</span></span><span style="display:flex;"><span>aws eks describe-nodegroup --cluster-name openwebui-eks-dev <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  --nodegroup-name primary-nodes <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  --query <span style="color:#e6db74">&#39;nodegroup.version&#39;</span> --output text
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 3. Add-on ì—…ë°ì´íŠ¸</span>
</span></span><span style="display:flex;"><span>kubectl get pods -n kube-system
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 4. ì• í”Œë¦¬ì¼€ì´ì…˜ ì´ë¯¸ì§€ ì—…ë°ì´íŠ¸</span>
</span></span><span style="display:flex;"><span>kubectl set image deployment/openwebui openwebui<span style="color:#f92672">=</span>ghcr.io/openwebui:latest -n openwebui
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;âœ… ì—…ë°ì´íŠ¸ ì™„ë£Œ&#34;</span>
</span></span></code></pre></div><h3 id="ë³´ì•ˆ-íŒ¨ì¹˜">ë³´ì•ˆ íŒ¨ì¹˜<a hidden class="anchor" aria-hidden="true" href="#ë³´ì•ˆ-íŒ¨ì¹˜">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># ë³´ì•ˆ ìŠ¤ìº” ì‹¤í–‰</span>
</span></span><span style="display:flex;"><span>trivy image ghcr.io/openwebui:latest
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ì·¨ì•½ì  ìˆëŠ” ì»¨í…Œì´ë„ˆ ì¬ë°°í¬</span>
</span></span><span style="display:flex;"><span>kubectl rollout restart deployment/openwebui -n openwebui
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ì‹œí¬ë¦¿ ë¡œí…Œì´ì…˜</span>
</span></span><span style="display:flex;"><span>kubectl create secret generic api-keys <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  --from-literal<span style="color:#f92672">=</span>OPENAI_API_KEY<span style="color:#f92672">=</span>new-key <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  --dry-run<span style="color:#f92672">=</span>client -o yaml | kubectl apply -f -
</span></span></code></pre></div><h3 id="ìš©ëŸ‰-ê´€ë¦¬">ìš©ëŸ‰ ê´€ë¦¬<a hidden class="anchor" aria-hidden="true" href="#ìš©ëŸ‰-ê´€ë¦¬">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># ë””ìŠ¤í¬ ì‚¬ìš©ëŸ‰ ëª¨ë‹ˆí„°ë§</span>
</span></span><span style="display:flex;"><span>kubectl get pvc -A -o custom-columns<span style="color:#f92672">=</span>NAME:.metadata.name,SIZE:.spec.resources.requests.storage,USED:.status.capacity.storage
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ë¡œê·¸ ì •ë¦¬</span>
</span></span><span style="display:flex;"><span>kubectl logs deployment/openwebui -n openwebui --tail<span style="color:#f92672">=</span><span style="color:#ae81ff">1000</span> &gt; /dev/null
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ì´ë¯¸ì§€ ì •ë¦¬ (ë…¸ë“œì—ì„œ ì§ì ‘)</span>
</span></span><span style="display:flex;"><span>docker system prune -a
</span></span></code></pre></div><hr>
<h2 id="-ì„±ëŠ¥-íŠœë‹">ğŸ“ˆ ì„±ëŠ¥ íŠœë‹<a hidden class="anchor" aria-hidden="true" href="#-ì„±ëŠ¥-íŠœë‹">#</a></h2>
<h3 id="ì• í”Œë¦¬ì¼€ì´ì…˜-ìµœì í™”">ì• í”Œë¦¬ì¼€ì´ì…˜ ìµœì í™”<a hidden class="anchor" aria-hidden="true" href="#ì• í”Œë¦¬ì¼€ì´ì…˜-ìµœì í™”">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#75715e"># OpenWebUI ì„±ëŠ¥ ì„¤ì •</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">env</span>:
</span></span><span style="display:flex;"><span>- <span style="color:#f92672">name</span>: <span style="color:#ae81ff">WEBUI_SECRET_KEY</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">value</span>: <span style="color:#e6db74">&#34;optimized-secret-key&#34;</span>
</span></span><span style="display:flex;"><span>- <span style="color:#f92672">name</span>: <span style="color:#ae81ff">MAX_WORKERS</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">value</span>: <span style="color:#e6db74">&#34;4&#34;</span>
</span></span><span style="display:flex;"><span>- <span style="color:#f92672">name</span>: <span style="color:#ae81ff">TIMEOUT</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">value</span>: <span style="color:#e6db74">&#34;60&#34;</span>
</span></span><span style="display:flex;"><span>- <span style="color:#f92672">name</span>: <span style="color:#ae81ff">KEEP_ALIVE</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">value</span>: <span style="color:#e6db74">&#34;2&#34;</span>
</span></span></code></pre></div><h3 id="ë°ì´í„°ë² ì´ìŠ¤-íŠœë‹">ë°ì´í„°ë² ì´ìŠ¤ íŠœë‹<a hidden class="anchor" aria-hidden="true" href="#ë°ì´í„°ë² ì´ìŠ¤-íŠœë‹">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#75715e">-- PostgreSQL ì„±ëŠ¥ íŠœë‹
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">-- ì—°ê²° í’€ ì„¤ì •
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">ALTER</span> <span style="color:#66d9ef">SYSTEM</span> <span style="color:#66d9ef">SET</span> max_connections <span style="color:#f92672">=</span> <span style="color:#ae81ff">100</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">ALTER</span> <span style="color:#66d9ef">SYSTEM</span> <span style="color:#66d9ef">SET</span> shared_buffers <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;256MB&#39;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">ALTER</span> <span style="color:#66d9ef">SYSTEM</span> <span style="color:#66d9ef">SET</span> effective_cache_size <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;1GB&#39;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">ALTER</span> <span style="color:#66d9ef">SYSTEM</span> <span style="color:#66d9ef">SET</span> work_mem <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;4MB&#39;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">-- ì¸ë±ìŠ¤ í™•ì¸ ë° ìµœì í™”
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">SELECT</span> schemaname, tablename, attname, n_distinct, correlation 
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> pg_stats <span style="color:#66d9ef">WHERE</span> tablename <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;your_table&#39;</span>;
</span></span></code></pre></div><h3 id="ë„¤íŠ¸ì›Œí¬-ìµœì í™”">ë„¤íŠ¸ì›Œí¬ ìµœì í™”<a hidden class="anchor" aria-hidden="true" href="#ë„¤íŠ¸ì›Œí¬-ìµœì í™”">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#75715e"># Ingress ì„¤ì • ìµœì í™”</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">annotations</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">nginx.ingress.kubernetes.io/proxy-connect-timeout</span>: <span style="color:#e6db74">&#34;60&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">nginx.ingress.kubernetes.io/proxy-send-timeout</span>: <span style="color:#e6db74">&#34;60&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">nginx.ingress.kubernetes.io/proxy-read-timeout</span>: <span style="color:#e6db74">&#34;60&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">nginx.ingress.kubernetes.io/proxy-body-size</span>: <span style="color:#e6db74">&#34;50m&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">nginx.ingress.kubernetes.io/enable-cors</span>: <span style="color:#e6db74">&#34;true&#34;</span>
</span></span></code></pre></div><hr>
<h2 id="-ë¹„ìš©-ìµœì í™”">ğŸ’° ë¹„ìš© ìµœì í™”<a hidden class="anchor" aria-hidden="true" href="#-ë¹„ìš©-ìµœì í™”">#</a></h2>
<h3 id="ë¦¬ì†ŒìŠ¤-ì‚¬ìš©ëŸ‰-ë¶„ì„">ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰ ë¶„ì„<a hidden class="anchor" aria-hidden="true" href="#ë¦¬ì†ŒìŠ¤-ì‚¬ìš©ëŸ‰-ë¶„ì„">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># ë…¸ë“œ ë¹„ìš© ë¶„ì„</span>
</span></span><span style="display:flex;"><span>kubectl describe nodes | grep -A <span style="color:#ae81ff">3</span> <span style="color:#e6db74">&#34;Allocated resources&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Spot ì¸ìŠ¤í„´ìŠ¤ í™œìš©ë¥ </span>
</span></span><span style="display:flex;"><span>kubectl get nodes -l node.kubernetes.io/instance-type
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ë¦¬ì†ŒìŠ¤ ì •ë¦¬</span>
</span></span><span style="display:flex;"><span>kubectl get pods -A --field-selector<span style="color:#f92672">=</span>status.phase<span style="color:#f92672">=</span>Succeeded
</span></span><span style="display:flex;"><span>kubectl delete pods --field-selector<span style="color:#f92672">=</span>status.phase<span style="color:#f92672">=</span>Succeeded -A
</span></span></code></pre></div><h3 id="ìë™-ìŠ¤ì¼€ì¼ë§-ìµœì í™”">ìë™ ìŠ¤ì¼€ì¼ë§ ìµœì í™”<a hidden class="anchor" aria-hidden="true" href="#ìë™-ìŠ¤ì¼€ì¼ë§-ìµœì í™”">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#75715e"># ë¹„ìš© íš¨ìœ¨ì ì¸ HPA ì„¤ì •</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">spec</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">minReplicas</span>: <span style="color:#ae81ff">1</span>        <span style="color:#75715e"># ìµœì†Œ ë¹„ìš©</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">maxReplicas</span>: <span style="color:#ae81ff">10</span>       <span style="color:#75715e"># íŠ¸ë˜í”½ ëŒ€ì‘</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">targetCPUUtilizationPercentage</span>: <span style="color:#ae81ff">70</span>  <span style="color:#75715e"># ì ì ˆí•œ í™œìš©ë¥ </span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">behavior</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">scaleDown</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">stabilizationWindowSeconds</span>: <span style="color:#ae81ff">300</span>  <span style="color:#75715e"># ê¸‰ê²©í•œ ìŠ¤ì¼€ì¼ ë‹¤ìš´ ë°©ì§€</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">policies</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">type</span>: <span style="color:#ae81ff">Percent</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">value</span>: <span style="color:#ae81ff">50</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">periodSeconds</span>: <span style="color:#ae81ff">60</span>
</span></span></code></pre></div><hr>
<h2 id="-ë¹„ìƒ-ì—°ë½-ì²´ê³„">ğŸ“ ë¹„ìƒ ì—°ë½ ì²´ê³„<a hidden class="anchor" aria-hidden="true" href="#-ë¹„ìƒ-ì—°ë½-ì²´ê³„">#</a></h2>
<h3 id="ì¥ì• -ë“±ê¸‰ë³„-ëŒ€ì‘">ì¥ì•  ë“±ê¸‰ë³„ ëŒ€ì‘<a hidden class="anchor" aria-hidden="true" href="#ì¥ì• -ë“±ê¸‰ë³„-ëŒ€ì‘">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">P0 (Critical)</span>: 
</span></span><span style="display:flex;"><span>  - <span style="color:#ae81ff">ì„œë¹„ìŠ¤ ì™„ì „ ì¤‘ë‹¨</span>
</span></span><span style="display:flex;"><span>  - <span style="color:#ae81ff">ì¦‰ì‹œ ëŒ€ì‘ (24/7)</span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">ì—°ë½ì²˜</span>: [<span style="color:#ae81ff">ê¸´ê¸‰ ì—°ë½ì²˜]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">P1 (High)</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#ae81ff">ì£¼ìš” ê¸°ëŠ¥ ì¥ì• </span>
</span></span><span style="display:flex;"><span>  - <span style="color:#ae81ff">4ì‹œê°„ ì´ë‚´ ëŒ€ì‘</span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">ì—°ë½ì²˜</span>: [<span style="color:#ae81ff">íŒ€ ë¦¬ë”]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">P2 (Medium)</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#ae81ff">ë¶€ë¶„ ê¸°ëŠ¥ ì¥ì•   </span>
</span></span><span style="display:flex;"><span>  - <span style="color:#ae81ff">24ì‹œê°„ ì´ë‚´ ëŒ€ì‘</span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">ì—°ë½ì²˜</span>: [<span style="color:#ae81ff">ë‹´ë‹¹ì]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">P3 (Low)</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#ae81ff">ì„±ëŠ¥ ì €í•˜</span>
</span></span><span style="display:flex;"><span>  - <span style="color:#ae81ff">72ì‹œê°„ ì´ë‚´ ëŒ€ì‘</span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">ì—°ë½ì²˜</span>: [<span style="color:#ae81ff">íŒ€ ë©”ì¼]</span>
</span></span></code></pre></div><h3 id="ì—ìŠ¤ì»¬ë ˆì´ì…˜-ì ˆì°¨">ì—ìŠ¤ì»¬ë ˆì´ì…˜ ì ˆì°¨<a hidden class="anchor" aria-hidden="true" href="#ì—ìŠ¤ì»¬ë ˆì´ì…˜-ì ˆì°¨">#</a></h3>
<ol>
<li>1ì°¨ ë‹´ë‹¹ì (30ë¶„ ì´ë‚´ ì‘ë‹µ)</li>
<li>íŒ€ ë¦¬ë” (1ì‹œê°„ ì´ë‚´)</li>
<li>ê¸°ìˆ  ì±…ì„ì (2ì‹œê°„ ì´ë‚´)</li>
<li>CTO (4ì‹œê°„ ì´ë‚´)</li>
</ol>
<hr>
<h2 id="-ìš´ì˜-ë„êµ¬-ë°-ëŒ€ì‹œë³´ë“œ">ğŸ“š ìš´ì˜ ë„êµ¬ ë° ëŒ€ì‹œë³´ë“œ<a hidden class="anchor" aria-hidden="true" href="#-ìš´ì˜-ë„êµ¬-ë°-ëŒ€ì‹œë³´ë“œ">#</a></h2>
<h3 id="í•„ìˆ˜-ë„êµ¬">í•„ìˆ˜ ë„êµ¬<a hidden class="anchor" aria-hidden="true" href="#í•„ìˆ˜-ë„êµ¬">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># kubectl í”ŒëŸ¬ê·¸ì¸ ì„¤ì¹˜</span>
</span></span><span style="display:flex;"><span>kubectl krew install ctx ns stern top
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ìœ ìš©í•œ ëª…ë ¹ì–´ ë³„ì¹­</span>
</span></span><span style="display:flex;"><span>alias k<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;kubectl&#39;</span>
</span></span><span style="display:flex;"><span>alias kgp<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;kubectl get pods&#39;</span>
</span></span><span style="display:flex;"><span>alias kgs<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;kubectl get svc&#39;</span> 
</span></span><span style="display:flex;"><span>alias kgn<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;kubectl get nodes&#39;</span>
</span></span><span style="display:flex;"><span>alias kdp<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;kubectl describe pod&#39;</span>
</span></span><span style="display:flex;"><span>alias kl<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;kubectl logs&#39;</span>
</span></span></code></pre></div><h3 id="ëª¨ë‹ˆí„°ë§-ëŒ€ì‹œë³´ë“œ">ëª¨ë‹ˆí„°ë§ ëŒ€ì‹œë³´ë“œ<a hidden class="anchor" aria-hidden="true" href="#ëª¨ë‹ˆí„°ë§-ëŒ€ì‹œë³´ë“œ">#</a></h3>
<ul>
<li><strong>Grafana</strong>: <code>http://grafana.your-domain.com</code></li>
<li><strong>Prometheus</strong>: <code>http://prometheus.your-domain.com</code></li>
<li><strong>Jaeger</strong>: <code>http://jaeger.your-domain.com</code> (íŠ¸ë ˆì´ì‹±)</li>
<li><strong>ArgoCD</strong>: <code>http://argocd.your-domain.com</code> (GitOps)</li>
</ul>
<h3 id="ë¡œê·¸-ë¶„ì„">ë¡œê·¸ ë¶„ì„<a hidden class="anchor" aria-hidden="true" href="#ë¡œê·¸-ë¶„ì„">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># ì¤‘ì•™í™”ëœ ë¡œê¹… (ELK Stack)</span>
</span></span><span style="display:flex;"><span>kubectl port-forward svc/kibana 5601:5601 -n logging
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ë¡œê·¸ ì¿¼ë¦¬ ì˜ˆì‹œ</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Kibanaì—ì„œ: kubernetes.namespace:&#34;openwebui&#34; AND level:&#34;ERROR&#34;</span>
</span></span></code></pre></div><hr>
<h2 id="-ì •ê¸°-ì‘ì—…-ìŠ¤ì¼€ì¤„">ğŸ”„ ì •ê¸° ì‘ì—… ìŠ¤ì¼€ì¤„<a hidden class="anchor" aria-hidden="true" href="#-ì •ê¸°-ì‘ì—…-ìŠ¤ì¼€ì¤„">#</a></h2>
<h3 id="ì¼ì¼-ì‘ì—…-ìë™í™”">ì¼ì¼ ì‘ì—… (ìë™í™”)<a hidden class="anchor" aria-hidden="true" href="#ì¼ì¼-ì‘ì—…-ìë™í™”">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#75715e"># CronJob ì˜ˆì‹œ</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">batch/v1</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">CronJob</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">metadata</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">daily-cleanup</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">spec</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">schedule</span>: <span style="color:#e6db74">&#34;0 2 * * *&#34;</span>  <span style="color:#75715e"># ë§¤ì¼ ì˜¤ì „ 2ì‹œ</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">jobTemplate</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">spec</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">template</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">spec</span>:
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">containers</span>:
</span></span><span style="display:flex;"><span>          - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">cleanup</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">image</span>: <span style="color:#ae81ff">alpine:latest</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">command</span>:
</span></span><span style="display:flex;"><span>            - <span style="color:#ae81ff">/bin/sh</span>
</span></span><span style="display:flex;"><span>            - -<span style="color:#ae81ff">c</span>
</span></span><span style="display:flex;"><span>            - |<span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">              # ë¡œê·¸ ì •ë¦¬
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">              find /var/log -name &#34;*.log&#34; -mtime +7 -delete
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">              # ì„ì‹œ íŒŒì¼ ì •ë¦¬
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">              find /tmp -mtime +1 -delete</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">restartPolicy</span>: <span style="color:#ae81ff">OnFailure</span>
</span></span></code></pre></div><h3 id="ì£¼ê°„-ì‘ì—…">ì£¼ê°„ ì‘ì—…<a hidden class="anchor" aria-hidden="true" href="#ì£¼ê°„-ì‘ì—…">#</a></h3>
<ul>
<li>ë°±ì—… ê²€ì¦ í…ŒìŠ¤íŠ¸</li>
<li>ë³´ì•ˆ ìŠ¤ìº” ì‹¤í–‰</li>
<li>ì„±ëŠ¥ ë¦¬í¬íŠ¸ ì‘ì„±</li>
<li>ë¹„ìš© ë¶„ì„ ë¦¬í¬íŠ¸</li>
</ul>
<h3 id="ì›”ê°„-ì‘ì—…">ì›”ê°„ ì‘ì—…<a hidden class="anchor" aria-hidden="true" href="#ì›”ê°„-ì‘ì—…">#</a></h3>
<ul>
<li>DR(ì¬í•´ë³µêµ¬) í…ŒìŠ¤íŠ¸</li>
<li>ë³´ì•ˆ ê°ì‚¬</li>
<li>ìš©ëŸ‰ ê³„íš ê²€í† </li>
<li>ì•„í‚¤í…ì²˜ ë¦¬ë·°</li>
</ul>
<p>ì´ì œ ì™„ì „í•œ ìš´ì˜ ë§¤ë‰´ì–¼ì´ ì¤€ë¹„ë˜ì—ˆìŠµë‹ˆë‹¤! ğŸ› ï¸</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
<nav class="paginav">
  <a class="prev" href="https://8dobibim.github.io/backend/%EC%95%A0%ED%94%8C%EB%A6%AC%EC%BC%80%EC%9D%B4%EC%85%98-%EB%B0%B0%ED%8F%AC-%EA%B0%80%EC%9D%B4%EB%93%9C/">
    <span class="title">Â« Prev</span>
    <br>
    <span></span>
  </a>
  <a class="next" href="https://8dobibim.github.io/backend/%ED%8A%B8%EB%9F%AC%EB%B8%94%EC%8A%88%ED%8C%85-%EA%B0%80%EC%9D%B4%EB%93%9C--faq/">
    <span class="title">Next Â»</span>
    <br>
    <span></span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="https://8dobibim.github.io/">8dobibim Tech Blog</a></span> Â· 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
