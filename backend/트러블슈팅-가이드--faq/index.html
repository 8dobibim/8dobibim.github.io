<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>8dobibim Tech Blog</title>
<meta name="keywords" content="">
<meta name="description" content="🚨 트러블슈팅 가이드 &amp; FAQ

🔍 빠른 문제 진단
1단계: 기본 상태 확인 (30초)
# 한 번에 전체 상태 확인
kubectl get nodes,pods -A | grep -E &#34;(NotReady|Error|CrashLoop|Pending)&#34;

# 최근 이벤트 확인
kubectl get events -A --sort-by=&#39;.lastTimestamp&#39; | tail -10
2단계: 애플리케이션별 상태 (1분)
# OpenWebUI 상태
kubectl get pods -n openwebui -o wide

# LiteLLM 상태  
kubectl get pods -n litellm -o wide

# 데이터베이스 상태
kubectl get pods -n openwebui -l app=postgres
3단계: 리소스 사용량 (30초)
# 노드 리소스
kubectl top nodes

# 파드 리소스
kubectl top pods -A --sort-by=cpu

🔧 인프라 관련 문제
❌ 노드가 NotReady 상태
증상:">
<meta name="author" content="">
<link rel="canonical" href="https://8dobibim.github.io/backend/%ED%8A%B8%EB%9F%AC%EB%B8%94%EC%8A%88%ED%8C%85-%EA%B0%80%EC%9D%B4%EB%93%9C--faq/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.css" rel="preload stylesheet" as="style">
<link rel="icon" href="https://8dobibim.github.io/%3Clink%20/%20abs%20url%3E">
<link rel="icon" type="image/png" sizes="16x16" href="https://8dobibim.github.io/%3Clink%20/%20abs%20url%3E">
<link rel="icon" type="image/png" sizes="32x32" href="https://8dobibim.github.io/%3Clink%20/%20abs%20url%3E">
<link rel="apple-touch-icon" href="https://8dobibim.github.io/%3Clink%20/%20abs%20url%3E">
<link rel="mask-icon" href="https://8dobibim.github.io/%3Clink%20/%20abs%20url%3E">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://8dobibim.github.io/backend/%ED%8A%B8%EB%9F%AC%EB%B8%94%EC%8A%88%ED%8C%85-%EA%B0%80%EC%9D%B4%EB%93%9C--faq/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:url" content="https://8dobibim.github.io/backend/%ED%8A%B8%EB%9F%AC%EB%B8%94%EC%8A%88%ED%8C%85-%EA%B0%80%EC%9D%B4%EB%93%9C--faq/">
  <meta property="og:site_name" content="8dobibim Tech Blog">
  <meta property="og:title" content="8dobibim Tech Blog">
  <meta property="og:description" content="🚨 트러블슈팅 가이드 &amp; FAQ 🔍 빠른 문제 진단 1단계: 기본 상태 확인 (30초) # 한 번에 전체 상태 확인 kubectl get nodes,pods -A | grep -E &#34;(NotReady|Error|CrashLoop|Pending)&#34; # 최근 이벤트 확인 kubectl get events -A --sort-by=&#39;.lastTimestamp&#39; | tail -10 2단계: 애플리케이션별 상태 (1분) # OpenWebUI 상태 kubectl get pods -n openwebui -o wide # LiteLLM 상태 kubectl get pods -n litellm -o wide # 데이터베이스 상태 kubectl get pods -n openwebui -l app=postgres 3단계: 리소스 사용량 (30초) # 노드 리소스 kubectl top nodes # 파드 리소스 kubectl top pods -A --sort-by=cpu 🔧 인프라 관련 문제 ❌ 노드가 NotReady 상태 증상:">
  <meta property="og:locale" content="ko">
  <meta property="og:type" content="article">
    <meta property="article:section" content="backend">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="">
<meta name="twitter:description" content="🚨 트러블슈팅 가이드 &amp; FAQ

🔍 빠른 문제 진단
1단계: 기본 상태 확인 (30초)
# 한 번에 전체 상태 확인
kubectl get nodes,pods -A | grep -E &#34;(NotReady|Error|CrashLoop|Pending)&#34;

# 최근 이벤트 확인
kubectl get events -A --sort-by=&#39;.lastTimestamp&#39; | tail -10
2단계: 애플리케이션별 상태 (1분)
# OpenWebUI 상태
kubectl get pods -n openwebui -o wide

# LiteLLM 상태  
kubectl get pods -n litellm -o wide

# 데이터베이스 상태
kubectl get pods -n openwebui -l app=postgres
3단계: 리소스 사용량 (30초)
# 노드 리소스
kubectl top nodes

# 파드 리소스
kubectl top pods -A --sort-by=cpu

🔧 인프라 관련 문제
❌ 노드가 NotReady 상태
증상:">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Backend 문서",
      "item": "https://8dobibim.github.io/backend/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "",
      "item": "https://8dobibim.github.io/backend/%ED%8A%B8%EB%9F%AC%EB%B8%94%EC%8A%88%ED%8C%85-%EA%B0%80%EC%9D%B4%EB%93%9C--faq/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "",
  "name": "",
  "description": "🚨 트러블슈팅 가이드 \u0026amp; FAQ 🔍 빠른 문제 진단 1단계: 기본 상태 확인 (30초) # 한 번에 전체 상태 확인 kubectl get nodes,pods -A | grep -E \u0026#34;(NotReady|Error|CrashLoop|Pending)\u0026#34; # 최근 이벤트 확인 kubectl get events -A --sort-by=\u0026#39;.lastTimestamp\u0026#39; | tail -10 2단계: 애플리케이션별 상태 (1분) # OpenWebUI 상태 kubectl get pods -n openwebui -o wide # LiteLLM 상태 kubectl get pods -n litellm -o wide # 데이터베이스 상태 kubectl get pods -n openwebui -l app=postgres 3단계: 리소스 사용량 (30초) # 노드 리소스 kubectl top nodes # 파드 리소스 kubectl top pods -A --sort-by=cpu 🔧 인프라 관련 문제 ❌ 노드가 NotReady 상태 증상:\n",
  "keywords": [
    
  ],
  "articleBody": "🚨 트러블슈팅 가이드 \u0026 FAQ 🔍 빠른 문제 진단 1단계: 기본 상태 확인 (30초) # 한 번에 전체 상태 확인 kubectl get nodes,pods -A | grep -E \"(NotReady|Error|CrashLoop|Pending)\" # 최근 이벤트 확인 kubectl get events -A --sort-by='.lastTimestamp' | tail -10 2단계: 애플리케이션별 상태 (1분) # OpenWebUI 상태 kubectl get pods -n openwebui -o wide # LiteLLM 상태 kubectl get pods -n litellm -o wide # 데이터베이스 상태 kubectl get pods -n openwebui -l app=postgres 3단계: 리소스 사용량 (30초) # 노드 리소스 kubectl top nodes # 파드 리소스 kubectl top pods -A --sort-by=cpu 🔧 인프라 관련 문제 ❌ 노드가 NotReady 상태 증상:\nNAME STATUS ROLES AGE VERSION\rnode-1 NotReady 1d v1.28.0 원인 분석:\n# 노드 상세 정보 확인 kubectl describe node node-1 # 노드 로그 확인 (SSH 접속 필요) sudo journalctl -u kubelet -f 해결 방법:\n# 1. kubelet 재시작 sudo systemctl restart kubelet # 2. 노드 재부팅 (심각한 경우) sudo reboot # 3. 노드 교체 (복구 불가능한 경우) kubectl drain node-1 --ignore-daemonsets --delete-emptydir-data kubectl delete node node-1 # AWS 콘솔에서 인스턴스 종료 (Auto Scaling이 새 노드 생성) ❌ 파드가 Pending 상태 증상:\nNAME READY STATUS RESTARTS AGE\ropenwebui-5f7b8d6c9d-xyz 0/1 Pending 0 5m 원인 분석:\nkubectl describe pod openwebui-5f7b8d6c9d-xyz -n openwebui 일반적인 원인과 해결:\n리소스 부족 # 원인: Insufficient cpu/memory # 해결: 리소스 요청량 조정 또는 노드 추가 kubectl patch deployment openwebui -n openwebui -p \\ '{\"spec\":{\"template\":{\"spec\":{\"containers\":[{\"name\":\"openwebui\",\"resources\":{\"requests\":{\"cpu\":\"100m\",\"memory\":\"256Mi\"}}}]}}}}' PVC 마운트 실패 # 원인: PVC not found or pending # PVC 상태 확인 kubectl get pvc -n openwebui # StorageClass 확인 kubectl get storageclass # 해결: PVC 재생성 kubectl delete pvc openwebui-pvc -n openwebui kubectl apply -f kubernetes/base/openwebui/pvc.yaml 노드 셀렉터 문제 # 원인: No nodes match nodeSelector # 노드 레이블 확인 kubectl get nodes --show-labels # 해결: nodeSelector 제거 또는 레이블 추가 kubectl label nodes node-1 environment=dev ❌ 이미지 Pull 실패 증상:\nFailed to pull image \"ghcr.io/openwebui:latest\": rpc error: code = Unknown desc = failed to pull and unpack image 해결 방법:\n# 1. 이미지 태그 확인 docker pull ghcr.io/openwebui:latest # 2. 레지스트리 접근 권한 확인 kubectl get secret -n openwebui | grep docker # 3. 이미지 태그 수정 kubectl set image deployment/openwebui openwebui=ghcr.io/openwebui:v1.0.0 -n openwebui # 4. 대체 이미지 사용 kubectl set image deployment/openwebui openwebui=nginx:latest -n openwebui 🌐 네트워킹 문제 ❌ 서비스 연결 실패 증상:\ncurl: (7) Failed to connect to service-name port 80: Connection refused 진단 순서:\n# 1. 서비스 확인 kubectl get svc -n openwebui # 2. 엔드포인트 확인 kubectl get endpoints -n openwebui # 3. 파드 라벨 확인 kubectl get pods -n openwebui --show-labels # 4. 서비스 셀렉터 확인 kubectl get svc openwebui-service -n openwebui -o yaml | grep -A 5 selector 해결 방법:\n# 서비스와 파드 라벨 매칭 확인 kubectl patch svc openwebui-service -n openwebui -p \\ '{\"spec\":{\"selector\":{\"app\":\"openwebui\"}}}' # 파드 재시작 kubectl rollout restart deployment/openwebui -n openwebui ❌ Ingress 접근 불가 증상:\ncurl: (52) Empty reply from server 진단:\n# Ingress 상태 확인 kubectl get ingress -n openwebui -o wide # Ingress Controller 상태 kubectl get pods -n kube-system -l app.kubernetes.io/name=aws-load-balancer-controller # ALB 상태 확인 (AWS) aws elbv2 describe-load-balancers 해결 방법:\n# 1. Ingress 재생성 kubectl delete ingress openwebui-ingress -n openwebui kubectl apply -f kubernetes/base/ingress/ingress.yaml # 2. 서비스 타입을 LoadBalancer로 임시 변경 kubectl patch svc openwebui-service -n openwebui -p \\ '{\"spec\":{\"type\":\"LoadBalancer\"}}' # 3. 포트 포워딩으로 임시 접근 kubectl port-forward svc/openwebui-service 8080:8080 -n openwebui ❌ DNS 해석 실패 증상:\nnslookup: can't resolve 'service-name.namespace.svc.cluster.local' 진단 및 해결:\n# CoreDNS 상태 확인 kubectl get pods -n kube-system -l k8s-app=kube-dns # DNS 설정 확인 kubectl get configmap coredns -n kube-system -o yaml # DNS 테스트 kubectl run debug --image=busybox -it --rm -- nslookup kubernetes.default.svc.cluster.local # CoreDNS 재시작 kubectl rollout restart deployment/coredns -n kube-system 🗃️ 데이터베이스 문제 ❌ PostgreSQL 연결 실패 증상:\npsql: FATAL: password authentication failed for user \"openwebui\" 진단:\n# 파드 상태 확인 kubectl get pods -l app=postgres -n openwebui # 로그 확인 kubectl logs deployment/postgres -n openwebui # 시크릿 확인 kubectl get secret app-secrets -n openwebui -o yaml 해결 방법:\n# 1. 시크릿 재생성 kubectl delete secret app-secrets -n openwebui kubectl create secret generic app-secrets \\ --from-literal=POSTGRES_USER=openwebui \\ --from-literal=POSTGRES_PASSWORD=newpassword \\ -n openwebui # 2. 데이터베이스 재시작 kubectl rollout restart deployment/postgres -n openwebui # 3. 직접 연결 테스트 kubectl exec -it deployment/postgres -n openwebui -- \\ psql -U openwebui -d openwebui -c \"SELECT 1;\" ❌ 데이터베이스 디스크 부족 증상:\nERROR: could not extend file \"base/16384/16439\": No space left on device 해결 방법:\n# 1. PVC 크기 확장 kubectl patch pvc postgres-pvc -n openwebui -p \\ '{\"spec\":{\"resources\":{\"requests\":{\"storage\":\"20Gi\"}}}}' # 2. 불필요한 데이터 정리 kubectl exec deployment/postgres -n openwebui -- \\ psql -U openwebui -d openwebui -c \"VACUUM FULL;\" # 3. 백업 후 데이터베이스 재생성 # 백업 실행 kubectl exec deployment/postgres -n openwebui -- \\ pg_dump -U openwebui openwebui \u003e backup.sql # PVC 삭제 및 재생성 kubectl delete pvc postgres-pvc -n openwebui kubectl apply -f kubernetes/base/postgres/pvc.yaml # 복원 kubectl exec -i deployment/postgres -n openwebui -- \\ psql -U openwebui openwebui \u003c backup.sql 🤖 애플리케이션 문제 ❌ OpenWebUI 500 에러 증상:\nHTTP 500 Internal Server Error 진단:\n# 애플리케이션 로그 확인 kubectl logs deployment/openwebui -n openwebui --tail=100 # 환경 변수 확인 kubectl exec deployment/openwebui -n openwebui -- env | grep -E \"(DATABASE|SECRET)\" # 헬스체크 확인 kubectl exec deployment/openwebui -n openwebui -- \\ curl -f http://localhost:8080/health 해결 방법:\n# 1. 애플리케이션 재시작 kubectl rollout restart deployment/openwebui -n openwebui # 2. 환경 변수 확인 및 수정 kubectl patch deployment openwebui -n openwebui -p \\ '{\"spec\":{\"template\":{\"spec\":{\"containers\":[{\"name\":\"openwebui\",\"env\":[{\"name\":\"DEBUG\",\"value\":\"true\"}]}]}}}}' # 3. 이전 버전으로 롤백 kubectl rollout undo deployment/openwebui -n openwebui # 4. 데이터베이스 연결 확인 kubectl exec deployment/openwebui -n openwebui -- \\ nc -zv postgres-service 5432 ❌ LiteLLM API 응답 없음 증상:\ncurl: (7) Failed to connect to litellm-service port 4000 진단 및 해결:\n# 파드 상태 확인 kubectl get pods -l app=litellm -n litellm # API 키 확인 kubectl get secret api-keys -n litellm -o yaml # 설정 파일 확인 kubectl get configmap litellm-config -n litellm -o yaml # 직접 API 테스트 kubectl exec deployment/litellm -n litellm -- \\ curl -s http://localhost:4000/health # 재시작 kubectl rollout restart deployment/litellm -n litellm ❌ 메모리 부족 (OOMKilled) 증상:\nLast State: Terminated\rReason: OOMKilled 해결 방법:\n# 1. 메모리 리미트 증가 kubectl patch deployment openwebui -n openwebui -p \\ '{\"spec\":{\"template\":{\"spec\":{\"containers\":[{\"name\":\"openwebui\",\"resources\":{\"limits\":{\"memory\":\"2Gi\"}}}]}}}}' # 2. 메모리 사용량 확인 kubectl top pods -n openwebui --containers # 3. 메모리 요청량 조정 kubectl patch deployment openwebui -n openwebui -p \\ '{\"spec\":{\"template\":{\"spec\":{\"containers\":[{\"name\":\"openwebui\",\"resources\":{\"requests\":{\"memory\":\"512Mi\"}}}]}}}}' 📊 성능 문제 ❌ 느린 응답 시간 진단:\n# 응답 시간 측정 kubectl exec deployment/openwebui -n openwebui -- \\ curl -w \"Total time: %{time_total}s\\n\" -o /dev/null -s http://localhost:8080 # 리소스 사용량 확인 kubectl top pods -n openwebui --containers # 데이터베이스 쿼리 성능 확인 kubectl exec deployment/postgres -n openwebui -- \\ psql -U openwebui -d openwebui -c \\ \"SELECT query, mean_exec_time FROM pg_stat_statements ORDER BY mean_exec_time DESC LIMIT 5;\" 해결 방법:\n# 1. HPA 스케일링 확인 kubectl get hpa -n openwebui # 2. 수동 스케일링 kubectl scale deployment openwebui --replicas=4 -n openwebui # 3. 리소스 증량 kubectl patch deployment openwebui -n openwebui -p \\ '{\"spec\":{\"template\":{\"spec\":{\"containers\":[{\"name\":\"openwebui\",\"resources\":{\"requests\":{\"cpu\":\"500m\",\"memory\":\"1Gi\"}}}]}}}}' ❌ 높은 CPU 사용률 해결 방법:\n# CPU 사용률 확인 kubectl top pods -n openwebui --sort-by=cpu # 프로파일링 (가능한 경우) kubectl exec deployment/openwebui -n openwebui -- \\ curl -s http://localhost:8080/debug/pprof/profile \u003e cpu.prof # 수평 스케일링 kubectl patch hpa openwebui-hpa -n openwebui -p \\ '{\"spec\":{\"targetCPUUtilizationPercentage\":50}}' 🔒 보안 문제 ❌ 이미지 취약점 진단:\n# 이미지 스캔 trivy image ghcr.io/openwebui:latest # 실행 중인 이미지 확인 kubectl get pods -n openwebui -o jsonpath='{.items[*].spec.containers[*].image}' 해결 방법:\n# 1. 최신 이미지 업데이트 kubectl set image deployment/openwebui openwebui=ghcr.io/openwebui:v1.0.1 -n openwebui # 2. 보안 패치된 베이스 이미지 사용 # Dockerfile 수정 후 재빌드 필요 ❌ 시크릿 노출 진단:\n# 시크릿 확인 kubectl get secrets -A # 파드에서 시크릿 사용 확인 kubectl get pods -n openwebui -o yaml | grep -A 10 secretRef 해결 방법:\n# 1. 시크릿 로테이션 kubectl delete secret api-keys -n litellm kubectl create secret generic api-keys \\ --from-literal=OPENAI_API_KEY=new-secure-key \\ -n litellm # 2. 애플리케이션 재시작 kubectl rollout restart deployment/litellm -n litellm 📋 FAQ (자주 묻는 질문) Q1: 파드가 계속 재시작되는 이유는? A: 가장 일반적인 원인들:\n# 1. 헬스체크 실패 kubectl describe pod -n openwebui | grep -A 10 Events # 2. 메모리 부족 (OOMKilled) kubectl describe pod -n openwebui | grep OOMKilled # 3. 애플리케이션 에러 kubectl logs -n openwebui --previous # 해결: 리소스 증량 또는 헬스체크 조정 Q2: 배포 후 외부에서 접근이 안 돼요 A: 단계별 확인:\n# 1. 파드 상태 kubectl get pods -n openwebui # 2. 서비스 상태 kubectl get svc -n openwebui # 3. Ingress 상태 kubectl get ingress -n openwebui # 4. 로드밸런서 상태 (AWS 콘솔 확인) aws elbv2 describe-load-balancers # 임시 해결: 포트 포워딩 kubectl port-forward svc/openwebui-service 8080:8080 -n openwebui Q3: 데이터가 사라졌어요 A: 데이터 복구 방법:\n# 1. PVC 상태 확인 kubectl get pvc -n openwebui # 2. 백업에서 복원 aws s3 ls s3://openwebui-backups/database/ # 3. 최신 백업으로 복원 ./restore-database.sh openwebui_backup_20240301_120000.sql Q4: API 키가 작동하지 않아요 A: API 키 확인 및 업데이트:\n# 1. 현재 시크릿 확인 kubectl get secret api-keys -n litellm -o yaml # 2. 디코딩해서 확인 kubectl get secret api-keys -n litellm -o jsonpath='{.data.OPENAI_API_KEY}' | base64 -d # 3. 새 키로 업데이트 kubectl create secret generic api-keys \\ --from-literal=OPENAI_API_KEY=sk-new-key \\ --dry-run=client -o yaml | kubectl apply -f - # 4. 파드 재시작 kubectl rollout restart deployment/litellm -n litellm Q5: 비용이 예상보다 많이 나와요 A: 비용 최적화 방법:\n# 1. 리소스 사용량 확인 kubectl top nodes kubectl top pods -A # 2. Spot 인스턴스 활용 kubectl get nodes -l node.kubernetes.io/instance-type # 3. 사용하지 않는 리소스 정리 kubectl get pods -A --field-selector=status.phase=Succeeded kubectl delete pods --field-selector=status.phase=Succeeded -A # 4. HPA 최적화 kubectl patch hpa openwebui-hpa -n openwebui -p \\ '{\"spec\":{\"minReplicas\":1,\"targetCPUUtilizationPercentage\":70}}' Q6: 로그를 어디서 확인하나요? A: 로그 확인 방법:\n# 1. 실시간 로그 kubectl logs -f deployment/openwebui -n openwebui # 2. 특정 시간대 로그 kubectl logs --since=1h deployment/openwebui -n openwebui # 3. 이전 컨테이너 로그 (재시작된 경우) kubectl logs deployment/openwebui -n openwebui --previous # 4. 모든 파드 로그 kubectl logs -l app=openwebui -n openwebui # 5. 중앙화된 로깅 (Kibana) # http://kibana.your-domain.com에서 확인 Q7: 성능이 느려졌어요 A: 성능 진단 단계:\n# 1. 리소스 사용량 확인 kubectl top pods -n openwebui --containers # 2. 응답 시간 측정 kubectl exec deployment/openwebui -n openwebui -- \\ curl -w \"%{time_total}\" -o /dev/null -s http://localhost:8080 # 3. 데이터베이스 성능 확인 kubectl exec deployment/postgres -n openwebui -- \\ psql -U openwebui -d openwebui -c \\ \"SELECT * FROM pg_stat_activity WHERE state = 'active';\" # 4. 스케일링 실행 kubectl scale deployment openwebui --replicas=3 -n openwebui Q8: 업데이트는 어떻게 하나요? A: 안전한 업데이트 방법:\n# 1. 백업 먼저 실행 ./backup-database.sh # 2. 새 버전으로 업데이트 kubectl set image deployment/openwebui openwebui=ghcr.io/openwebui:v1.1.0 -n openwebui # 3. 롤아웃 상태 확인 kubectl rollout status deployment/openwebui -n openwebui # 4. 문제 발생 시 롤백 kubectl rollout undo deployment/openwebui -n openwebui 🆘 긴급 상황별 대응 🔥 전체 서비스 다운 # 1. 즉시 상태 확인 (30초) kubectl get nodes,pods -A | grep -v Running # 2. 트래픽 차단 (임시 점검 페이지) kubectl patch ingress openwebui-ingress -n openwebui -p \\ '{\"metadata\":{\"annotations\":{\"nginx.ingress.kubernetes.io/server-snippet\":\"return 503 \\\"Service temporarily unavailable\\\";\"}}}' # 3. 핵심 서비스부터 복구 kubectl rollout restart deployment/postgres -n openwebui kubectl rollout restart deployment/litellm -n litellm kubectl rollout restart deployment/openwebui -n openwebui # 4. 상태 확인 후 트래픽 복구 kubectl patch ingress openwebui-ingress -n openwebui -p \\ '{\"metadata\":{\"annotations\":{\"nginx.ingress.kubernetes.io/server-snippet\":null}}}' 💾 데이터 손실 위험 # 1. 즉시 백업 실행 kubectl exec deployment/postgres -n openwebui -- \\ pg_dump -U openwebui openwebui \u003e emergency_backup_$(date +%Y%m%d_%H%M%S).sql # 2. PVC 스냅샷 생성 (AWS EBS) aws ec2 describe-volumes --filters \"Name=tag:kubernetes.io/created-for/pvc/name,Values=postgres-pvc\" aws ec2 create-snapshot --volume-id vol-xxxxxxxxx --description \"Emergency snapshot\" # 3. 읽기 전용 모드로 전환 (데이터 보호) kubectl patch deployment openwebui -n openwebui -p \\ '{\"spec\":{\"replicas\":0}}' 🚨 보안 침해 의심 # 1. 즉시 네트워크 차단 kubectl delete ingress openwebui-ingress -n openwebui # 2. 로그 수집 및 보존 kubectl logs deployment/openwebui -n openwebui \u003e security_logs_$(date +%Y%m%d_%H%M%S).log # 3. 시크릿 로테이션 kubectl delete secret api-keys -n litellm kubectl delete secret app-secrets -n openwebui # 4. 포렌식 분석용 파드 이미지 보존 kubectl get pods -n openwebui -o yaml \u003e pods_snapshot_$(date +%Y%m%d_%H%M%S).yaml 문서 개선 요청 새로운 문제 발생 시 이 문서에 추가 해결책이 효과적이지 않은 경우 피드백 더 나은 해결 방법 발견 시 공유 🔄 문제 해결 체크리스트 문제 발생 시 다음 순서로 진행:\n기본 상태 확인 (노드, 파드, 서비스) 로그 확인 (애플리케이션, 시스템) 리소스 사용량 확인 최근 변경사항 확인 네트워크 연결 확인 백업 상태 확인 임시 해결책 적용 근본 원인 분석 영구 해결책 적용 문서 업데이트 ",
  "wordCount" : "2035",
  "inLanguage": "en",
  "datePublished": "0001-01-01T00:00:00Z",
  "dateModified": "0001-01-01T00:00:00Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://8dobibim.github.io/backend/%ED%8A%B8%EB%9F%AC%EB%B8%94%EC%8A%88%ED%8C%85-%EA%B0%80%EC%9D%B4%EB%93%9C--faq/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "8dobibim Tech Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://8dobibim.github.io/%3Clink%20/%20abs%20url%3E"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://8dobibim.github.io/" accesskey="h" title="8dobibim Tech Blog (Alt + H)">8dobibim Tech Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://8dobibim.github.io/frontend/" title="🖥 프론트엔드">
                    <span>🖥 프론트엔드</span>
                </a>
            </li>
            <li>
                <a href="https://8dobibim.github.io/backend/" title="💾 백엔드">
                    <span>💾 백엔드</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://8dobibim.github.io/">Home</a>&nbsp;»&nbsp;<a href="https://8dobibim.github.io/backend/">Backend 문서</a></div>
    <h1 class="post-title entry-hint-parent">
      
    </h1>
    <div class="post-meta">10 min&nbsp;·&nbsp;2035 words

</div>
  </header> <div class="toc">
    <details  open>
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#-%ed%8a%b8%eb%9f%ac%eb%b8%94%ec%8a%88%ed%8c%85-%ea%b0%80%ec%9d%b4%eb%93%9c--faq" aria-label="🚨 트러블슈팅 가이드 &amp; FAQ">🚨 트러블슈팅 가이드 &amp; FAQ</a><ul>
                        
                <li>
                    <a href="#-%eb%b9%a0%eb%a5%b8-%eb%ac%b8%ec%a0%9c-%ec%a7%84%eb%8b%a8" aria-label="🔍 빠른 문제 진단">🔍 빠른 문제 진단</a><ul>
                        
                <li>
                    <a href="#1%eb%8b%a8%ea%b3%84-%ea%b8%b0%eb%b3%b8-%ec%83%81%ed%83%9c-%ed%99%95%ec%9d%b8-30%ec%b4%88" aria-label="1단계: 기본 상태 확인 (30초)">1단계: 기본 상태 확인 (30초)</a></li>
                <li>
                    <a href="#2%eb%8b%a8%ea%b3%84-%ec%95%a0%ed%94%8c%eb%a6%ac%ec%bc%80%ec%9d%b4%ec%85%98%eb%b3%84-%ec%83%81%ed%83%9c-1%eb%b6%84" aria-label="2단계: 애플리케이션별 상태 (1분)">2단계: 애플리케이션별 상태 (1분)</a></li>
                <li>
                    <a href="#3%eb%8b%a8%ea%b3%84-%eb%a6%ac%ec%86%8c%ec%8a%a4-%ec%82%ac%ec%9a%a9%eb%9f%89-30%ec%b4%88" aria-label="3단계: 리소스 사용량 (30초)">3단계: 리소스 사용량 (30초)</a></li></ul>
                </li>
                <li>
                    <a href="#-%ec%9d%b8%ed%94%84%eb%9d%bc-%ea%b4%80%eb%a0%a8-%eb%ac%b8%ec%a0%9c" aria-label="🔧 인프라 관련 문제">🔧 인프라 관련 문제</a><ul>
                        
                <li>
                    <a href="#-%eb%85%b8%eb%93%9c%ea%b0%80-notready-%ec%83%81%ed%83%9c" aria-label="❌ 노드가 NotReady 상태">❌ 노드가 NotReady 상태</a></li>
                <li>
                    <a href="#-%ed%8c%8c%eb%93%9c%ea%b0%80-pending-%ec%83%81%ed%83%9c" aria-label="❌ 파드가 Pending 상태">❌ 파드가 Pending 상태</a></li>
                <li>
                    <a href="#-%ec%9d%b4%eb%af%b8%ec%a7%80-pull-%ec%8b%a4%ed%8c%a8" aria-label="❌ 이미지 Pull 실패">❌ 이미지 Pull 실패</a></li></ul>
                </li>
                <li>
                    <a href="#-%eb%84%a4%ed%8a%b8%ec%9b%8c%ed%82%b9-%eb%ac%b8%ec%a0%9c" aria-label="🌐 네트워킹 문제">🌐 네트워킹 문제</a><ul>
                        
                <li>
                    <a href="#-%ec%84%9c%eb%b9%84%ec%8a%a4-%ec%97%b0%ea%b2%b0-%ec%8b%a4%ed%8c%a8" aria-label="❌ 서비스 연결 실패">❌ 서비스 연결 실패</a></li>
                <li>
                    <a href="#-ingress-%ec%a0%91%ea%b7%bc-%eb%b6%88%ea%b0%80" aria-label="❌ Ingress 접근 불가">❌ Ingress 접근 불가</a></li>
                <li>
                    <a href="#-dns-%ed%95%b4%ec%84%9d-%ec%8b%a4%ed%8c%a8" aria-label="❌ DNS 해석 실패">❌ DNS 해석 실패</a></li></ul>
                </li>
                <li>
                    <a href="#-%eb%8d%b0%ec%9d%b4%ed%84%b0%eb%b2%a0%ec%9d%b4%ec%8a%a4-%eb%ac%b8%ec%a0%9c" aria-label="🗃️ 데이터베이스 문제">🗃️ 데이터베이스 문제</a><ul>
                        
                <li>
                    <a href="#-postgresql-%ec%97%b0%ea%b2%b0-%ec%8b%a4%ed%8c%a8" aria-label="❌ PostgreSQL 연결 실패">❌ PostgreSQL 연결 실패</a></li>
                <li>
                    <a href="#-%eb%8d%b0%ec%9d%b4%ed%84%b0%eb%b2%a0%ec%9d%b4%ec%8a%a4-%eb%94%94%ec%8a%a4%ed%81%ac-%eb%b6%80%ec%a1%b1" aria-label="❌ 데이터베이스 디스크 부족">❌ 데이터베이스 디스크 부족</a></li></ul>
                </li>
                <li>
                    <a href="#-%ec%95%a0%ed%94%8c%eb%a6%ac%ec%bc%80%ec%9d%b4%ec%85%98-%eb%ac%b8%ec%a0%9c" aria-label="🤖 애플리케이션 문제">🤖 애플리케이션 문제</a><ul>
                        
                <li>
                    <a href="#-openwebui-500-%ec%97%90%eb%9f%ac" aria-label="❌ OpenWebUI 500 에러">❌ OpenWebUI 500 에러</a></li>
                <li>
                    <a href="#-litellm-api-%ec%9d%91%eb%8b%b5-%ec%97%86%ec%9d%8c" aria-label="❌ LiteLLM API 응답 없음">❌ LiteLLM API 응답 없음</a></li>
                <li>
                    <a href="#-%eb%a9%94%eb%aa%a8%eb%a6%ac-%eb%b6%80%ec%a1%b1-oomkilled" aria-label="❌ 메모리 부족 (OOMKilled)">❌ 메모리 부족 (OOMKilled)</a></li></ul>
                </li>
                <li>
                    <a href="#-%ec%84%b1%eb%8a%a5-%eb%ac%b8%ec%a0%9c" aria-label="📊 성능 문제">📊 성능 문제</a><ul>
                        
                <li>
                    <a href="#-%eb%8a%90%eb%a6%b0-%ec%9d%91%eb%8b%b5-%ec%8b%9c%ea%b0%84" aria-label="❌ 느린 응답 시간">❌ 느린 응답 시간</a></li>
                <li>
                    <a href="#-%eb%86%92%ec%9d%80-cpu-%ec%82%ac%ec%9a%a9%eb%a5%a0" aria-label="❌ 높은 CPU 사용률">❌ 높은 CPU 사용률</a></li></ul>
                </li>
                <li>
                    <a href="#-%eb%b3%b4%ec%95%88-%eb%ac%b8%ec%a0%9c" aria-label="🔒 보안 문제">🔒 보안 문제</a><ul>
                        
                <li>
                    <a href="#-%ec%9d%b4%eb%af%b8%ec%a7%80-%ec%b7%a8%ec%95%bd%ec%a0%90" aria-label="❌ 이미지 취약점">❌ 이미지 취약점</a></li>
                <li>
                    <a href="#-%ec%8b%9c%ed%81%ac%eb%a6%bf-%eb%85%b8%ec%b6%9c" aria-label="❌ 시크릿 노출">❌ 시크릿 노출</a></li></ul>
                </li>
                <li>
                    <a href="#-faq-%ec%9e%90%ec%a3%bc-%eb%ac%bb%eb%8a%94-%ec%a7%88%eb%ac%b8" aria-label="📋 FAQ (자주 묻는 질문)">📋 FAQ (자주 묻는 질문)</a><ul>
                        
                <li>
                    <a href="#q1-%ed%8c%8c%eb%93%9c%ea%b0%80-%ea%b3%84%ec%86%8d-%ec%9e%ac%ec%8b%9c%ec%9e%91%eb%90%98%eb%8a%94-%ec%9d%b4%ec%9c%a0%eb%8a%94" aria-label="Q1: 파드가 계속 재시작되는 이유는?">Q1: 파드가 계속 재시작되는 이유는?</a></li>
                <li>
                    <a href="#q2-%eb%b0%b0%ed%8f%ac-%ed%9b%84-%ec%99%b8%eb%b6%80%ec%97%90%ec%84%9c-%ec%a0%91%ea%b7%bc%ec%9d%b4-%ec%95%88-%eb%8f%bc%ec%9a%94" aria-label="Q2: 배포 후 외부에서 접근이 안 돼요">Q2: 배포 후 외부에서 접근이 안 돼요</a></li>
                <li>
                    <a href="#q3-%eb%8d%b0%ec%9d%b4%ed%84%b0%ea%b0%80-%ec%82%ac%eb%9d%bc%ec%a1%8c%ec%96%b4%ec%9a%94" aria-label="Q3: 데이터가 사라졌어요">Q3: 데이터가 사라졌어요</a></li>
                <li>
                    <a href="#q4-api-%ed%82%a4%ea%b0%80-%ec%9e%91%eb%8f%99%ed%95%98%ec%a7%80-%ec%95%8a%ec%95%84%ec%9a%94" aria-label="Q4: API 키가 작동하지 않아요">Q4: API 키가 작동하지 않아요</a></li>
                <li>
                    <a href="#q5-%eb%b9%84%ec%9a%a9%ec%9d%b4-%ec%98%88%ec%83%81%eb%b3%b4%eb%8b%a4-%eb%a7%8e%ec%9d%b4-%eb%82%98%ec%99%80%ec%9a%94" aria-label="Q5: 비용이 예상보다 많이 나와요">Q5: 비용이 예상보다 많이 나와요</a></li>
                <li>
                    <a href="#q6-%eb%a1%9c%ea%b7%b8%eb%a5%bc-%ec%96%b4%eb%94%94%ec%84%9c-%ed%99%95%ec%9d%b8%ed%95%98%eb%82%98%ec%9a%94" aria-label="Q6: 로그를 어디서 확인하나요?">Q6: 로그를 어디서 확인하나요?</a></li>
                <li>
                    <a href="#q7-%ec%84%b1%eb%8a%a5%ec%9d%b4-%eb%8a%90%eb%a0%a4%ec%a1%8c%ec%96%b4%ec%9a%94" aria-label="Q7: 성능이 느려졌어요">Q7: 성능이 느려졌어요</a></li>
                <li>
                    <a href="#q8-%ec%97%85%eb%8d%b0%ec%9d%b4%ed%8a%b8%eb%8a%94-%ec%96%b4%eb%96%bb%ea%b2%8c-%ed%95%98%eb%82%98%ec%9a%94" aria-label="Q8: 업데이트는 어떻게 하나요?">Q8: 업데이트는 어떻게 하나요?</a></li></ul>
                </li>
                <li>
                    <a href="#-%ea%b8%b4%ea%b8%89-%ec%83%81%ed%99%a9%eb%b3%84-%eb%8c%80%ec%9d%91" aria-label="🆘 긴급 상황별 대응">🆘 긴급 상황별 대응</a><ul>
                        
                <li>
                    <a href="#-%ec%a0%84%ec%b2%b4-%ec%84%9c%eb%b9%84%ec%8a%a4-%eb%8b%a4%ec%9a%b4" aria-label="🔥 전체 서비스 다운">🔥 전체 서비스 다운</a></li>
                <li>
                    <a href="#-%eb%8d%b0%ec%9d%b4%ed%84%b0-%ec%86%90%ec%8b%a4-%ec%9c%84%ed%97%98" aria-label="💾 데이터 손실 위험">💾 데이터 손실 위험</a></li>
                <li>
                    <a href="#-%eb%b3%b4%ec%95%88-%ec%b9%a8%ed%95%b4-%ec%9d%98%ec%8b%ac" aria-label="🚨 보안 침해 의심">🚨 보안 침해 의심</a></li>
                <li>
                    <a href="#%eb%ac%b8%ec%84%9c-%ea%b0%9c%ec%84%a0-%ec%9a%94%ec%b2%ad" aria-label="문서 개선 요청">문서 개선 요청</a></li></ul>
                </li>
                <li>
                    <a href="#-%eb%ac%b8%ec%a0%9c-%ed%95%b4%ea%b2%b0-%ec%b2%b4%ed%81%ac%eb%a6%ac%ec%8a%a4%ed%8a%b8" aria-label="🔄 문제 해결 체크리스트">🔄 문제 해결 체크리스트</a>
                </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h1 id="-트러블슈팅-가이드--faq">🚨 트러블슈팅 가이드 &amp; FAQ<a hidden class="anchor" aria-hidden="true" href="#-트러블슈팅-가이드--faq">#</a></h1>
<hr>
<h2 id="-빠른-문제-진단">🔍 빠른 문제 진단<a hidden class="anchor" aria-hidden="true" href="#-빠른-문제-진단">#</a></h2>
<h3 id="1단계-기본-상태-확인-30초">1단계: 기본 상태 확인 (30초)<a hidden class="anchor" aria-hidden="true" href="#1단계-기본-상태-확인-30초">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 한 번에 전체 상태 확인</span>
</span></span><span style="display:flex;"><span>kubectl get nodes,pods -A | grep -E <span style="color:#e6db74">&#34;(NotReady|Error|CrashLoop|Pending)&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 최근 이벤트 확인</span>
</span></span><span style="display:flex;"><span>kubectl get events -A --sort-by<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;.lastTimestamp&#39;</span> | tail -10
</span></span></code></pre></div><h3 id="2단계-애플리케이션별-상태-1분">2단계: 애플리케이션별 상태 (1분)<a hidden class="anchor" aria-hidden="true" href="#2단계-애플리케이션별-상태-1분">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># OpenWebUI 상태</span>
</span></span><span style="display:flex;"><span>kubectl get pods -n openwebui -o wide
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># LiteLLM 상태  </span>
</span></span><span style="display:flex;"><span>kubectl get pods -n litellm -o wide
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 데이터베이스 상태</span>
</span></span><span style="display:flex;"><span>kubectl get pods -n openwebui -l app<span style="color:#f92672">=</span>postgres
</span></span></code></pre></div><h3 id="3단계-리소스-사용량-30초">3단계: 리소스 사용량 (30초)<a hidden class="anchor" aria-hidden="true" href="#3단계-리소스-사용량-30초">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 노드 리소스</span>
</span></span><span style="display:flex;"><span>kubectl top nodes
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 파드 리소스</span>
</span></span><span style="display:flex;"><span>kubectl top pods -A --sort-by<span style="color:#f92672">=</span>cpu
</span></span></code></pre></div><hr>
<h2 id="-인프라-관련-문제">🔧 인프라 관련 문제<a hidden class="anchor" aria-hidden="true" href="#-인프라-관련-문제">#</a></h2>
<h3 id="-노드가-notready-상태">❌ 노드가 NotReady 상태<a hidden class="anchor" aria-hidden="true" href="#-노드가-notready-상태">#</a></h3>
<p><strong>증상:</strong></p>
<pre tabindex="0"><code>NAME       STATUS     ROLES    AGE   VERSION
node-1     NotReady   &lt;none&gt;   1d    v1.28.0
</code></pre><p><strong>원인 분석:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 노드 상세 정보 확인</span>
</span></span><span style="display:flex;"><span>kubectl describe node node-1
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 노드 로그 확인 (SSH 접속 필요)</span>
</span></span><span style="display:flex;"><span>sudo journalctl -u kubelet -f
</span></span></code></pre></div><p><strong>해결 방법:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 1. kubelet 재시작</span>
</span></span><span style="display:flex;"><span>sudo systemctl restart kubelet
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 2. 노드 재부팅 (심각한 경우)</span>
</span></span><span style="display:flex;"><span>sudo reboot
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 3. 노드 교체 (복구 불가능한 경우)</span>
</span></span><span style="display:flex;"><span>kubectl drain node-1 --ignore-daemonsets --delete-emptydir-data
</span></span><span style="display:flex;"><span>kubectl delete node node-1
</span></span><span style="display:flex;"><span><span style="color:#75715e"># AWS 콘솔에서 인스턴스 종료 (Auto Scaling이 새 노드 생성)</span>
</span></span></code></pre></div><h3 id="-파드가-pending-상태">❌ 파드가 Pending 상태<a hidden class="anchor" aria-hidden="true" href="#-파드가-pending-상태">#</a></h3>
<p><strong>증상:</strong></p>
<pre tabindex="0"><code>NAME                         READY   STATUS    RESTARTS   AGE
openwebui-5f7b8d6c9d-xyz     0/1     Pending   0          5m
</code></pre><p><strong>원인 분석:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>kubectl describe pod openwebui-5f7b8d6c9d-xyz -n openwebui
</span></span></code></pre></div><p><strong>일반적인 원인과 해결:</strong></p>
<ol>
<li><strong>리소스 부족</strong></li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 원인: Insufficient cpu/memory</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 해결: 리소스 요청량 조정 또는 노드 추가</span>
</span></span><span style="display:flex;"><span>kubectl patch deployment openwebui -n openwebui -p <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  <span style="color:#e6db74">&#39;{&#34;spec&#34;:{&#34;template&#34;:{&#34;spec&#34;:{&#34;containers&#34;:[{&#34;name&#34;:&#34;openwebui&#34;,&#34;resources&#34;:{&#34;requests&#34;:{&#34;cpu&#34;:&#34;100m&#34;,&#34;memory&#34;:&#34;256Mi&#34;}}}]}}}}&#39;</span>
</span></span></code></pre></div><ol start="2">
<li><strong>PVC 마운트 실패</strong></li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 원인: PVC not found or pending</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># PVC 상태 확인</span>
</span></span><span style="display:flex;"><span>kubectl get pvc -n openwebui
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># StorageClass 확인</span>
</span></span><span style="display:flex;"><span>kubectl get storageclass
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 해결: PVC 재생성</span>
</span></span><span style="display:flex;"><span>kubectl delete pvc openwebui-pvc -n openwebui
</span></span><span style="display:flex;"><span>kubectl apply -f kubernetes/base/openwebui/pvc.yaml
</span></span></code></pre></div><ol start="3">
<li><strong>노드 셀렉터 문제</strong></li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 원인: No nodes match nodeSelector</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 노드 레이블 확인</span>
</span></span><span style="display:flex;"><span>kubectl get nodes --show-labels
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 해결: nodeSelector 제거 또는 레이블 추가</span>
</span></span><span style="display:flex;"><span>kubectl label nodes node-1 environment<span style="color:#f92672">=</span>dev
</span></span></code></pre></div><h3 id="-이미지-pull-실패">❌ 이미지 Pull 실패<a hidden class="anchor" aria-hidden="true" href="#-이미지-pull-실패">#</a></h3>
<p><strong>증상:</strong></p>
<pre tabindex="0"><code>Failed to pull image &#34;ghcr.io/openwebui:latest&#34;: rpc error: code = Unknown desc = failed to pull and unpack image
</code></pre><p><strong>해결 방법:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 1. 이미지 태그 확인</span>
</span></span><span style="display:flex;"><span>docker pull ghcr.io/openwebui:latest
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 2. 레지스트리 접근 권한 확인</span>
</span></span><span style="display:flex;"><span>kubectl get secret -n openwebui | grep docker
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 3. 이미지 태그 수정</span>
</span></span><span style="display:flex;"><span>kubectl set image deployment/openwebui openwebui<span style="color:#f92672">=</span>ghcr.io/openwebui:v1.0.0 -n openwebui
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 4. 대체 이미지 사용</span>
</span></span><span style="display:flex;"><span>kubectl set image deployment/openwebui openwebui<span style="color:#f92672">=</span>nginx:latest -n openwebui
</span></span></code></pre></div><hr>
<h2 id="-네트워킹-문제">🌐 네트워킹 문제<a hidden class="anchor" aria-hidden="true" href="#-네트워킹-문제">#</a></h2>
<h3 id="-서비스-연결-실패">❌ 서비스 연결 실패<a hidden class="anchor" aria-hidden="true" href="#-서비스-연결-실패">#</a></h3>
<p><strong>증상:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl: <span style="color:#f92672">(</span>7<span style="color:#f92672">)</span> Failed to connect to service-name port 80: Connection refused
</span></span></code></pre></div><p><strong>진단 순서:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 1. 서비스 확인</span>
</span></span><span style="display:flex;"><span>kubectl get svc -n openwebui
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 2. 엔드포인트 확인</span>
</span></span><span style="display:flex;"><span>kubectl get endpoints -n openwebui
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 3. 파드 라벨 확인</span>
</span></span><span style="display:flex;"><span>kubectl get pods -n openwebui --show-labels
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 4. 서비스 셀렉터 확인</span>
</span></span><span style="display:flex;"><span>kubectl get svc openwebui-service -n openwebui -o yaml | grep -A <span style="color:#ae81ff">5</span> selector
</span></span></code></pre></div><p><strong>해결 방법:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 서비스와 파드 라벨 매칭 확인</span>
</span></span><span style="display:flex;"><span>kubectl patch svc openwebui-service -n openwebui -p <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  <span style="color:#e6db74">&#39;{&#34;spec&#34;:{&#34;selector&#34;:{&#34;app&#34;:&#34;openwebui&#34;}}}&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 파드 재시작</span>
</span></span><span style="display:flex;"><span>kubectl rollout restart deployment/openwebui -n openwebui
</span></span></code></pre></div><h3 id="-ingress-접근-불가">❌ Ingress 접근 불가<a hidden class="anchor" aria-hidden="true" href="#-ingress-접근-불가">#</a></h3>
<p><strong>증상:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl: <span style="color:#f92672">(</span>52<span style="color:#f92672">)</span> Empty reply from server
</span></span></code></pre></div><p><strong>진단:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Ingress 상태 확인</span>
</span></span><span style="display:flex;"><span>kubectl get ingress -n openwebui -o wide
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Ingress Controller 상태</span>
</span></span><span style="display:flex;"><span>kubectl get pods -n kube-system -l app.kubernetes.io/name<span style="color:#f92672">=</span>aws-load-balancer-controller
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ALB 상태 확인 (AWS)</span>
</span></span><span style="display:flex;"><span>aws elbv2 describe-load-balancers
</span></span></code></pre></div><p><strong>해결 방법:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 1. Ingress 재생성</span>
</span></span><span style="display:flex;"><span>kubectl delete ingress openwebui-ingress -n openwebui
</span></span><span style="display:flex;"><span>kubectl apply -f kubernetes/base/ingress/ingress.yaml
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 2. 서비스 타입을 LoadBalancer로 임시 변경</span>
</span></span><span style="display:flex;"><span>kubectl patch svc openwebui-service -n openwebui -p <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  <span style="color:#e6db74">&#39;{&#34;spec&#34;:{&#34;type&#34;:&#34;LoadBalancer&#34;}}&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 3. 포트 포워딩으로 임시 접근</span>
</span></span><span style="display:flex;"><span>kubectl port-forward svc/openwebui-service 8080:8080 -n openwebui
</span></span></code></pre></div><h3 id="-dns-해석-실패">❌ DNS 해석 실패<a hidden class="anchor" aria-hidden="true" href="#-dns-해석-실패">#</a></h3>
<p><strong>증상:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>nslookup: can<span style="color:#e6db74">&#39;t resolve &#39;</span>service-name.namespace.svc.cluster.local<span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span></code></pre></div><p><strong>진단 및 해결:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># CoreDNS 상태 확인</span>
</span></span><span style="display:flex;"><span>kubectl get pods -n kube-system -l k8s-app<span style="color:#f92672">=</span>kube-dns
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># DNS 설정 확인</span>
</span></span><span style="display:flex;"><span>kubectl get configmap coredns -n kube-system -o yaml
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># DNS 테스트</span>
</span></span><span style="display:flex;"><span>kubectl run debug --image<span style="color:#f92672">=</span>busybox -it --rm -- nslookup kubernetes.default.svc.cluster.local
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># CoreDNS 재시작</span>
</span></span><span style="display:flex;"><span>kubectl rollout restart deployment/coredns -n kube-system
</span></span></code></pre></div><hr>
<h2 id="-데이터베이스-문제">🗃️ 데이터베이스 문제<a hidden class="anchor" aria-hidden="true" href="#-데이터베이스-문제">#</a></h2>
<h3 id="-postgresql-연결-실패">❌ PostgreSQL 연결 실패<a hidden class="anchor" aria-hidden="true" href="#-postgresql-연결-실패">#</a></h3>
<p><strong>증상:</strong></p>
<pre tabindex="0"><code>psql: FATAL: password authentication failed for user &#34;openwebui&#34;
</code></pre><p><strong>진단:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 파드 상태 확인</span>
</span></span><span style="display:flex;"><span>kubectl get pods -l app<span style="color:#f92672">=</span>postgres -n openwebui
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 로그 확인</span>
</span></span><span style="display:flex;"><span>kubectl logs deployment/postgres -n openwebui
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 시크릿 확인</span>
</span></span><span style="display:flex;"><span>kubectl get secret app-secrets -n openwebui -o yaml
</span></span></code></pre></div><p><strong>해결 방법:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 1. 시크릿 재생성</span>
</span></span><span style="display:flex;"><span>kubectl delete secret app-secrets -n openwebui
</span></span><span style="display:flex;"><span>kubectl create secret generic app-secrets <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  --from-literal<span style="color:#f92672">=</span>POSTGRES_USER<span style="color:#f92672">=</span>openwebui <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  --from-literal<span style="color:#f92672">=</span>POSTGRES_PASSWORD<span style="color:#f92672">=</span>newpassword <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  -n openwebui
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 2. 데이터베이스 재시작</span>
</span></span><span style="display:flex;"><span>kubectl rollout restart deployment/postgres -n openwebui
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 3. 직접 연결 테스트</span>
</span></span><span style="display:flex;"><span>kubectl exec -it deployment/postgres -n openwebui -- <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  psql -U openwebui -d openwebui -c <span style="color:#e6db74">&#34;SELECT 1;&#34;</span>
</span></span></code></pre></div><h3 id="-데이터베이스-디스크-부족">❌ 데이터베이스 디스크 부족<a hidden class="anchor" aria-hidden="true" href="#-데이터베이스-디스크-부족">#</a></h3>
<p><strong>증상:</strong></p>
<pre tabindex="0"><code>ERROR: could not extend file &#34;base/16384/16439&#34;: No space left on device
</code></pre><p><strong>해결 방법:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 1. PVC 크기 확장</span>
</span></span><span style="display:flex;"><span>kubectl patch pvc postgres-pvc -n openwebui -p <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  <span style="color:#e6db74">&#39;{&#34;spec&#34;:{&#34;resources&#34;:{&#34;requests&#34;:{&#34;storage&#34;:&#34;20Gi&#34;}}}}&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 2. 불필요한 데이터 정리</span>
</span></span><span style="display:flex;"><span>kubectl exec deployment/postgres -n openwebui -- <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  psql -U openwebui -d openwebui -c <span style="color:#e6db74">&#34;VACUUM FULL;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 3. 백업 후 데이터베이스 재생성</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 백업 실행</span>
</span></span><span style="display:flex;"><span>kubectl exec deployment/postgres -n openwebui -- <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  pg_dump -U openwebui openwebui &gt; backup.sql
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># PVC 삭제 및 재생성</span>
</span></span><span style="display:flex;"><span>kubectl delete pvc postgres-pvc -n openwebui
</span></span><span style="display:flex;"><span>kubectl apply -f kubernetes/base/postgres/pvc.yaml
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 복원</span>
</span></span><span style="display:flex;"><span>kubectl exec -i deployment/postgres -n openwebui -- <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  psql -U openwebui openwebui &lt; backup.sql
</span></span></code></pre></div><hr>
<h2 id="-애플리케이션-문제">🤖 애플리케이션 문제<a hidden class="anchor" aria-hidden="true" href="#-애플리케이션-문제">#</a></h2>
<h3 id="-openwebui-500-에러">❌ OpenWebUI 500 에러<a hidden class="anchor" aria-hidden="true" href="#-openwebui-500-에러">#</a></h3>
<p><strong>증상:</strong></p>
<pre tabindex="0"><code>HTTP 500 Internal Server Error
</code></pre><p><strong>진단:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 애플리케이션 로그 확인</span>
</span></span><span style="display:flex;"><span>kubectl logs deployment/openwebui -n openwebui --tail<span style="color:#f92672">=</span><span style="color:#ae81ff">100</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 환경 변수 확인</span>
</span></span><span style="display:flex;"><span>kubectl exec deployment/openwebui -n openwebui -- env | grep -E <span style="color:#e6db74">&#34;(DATABASE|SECRET)&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 헬스체크 확인</span>
</span></span><span style="display:flex;"><span>kubectl exec deployment/openwebui -n openwebui -- <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  curl -f http://localhost:8080/health
</span></span></code></pre></div><p><strong>해결 방법:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 1. 애플리케이션 재시작</span>
</span></span><span style="display:flex;"><span>kubectl rollout restart deployment/openwebui -n openwebui
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 2. 환경 변수 확인 및 수정</span>
</span></span><span style="display:flex;"><span>kubectl patch deployment openwebui -n openwebui -p <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  <span style="color:#e6db74">&#39;{&#34;spec&#34;:{&#34;template&#34;:{&#34;spec&#34;:{&#34;containers&#34;:[{&#34;name&#34;:&#34;openwebui&#34;,&#34;env&#34;:[{&#34;name&#34;:&#34;DEBUG&#34;,&#34;value&#34;:&#34;true&#34;}]}]}}}}&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 3. 이전 버전으로 롤백</span>
</span></span><span style="display:flex;"><span>kubectl rollout undo deployment/openwebui -n openwebui
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 4. 데이터베이스 연결 확인</span>
</span></span><span style="display:flex;"><span>kubectl exec deployment/openwebui -n openwebui -- <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  nc -zv postgres-service <span style="color:#ae81ff">5432</span>
</span></span></code></pre></div><h3 id="-litellm-api-응답-없음">❌ LiteLLM API 응답 없음<a hidden class="anchor" aria-hidden="true" href="#-litellm-api-응답-없음">#</a></h3>
<p><strong>증상:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl: <span style="color:#f92672">(</span>7<span style="color:#f92672">)</span> Failed to connect to litellm-service port <span style="color:#ae81ff">4000</span>
</span></span></code></pre></div><p><strong>진단 및 해결:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 파드 상태 확인</span>
</span></span><span style="display:flex;"><span>kubectl get pods -l app<span style="color:#f92672">=</span>litellm -n litellm
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># API 키 확인</span>
</span></span><span style="display:flex;"><span>kubectl get secret api-keys -n litellm -o yaml
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 설정 파일 확인</span>
</span></span><span style="display:flex;"><span>kubectl get configmap litellm-config -n litellm -o yaml
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 직접 API 테스트</span>
</span></span><span style="display:flex;"><span>kubectl exec deployment/litellm -n litellm -- <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  curl -s http://localhost:4000/health
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 재시작</span>
</span></span><span style="display:flex;"><span>kubectl rollout restart deployment/litellm -n litellm
</span></span></code></pre></div><h3 id="-메모리-부족-oomkilled">❌ 메모리 부족 (OOMKilled)<a hidden class="anchor" aria-hidden="true" href="#-메모리-부족-oomkilled">#</a></h3>
<p><strong>증상:</strong></p>
<pre tabindex="0"><code>Last State: Terminated
Reason: OOMKilled
</code></pre><p><strong>해결 방법:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 1. 메모리 리미트 증가</span>
</span></span><span style="display:flex;"><span>kubectl patch deployment openwebui -n openwebui -p <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  <span style="color:#e6db74">&#39;{&#34;spec&#34;:{&#34;template&#34;:{&#34;spec&#34;:{&#34;containers&#34;:[{&#34;name&#34;:&#34;openwebui&#34;,&#34;resources&#34;:{&#34;limits&#34;:{&#34;memory&#34;:&#34;2Gi&#34;}}}]}}}}&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 2. 메모리 사용량 확인</span>
</span></span><span style="display:flex;"><span>kubectl top pods -n openwebui --containers
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 3. 메모리 요청량 조정</span>
</span></span><span style="display:flex;"><span>kubectl patch deployment openwebui -n openwebui -p <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  <span style="color:#e6db74">&#39;{&#34;spec&#34;:{&#34;template&#34;:{&#34;spec&#34;:{&#34;containers&#34;:[{&#34;name&#34;:&#34;openwebui&#34;,&#34;resources&#34;:{&#34;requests&#34;:{&#34;memory&#34;:&#34;512Mi&#34;}}}]}}}}&#39;</span>
</span></span></code></pre></div><hr>
<h2 id="-성능-문제">📊 성능 문제<a hidden class="anchor" aria-hidden="true" href="#-성능-문제">#</a></h2>
<h3 id="-느린-응답-시간">❌ 느린 응답 시간<a hidden class="anchor" aria-hidden="true" href="#-느린-응답-시간">#</a></h3>
<p><strong>진단:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 응답 시간 측정</span>
</span></span><span style="display:flex;"><span>kubectl exec deployment/openwebui -n openwebui -- <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  curl -w <span style="color:#e6db74">&#34;Total time: %{time_total}s\n&#34;</span> -o /dev/null -s http://localhost:8080
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 리소스 사용량 확인</span>
</span></span><span style="display:flex;"><span>kubectl top pods -n openwebui --containers
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 데이터베이스 쿼리 성능 확인</span>
</span></span><span style="display:flex;"><span>kubectl exec deployment/postgres -n openwebui -- <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  psql -U openwebui -d openwebui -c <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  <span style="color:#e6db74">&#34;SELECT query, mean_exec_time FROM pg_stat_statements ORDER BY mean_exec_time DESC LIMIT 5;&#34;</span>
</span></span></code></pre></div><p><strong>해결 방법:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 1. HPA 스케일링 확인</span>
</span></span><span style="display:flex;"><span>kubectl get hpa -n openwebui
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 2. 수동 스케일링</span>
</span></span><span style="display:flex;"><span>kubectl scale deployment openwebui --replicas<span style="color:#f92672">=</span><span style="color:#ae81ff">4</span> -n openwebui
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 3. 리소스 증량</span>
</span></span><span style="display:flex;"><span>kubectl patch deployment openwebui -n openwebui -p <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  <span style="color:#e6db74">&#39;{&#34;spec&#34;:{&#34;template&#34;:{&#34;spec&#34;:{&#34;containers&#34;:[{&#34;name&#34;:&#34;openwebui&#34;,&#34;resources&#34;:{&#34;requests&#34;:{&#34;cpu&#34;:&#34;500m&#34;,&#34;memory&#34;:&#34;1Gi&#34;}}}]}}}}&#39;</span>
</span></span></code></pre></div><h3 id="-높은-cpu-사용률">❌ 높은 CPU 사용률<a hidden class="anchor" aria-hidden="true" href="#-높은-cpu-사용률">#</a></h3>
<p><strong>해결 방법:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># CPU 사용률 확인</span>
</span></span><span style="display:flex;"><span>kubectl top pods -n openwebui --sort-by<span style="color:#f92672">=</span>cpu
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 프로파일링 (가능한 경우)</span>
</span></span><span style="display:flex;"><span>kubectl exec deployment/openwebui -n openwebui -- <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  curl -s http://localhost:8080/debug/pprof/profile &gt; cpu.prof
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 수평 스케일링</span>
</span></span><span style="display:flex;"><span>kubectl patch hpa openwebui-hpa -n openwebui -p <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  <span style="color:#e6db74">&#39;{&#34;spec&#34;:{&#34;targetCPUUtilizationPercentage&#34;:50}}&#39;</span>
</span></span></code></pre></div><hr>
<h2 id="-보안-문제">🔒 보안 문제<a hidden class="anchor" aria-hidden="true" href="#-보안-문제">#</a></h2>
<h3 id="-이미지-취약점">❌ 이미지 취약점<a hidden class="anchor" aria-hidden="true" href="#-이미지-취약점">#</a></h3>
<p><strong>진단:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 이미지 스캔</span>
</span></span><span style="display:flex;"><span>trivy image ghcr.io/openwebui:latest
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 실행 중인 이미지 확인</span>
</span></span><span style="display:flex;"><span>kubectl get pods -n openwebui -o jsonpath<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;{.items[*].spec.containers[*].image}&#39;</span>
</span></span></code></pre></div><p><strong>해결 방법:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 1. 최신 이미지 업데이트</span>
</span></span><span style="display:flex;"><span>kubectl set image deployment/openwebui openwebui<span style="color:#f92672">=</span>ghcr.io/openwebui:v1.0.1 -n openwebui
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 2. 보안 패치된 베이스 이미지 사용</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Dockerfile 수정 후 재빌드 필요</span>
</span></span></code></pre></div><h3 id="-시크릿-노출">❌ 시크릿 노출<a hidden class="anchor" aria-hidden="true" href="#-시크릿-노출">#</a></h3>
<p><strong>진단:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 시크릿 확인</span>
</span></span><span style="display:flex;"><span>kubectl get secrets -A
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 파드에서 시크릿 사용 확인</span>
</span></span><span style="display:flex;"><span>kubectl get pods -n openwebui -o yaml | grep -A <span style="color:#ae81ff">10</span> secretRef
</span></span></code></pre></div><p><strong>해결 방법:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 1. 시크릿 로테이션</span>
</span></span><span style="display:flex;"><span>kubectl delete secret api-keys -n litellm
</span></span><span style="display:flex;"><span>kubectl create secret generic api-keys <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  --from-literal<span style="color:#f92672">=</span>OPENAI_API_KEY<span style="color:#f92672">=</span>new-secure-key <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  -n litellm
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 2. 애플리케이션 재시작</span>
</span></span><span style="display:flex;"><span>kubectl rollout restart deployment/litellm -n litellm
</span></span></code></pre></div><hr>
<h2 id="-faq-자주-묻는-질문">📋 FAQ (자주 묻는 질문)<a hidden class="anchor" aria-hidden="true" href="#-faq-자주-묻는-질문">#</a></h2>
<h3 id="q1-파드가-계속-재시작되는-이유는">Q1: 파드가 계속 재시작되는 이유는?<a hidden class="anchor" aria-hidden="true" href="#q1-파드가-계속-재시작되는-이유는">#</a></h3>
<p><strong>A:</strong> 가장 일반적인 원인들:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 1. 헬스체크 실패</span>
</span></span><span style="display:flex;"><span>kubectl describe pod &lt;pod-name&gt; -n openwebui | grep -A <span style="color:#ae81ff">10</span> Events
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 2. 메모리 부족 (OOMKilled)</span>
</span></span><span style="display:flex;"><span>kubectl describe pod &lt;pod-name&gt; -n openwebui | grep OOMKilled
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 3. 애플리케이션 에러</span>
</span></span><span style="display:flex;"><span>kubectl logs &lt;pod-name&gt; -n openwebui --previous
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 해결: 리소스 증량 또는 헬스체크 조정</span>
</span></span></code></pre></div><h3 id="q2-배포-후-외부에서-접근이-안-돼요">Q2: 배포 후 외부에서 접근이 안 돼요<a hidden class="anchor" aria-hidden="true" href="#q2-배포-후-외부에서-접근이-안-돼요">#</a></h3>
<p><strong>A:</strong> 단계별 확인:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 1. 파드 상태</span>
</span></span><span style="display:flex;"><span>kubectl get pods -n openwebui
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 2. 서비스 상태  </span>
</span></span><span style="display:flex;"><span>kubectl get svc -n openwebui
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 3. Ingress 상태</span>
</span></span><span style="display:flex;"><span>kubectl get ingress -n openwebui
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 4. 로드밸런서 상태 (AWS 콘솔 확인)</span>
</span></span><span style="display:flex;"><span>aws elbv2 describe-load-balancers
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 임시 해결: 포트 포워딩</span>
</span></span><span style="display:flex;"><span>kubectl port-forward svc/openwebui-service 8080:8080 -n openwebui
</span></span></code></pre></div><h3 id="q3-데이터가-사라졌어요">Q3: 데이터가 사라졌어요<a hidden class="anchor" aria-hidden="true" href="#q3-데이터가-사라졌어요">#</a></h3>
<p><strong>A:</strong> 데이터 복구 방법:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 1. PVC 상태 확인</span>
</span></span><span style="display:flex;"><span>kubectl get pvc -n openwebui
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 2. 백업에서 복원</span>
</span></span><span style="display:flex;"><span>aws s3 ls s3://openwebui-backups/database/
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 3. 최신 백업으로 복원</span>
</span></span><span style="display:flex;"><span>./restore-database.sh openwebui_backup_20240301_120000.sql
</span></span></code></pre></div><h3 id="q4-api-키가-작동하지-않아요">Q4: API 키가 작동하지 않아요<a hidden class="anchor" aria-hidden="true" href="#q4-api-키가-작동하지-않아요">#</a></h3>
<p><strong>A:</strong> API 키 확인 및 업데이트:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 1. 현재 시크릿 확인</span>
</span></span><span style="display:flex;"><span>kubectl get secret api-keys -n litellm -o yaml
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 2. 디코딩해서 확인</span>
</span></span><span style="display:flex;"><span>kubectl get secret api-keys -n litellm -o jsonpath<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;{.data.OPENAI_API_KEY}&#39;</span> | base64 -d
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 3. 새 키로 업데이트</span>
</span></span><span style="display:flex;"><span>kubectl create secret generic api-keys <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  --from-literal<span style="color:#f92672">=</span>OPENAI_API_KEY<span style="color:#f92672">=</span>sk-new-key <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  --dry-run<span style="color:#f92672">=</span>client -o yaml | kubectl apply -f -
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 4. 파드 재시작</span>
</span></span><span style="display:flex;"><span>kubectl rollout restart deployment/litellm -n litellm
</span></span></code></pre></div><h3 id="q5-비용이-예상보다-많이-나와요">Q5: 비용이 예상보다 많이 나와요<a hidden class="anchor" aria-hidden="true" href="#q5-비용이-예상보다-많이-나와요">#</a></h3>
<p><strong>A:</strong> 비용 최적화 방법:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 1. 리소스 사용량 확인</span>
</span></span><span style="display:flex;"><span>kubectl top nodes
</span></span><span style="display:flex;"><span>kubectl top pods -A
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 2. Spot 인스턴스 활용</span>
</span></span><span style="display:flex;"><span>kubectl get nodes -l node.kubernetes.io/instance-type
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 3. 사용하지 않는 리소스 정리</span>
</span></span><span style="display:flex;"><span>kubectl get pods -A --field-selector<span style="color:#f92672">=</span>status.phase<span style="color:#f92672">=</span>Succeeded
</span></span><span style="display:flex;"><span>kubectl delete pods --field-selector<span style="color:#f92672">=</span>status.phase<span style="color:#f92672">=</span>Succeeded -A
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 4. HPA 최적화</span>
</span></span><span style="display:flex;"><span>kubectl patch hpa openwebui-hpa -n openwebui -p <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  <span style="color:#e6db74">&#39;{&#34;spec&#34;:{&#34;minReplicas&#34;:1,&#34;targetCPUUtilizationPercentage&#34;:70}}&#39;</span>
</span></span></code></pre></div><h3 id="q6-로그를-어디서-확인하나요">Q6: 로그를 어디서 확인하나요?<a hidden class="anchor" aria-hidden="true" href="#q6-로그를-어디서-확인하나요">#</a></h3>
<p><strong>A:</strong> 로그 확인 방법:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 1. 실시간 로그</span>
</span></span><span style="display:flex;"><span>kubectl logs -f deployment/openwebui -n openwebui
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 2. 특정 시간대 로그</span>
</span></span><span style="display:flex;"><span>kubectl logs --since<span style="color:#f92672">=</span>1h deployment/openwebui -n openwebui
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 3. 이전 컨테이너 로그 (재시작된 경우)</span>
</span></span><span style="display:flex;"><span>kubectl logs deployment/openwebui -n openwebui --previous
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 4. 모든 파드 로그</span>
</span></span><span style="display:flex;"><span>kubectl logs -l app<span style="color:#f92672">=</span>openwebui -n openwebui
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 5. 중앙화된 로깅 (Kibana)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># http://kibana.your-domain.com에서 확인</span>
</span></span></code></pre></div><h3 id="q7-성능이-느려졌어요">Q7: 성능이 느려졌어요<a hidden class="anchor" aria-hidden="true" href="#q7-성능이-느려졌어요">#</a></h3>
<p><strong>A:</strong> 성능 진단 단계:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 1. 리소스 사용량 확인</span>
</span></span><span style="display:flex;"><span>kubectl top pods -n openwebui --containers
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 2. 응답 시간 측정</span>
</span></span><span style="display:flex;"><span>kubectl exec deployment/openwebui -n openwebui -- <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  curl -w <span style="color:#e6db74">&#34;%{time_total}&#34;</span> -o /dev/null -s http://localhost:8080
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 3. 데이터베이스 성능 확인</span>
</span></span><span style="display:flex;"><span>kubectl exec deployment/postgres -n openwebui -- <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  psql -U openwebui -d openwebui -c <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  <span style="color:#e6db74">&#34;SELECT * FROM pg_stat_activity WHERE state = &#39;active&#39;;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 4. 스케일링 실행</span>
</span></span><span style="display:flex;"><span>kubectl scale deployment openwebui --replicas<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span> -n openwebui
</span></span></code></pre></div><h3 id="q8-업데이트는-어떻게-하나요">Q8: 업데이트는 어떻게 하나요?<a hidden class="anchor" aria-hidden="true" href="#q8-업데이트는-어떻게-하나요">#</a></h3>
<p><strong>A:</strong> 안전한 업데이트 방법:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 1. 백업 먼저 실행</span>
</span></span><span style="display:flex;"><span>./backup-database.sh
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 2. 새 버전으로 업데이트</span>
</span></span><span style="display:flex;"><span>kubectl set image deployment/openwebui openwebui<span style="color:#f92672">=</span>ghcr.io/openwebui:v1.1.0 -n openwebui
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 3. 롤아웃 상태 확인</span>
</span></span><span style="display:flex;"><span>kubectl rollout status deployment/openwebui -n openwebui
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 4. 문제 발생 시 롤백</span>
</span></span><span style="display:flex;"><span>kubectl rollout undo deployment/openwebui -n openwebui
</span></span></code></pre></div><hr>
<h2 id="-긴급-상황별-대응">🆘 긴급 상황별 대응<a hidden class="anchor" aria-hidden="true" href="#-긴급-상황별-대응">#</a></h2>
<h3 id="-전체-서비스-다운">🔥 전체 서비스 다운<a hidden class="anchor" aria-hidden="true" href="#-전체-서비스-다운">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 1. 즉시 상태 확인 (30초)</span>
</span></span><span style="display:flex;"><span>kubectl get nodes,pods -A | grep -v Running
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 2. 트래픽 차단 (임시 점검 페이지)</span>
</span></span><span style="display:flex;"><span>kubectl patch ingress openwebui-ingress -n openwebui -p <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  <span style="color:#e6db74">&#39;{&#34;metadata&#34;:{&#34;annotations&#34;:{&#34;nginx.ingress.kubernetes.io/server-snippet&#34;:&#34;return 503 \&#34;Service temporarily unavailable\&#34;;&#34;}}}&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 3. 핵심 서비스부터 복구</span>
</span></span><span style="display:flex;"><span>kubectl rollout restart deployment/postgres -n openwebui
</span></span><span style="display:flex;"><span>kubectl rollout restart deployment/litellm -n litellm  
</span></span><span style="display:flex;"><span>kubectl rollout restart deployment/openwebui -n openwebui
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 4. 상태 확인 후 트래픽 복구</span>
</span></span><span style="display:flex;"><span>kubectl patch ingress openwebui-ingress -n openwebui -p <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  <span style="color:#e6db74">&#39;{&#34;metadata&#34;:{&#34;annotations&#34;:{&#34;nginx.ingress.kubernetes.io/server-snippet&#34;:null}}}&#39;</span>
</span></span></code></pre></div><h3 id="-데이터-손실-위험">💾 데이터 손실 위험<a hidden class="anchor" aria-hidden="true" href="#-데이터-손실-위험">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 1. 즉시 백업 실행</span>
</span></span><span style="display:flex;"><span>kubectl exec deployment/postgres -n openwebui -- <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  pg_dump -U openwebui openwebui &gt; emergency_backup_<span style="color:#66d9ef">$(</span>date +%Y%m%d_%H%M%S<span style="color:#66d9ef">)</span>.sql
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 2. PVC 스냅샷 생성 (AWS EBS)</span>
</span></span><span style="display:flex;"><span>aws ec2 describe-volumes --filters <span style="color:#e6db74">&#34;Name=tag:kubernetes.io/created-for/pvc/name,Values=postgres-pvc&#34;</span>
</span></span><span style="display:flex;"><span>aws ec2 create-snapshot --volume-id vol-xxxxxxxxx --description <span style="color:#e6db74">&#34;Emergency snapshot&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 3. 읽기 전용 모드로 전환 (데이터 보호)</span>
</span></span><span style="display:flex;"><span>kubectl patch deployment openwebui -n openwebui -p <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  <span style="color:#e6db74">&#39;{&#34;spec&#34;:{&#34;replicas&#34;:0}}&#39;</span>
</span></span></code></pre></div><h3 id="-보안-침해-의심">🚨 보안 침해 의심<a hidden class="anchor" aria-hidden="true" href="#-보안-침해-의심">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 1. 즉시 네트워크 차단</span>
</span></span><span style="display:flex;"><span>kubectl delete ingress openwebui-ingress -n openwebui
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 2. 로그 수집 및 보존</span>
</span></span><span style="display:flex;"><span>kubectl logs deployment/openwebui -n openwebui &gt; security_logs_<span style="color:#66d9ef">$(</span>date +%Y%m%d_%H%M%S<span style="color:#66d9ef">)</span>.log
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 3. 시크릿 로테이션</span>
</span></span><span style="display:flex;"><span>kubectl delete secret api-keys -n litellm
</span></span><span style="display:flex;"><span>kubectl delete secret app-secrets -n openwebui
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 4. 포렌식 분석용 파드 이미지 보존</span>
</span></span><span style="display:flex;"><span>kubectl get pods -n openwebui -o yaml &gt; pods_snapshot_<span style="color:#66d9ef">$(</span>date +%Y%m%d_%H%M%S<span style="color:#66d9ef">)</span>.yaml
</span></span></code></pre></div><hr>
<h3 id="문서-개선-요청">문서 개선 요청<a hidden class="anchor" aria-hidden="true" href="#문서-개선-요청">#</a></h3>
<ul>
<li>새로운 문제 발생 시 이 문서에 추가</li>
<li>해결책이 효과적이지 않은 경우 피드백</li>
<li>더 나은 해결 방법 발견 시 공유</li>
</ul>
<hr>
<h2 id="-문제-해결-체크리스트">🔄 문제 해결 체크리스트<a hidden class="anchor" aria-hidden="true" href="#-문제-해결-체크리스트">#</a></h2>
<p>문제 발생 시 다음 순서로 진행:</p>
<ul>
<li><input disabled="" type="checkbox"> 기본 상태 확인 (노드, 파드, 서비스)</li>
<li><input disabled="" type="checkbox"> 로그 확인 (애플리케이션, 시스템)</li>
<li><input disabled="" type="checkbox"> 리소스 사용량 확인</li>
<li><input disabled="" type="checkbox"> 최근 변경사항 확인</li>
<li><input disabled="" type="checkbox"> 네트워크 연결 확인</li>
<li><input disabled="" type="checkbox"> 백업 상태 확인</li>
<li><input disabled="" type="checkbox"> 임시 해결책 적용</li>
<li><input disabled="" type="checkbox"> 근본 원인 분석</li>
<li><input disabled="" type="checkbox"> 영구 해결책 적용</li>
<li><input disabled="" type="checkbox"> 문서 업데이트</li>
</ul>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
<nav class="paginav">
  <a class="prev" href="https://8dobibim.github.io/backend/%EC%9A%B4%EC%98%81-%EB%A9%94%EB%89%B4%EC%96%BC/">
    <span class="title">« Prev</span>
    <br>
    <span></span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="https://8dobibim.github.io/">8dobibim Tech Blog</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
