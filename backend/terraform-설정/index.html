<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>8dobibim Tech Blog</title>
<meta name="keywords" content="">
<meta name="description" content="ğŸ—ï¸ ì‹¤ì œ í”„ë¡œì íŠ¸ ê¸°ë°˜ Terraform êµ¬ì„± ê°€ì´ë“œ

â±ï¸ ì˜ˆìƒ ì†Œìš”ì‹œê°„: 60-90ë¶„
ğŸ’¡ ë‚œì´ë„: ì¤‘ê¸‰
ğŸ“‹ ëª©í‘œ: Terraformì„ ì‚¬ìš©í•˜ì—¬ AWS EKS í´ëŸ¬ìŠ¤í„°ì™€ ì• í”Œë¦¬ì¼€ì´ì…˜ ìŠ¤íƒ êµ¬ì¶•
ğŸ“ ì „ì²´ ì½”ë“œ: GitHubì—ì„œ í™•ì¸í•˜ê¸°

ğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡°
terraform-related/
â””â”€â”€ AWS_terraform_grafana/
    â”œâ”€â”€ main.tf           # ë©”ì¸ ë¦¬ì†ŒìŠ¤ ì •ì˜
    â”œâ”€â”€ variables.tf      # ë³€ìˆ˜ ì„ ì–¸
    â”œâ”€â”€ versions.tf       # í”„ë¡œë°”ì´ë” ë²„ì „
    â”œâ”€â”€ terraform.tfvars  # ë³€ìˆ˜ ê°’ (Git ì œì™¸)
    â””â”€â”€ tfvars.example    # ë³€ìˆ˜ ì˜ˆì‹œ íŒŒì¼

ğŸ”§ Step 1: í”„ë¡œë°”ì´ë” ë° ë²„ì „ ì„¤ì •
versions.tf
terraform {
  required_providers {
    kubernetes = {
      source  = &#34;hashicorp/kubernetes&#34;
      version = &#34;2.23.0&#34;
    }
    aws = {
      source  = &#34;hashicorp/aws&#34;
      version = &#34;5.45.0&#34;
    }
  }
}
ğŸ” ì„¤ëª…:">
<meta name="author" content="">
<link rel="canonical" href="https://8dobibim.github.io/backend/terraform-%EC%84%A4%EC%A0%95/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.36819bea596090d8b48cf10d9831382996197aa7e4fc86f792f7c08c9ca4d23b.css" integrity="sha256-NoGb6llgkNi0jPENmDE4KZYZeqfk/Ib3kvfAjJyk0js=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://8dobibim.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://8dobibim.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://8dobibim.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://8dobibim.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://8dobibim.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://8dobibim.github.io/backend/terraform-%EC%84%A4%EC%A0%95/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:url" content="https://8dobibim.github.io/backend/terraform-%EC%84%A4%EC%A0%95/">
  <meta property="og:site_name" content="8dobibim Tech Blog">
  <meta property="og:title" content="8dobibim Tech Blog">
  <meta property="og:description" content="ğŸ—ï¸ ì‹¤ì œ í”„ë¡œì íŠ¸ ê¸°ë°˜ Terraform êµ¬ì„± ê°€ì´ë“œ â±ï¸ ì˜ˆìƒ ì†Œìš”ì‹œê°„: 60-90ë¶„
ğŸ’¡ ë‚œì´ë„: ì¤‘ê¸‰
ğŸ“‹ ëª©í‘œ: Terraformì„ ì‚¬ìš©í•˜ì—¬ AWS EKS í´ëŸ¬ìŠ¤í„°ì™€ ì• í”Œë¦¬ì¼€ì´ì…˜ ìŠ¤íƒ êµ¬ì¶•
ğŸ“ ì „ì²´ ì½”ë“œ: GitHubì—ì„œ í™•ì¸í•˜ê¸°
ğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡° terraform-related/â””â”€â”€ AWS_terraform_grafana/â”œâ”€â”€ main.tf # ë©”ì¸ ë¦¬ì†ŒìŠ¤ ì •ì˜â”œâ”€â”€ variables.tf # ë³€ìˆ˜ ì„ ì–¸â”œâ”€â”€ versions.tf # í”„ë¡œë°”ì´ë” ë²„ì „â”œâ”€â”€ terraform.tfvars # ë³€ìˆ˜ ê°’ (Git ì œì™¸)â””â”€â”€ tfvars.example # ë³€ìˆ˜ ì˜ˆì‹œ íŒŒì¼ ğŸ”§ Step 1: í”„ë¡œë°”ì´ë” ë° ë²„ì „ ì„¤ì • versions.tf terraform { required_providers { kubernetes = { source = &#34;hashicorp/kubernetes&#34; version = &#34;2.23.0&#34; } aws = { source = &#34;hashicorp/aws&#34; version = &#34;5.45.0&#34; } } } ğŸ” ì„¤ëª…:">
  <meta property="og:locale" content="ko">
  <meta property="og:type" content="article">
    <meta property="article:section" content="backend">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="">
<meta name="twitter:description" content="ğŸ—ï¸ ì‹¤ì œ í”„ë¡œì íŠ¸ ê¸°ë°˜ Terraform êµ¬ì„± ê°€ì´ë“œ

â±ï¸ ì˜ˆìƒ ì†Œìš”ì‹œê°„: 60-90ë¶„
ğŸ’¡ ë‚œì´ë„: ì¤‘ê¸‰
ğŸ“‹ ëª©í‘œ: Terraformì„ ì‚¬ìš©í•˜ì—¬ AWS EKS í´ëŸ¬ìŠ¤í„°ì™€ ì• í”Œë¦¬ì¼€ì´ì…˜ ìŠ¤íƒ êµ¬ì¶•
ğŸ“ ì „ì²´ ì½”ë“œ: GitHubì—ì„œ í™•ì¸í•˜ê¸°

ğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡°
terraform-related/
â””â”€â”€ AWS_terraform_grafana/
    â”œâ”€â”€ main.tf           # ë©”ì¸ ë¦¬ì†ŒìŠ¤ ì •ì˜
    â”œâ”€â”€ variables.tf      # ë³€ìˆ˜ ì„ ì–¸
    â”œâ”€â”€ versions.tf       # í”„ë¡œë°”ì´ë” ë²„ì „
    â”œâ”€â”€ terraform.tfvars  # ë³€ìˆ˜ ê°’ (Git ì œì™¸)
    â””â”€â”€ tfvars.example    # ë³€ìˆ˜ ì˜ˆì‹œ íŒŒì¼

ğŸ”§ Step 1: í”„ë¡œë°”ì´ë” ë° ë²„ì „ ì„¤ì •
versions.tf
terraform {
  required_providers {
    kubernetes = {
      source  = &#34;hashicorp/kubernetes&#34;
      version = &#34;2.23.0&#34;
    }
    aws = {
      source  = &#34;hashicorp/aws&#34;
      version = &#34;5.45.0&#34;
    }
  }
}
ğŸ” ì„¤ëª…:">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Backend ë¬¸ì„œ",
      "item": "https://8dobibim.github.io/backend/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "",
      "item": "https://8dobibim.github.io/backend/terraform-%EC%84%A4%EC%A0%95/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "",
  "name": "",
  "description": "ğŸ—ï¸ ì‹¤ì œ í”„ë¡œì íŠ¸ ê¸°ë°˜ Terraform êµ¬ì„± ê°€ì´ë“œ â±ï¸ ì˜ˆìƒ ì†Œìš”ì‹œê°„: 60-90ë¶„\nğŸ’¡ ë‚œì´ë„: ì¤‘ê¸‰\nğŸ“‹ ëª©í‘œ: Terraformì„ ì‚¬ìš©í•˜ì—¬ AWS EKS í´ëŸ¬ìŠ¤í„°ì™€ ì• í”Œë¦¬ì¼€ì´ì…˜ ìŠ¤íƒ êµ¬ì¶•\nğŸ“ ì „ì²´ ì½”ë“œ: GitHubì—ì„œ í™•ì¸í•˜ê¸°\nğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡° terraform-related/\râ””â”€â”€ AWS_terraform_grafana/\râ”œâ”€â”€ main.tf # ë©”ì¸ ë¦¬ì†ŒìŠ¤ ì •ì˜\râ”œâ”€â”€ variables.tf # ë³€ìˆ˜ ì„ ì–¸\râ”œâ”€â”€ versions.tf # í”„ë¡œë°”ì´ë” ë²„ì „\râ”œâ”€â”€ terraform.tfvars # ë³€ìˆ˜ ê°’ (Git ì œì™¸)\râ””â”€â”€ tfvars.example # ë³€ìˆ˜ ì˜ˆì‹œ íŒŒì¼ ğŸ”§ Step 1: í”„ë¡œë°”ì´ë” ë° ë²„ì „ ì„¤ì • versions.tf terraform { required_providers { kubernetes = { source = \u0026#34;hashicorp/kubernetes\u0026#34; version = \u0026#34;2.23.0\u0026#34; } aws = { source = \u0026#34;hashicorp/aws\u0026#34; version = \u0026#34;5.45.0\u0026#34; } } } ğŸ” ì„¤ëª…:\n",
  "keywords": [
    
  ],
  "articleBody": "ğŸ—ï¸ ì‹¤ì œ í”„ë¡œì íŠ¸ ê¸°ë°˜ Terraform êµ¬ì„± ê°€ì´ë“œ â±ï¸ ì˜ˆìƒ ì†Œìš”ì‹œê°„: 60-90ë¶„\nğŸ’¡ ë‚œì´ë„: ì¤‘ê¸‰\nğŸ“‹ ëª©í‘œ: Terraformì„ ì‚¬ìš©í•˜ì—¬ AWS EKS í´ëŸ¬ìŠ¤í„°ì™€ ì• í”Œë¦¬ì¼€ì´ì…˜ ìŠ¤íƒ êµ¬ì¶•\nğŸ“ ì „ì²´ ì½”ë“œ: GitHubì—ì„œ í™•ì¸í•˜ê¸°\nğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡° terraform-related/\râ””â”€â”€ AWS_terraform_grafana/\râ”œâ”€â”€ main.tf # ë©”ì¸ ë¦¬ì†ŒìŠ¤ ì •ì˜\râ”œâ”€â”€ variables.tf # ë³€ìˆ˜ ì„ ì–¸\râ”œâ”€â”€ versions.tf # í”„ë¡œë°”ì´ë” ë²„ì „\râ”œâ”€â”€ terraform.tfvars # ë³€ìˆ˜ ê°’ (Git ì œì™¸)\râ””â”€â”€ tfvars.example # ë³€ìˆ˜ ì˜ˆì‹œ íŒŒì¼ ğŸ”§ Step 1: í”„ë¡œë°”ì´ë” ë° ë²„ì „ ì„¤ì • versions.tf terraform { required_providers { kubernetes = { source = \"hashicorp/kubernetes\" version = \"2.23.0\" } aws = { source = \"hashicorp/aws\" version = \"5.45.0\" } } } ğŸ” ì„¤ëª…:\nAWSì™€ Kubernetes í”„ë¡œë°”ì´ë” ì‚¬ìš© ë²„ì „ì„ ê³ ì •í•˜ì—¬ ì¼ê´€ì„± ë³´ì¥ ğŸŒ Step 2: ë„¤íŠ¸ì›Œí¬ ì¸í”„ë¼ êµ¬ì„± 2-1. í”„ë¡œë°”ì´ë” ì„¤ì • provider \"aws\" { region = var.aws_region profile = \"llm\" # AWS CLI í”„ë¡œíŒŒì¼ ì‚¬ìš© } # EKS ì¸ì¦ ì •ë³´ data \"aws_eks_cluster_auth\" \"main\" { name = aws_eks_cluster.main.name } # Kubernetes í”„ë¡œë°”ì´ë” (EKS ì—°ë™) provider \"kubernetes\" { alias = \"eks\" host = aws_eks_cluster.main.endpoint cluster_ca_certificate = base64decode(aws_eks_cluster.main.certificate_authority[0].data) token = data.aws_eks_cluster_auth.main.token } ğŸ” ì„¤ëª…:\nprofile: AWS CLIì— ì„¤ì •ëœ í”„ë¡œíŒŒì¼ ì‚¬ìš© EKS í´ëŸ¬ìŠ¤í„° ìƒì„± í›„ ìë™ìœ¼ë¡œ ì¸ì¦ ì •ë³´ ê°€ì ¸ì˜´ Kubernetes í”„ë¡œë°”ì´ë”ëŠ” EKS ì—”ë“œí¬ì¸íŠ¸ì™€ ì—°ë™ 2-2. VPC ìƒì„± resource \"aws_vpc\" \"main\" { cidr_block = \"10.38.0.0/16\" tags = { Name = \"llm-project-eks-vpc\" } } ğŸ” ì„¤ëª…:\nì „ìš© VPC ìƒì„± (10.38.0.0/16 ëŒ€ì—­) ì¶©ë¶„í•œ IP ì£¼ì†Œ ê³µê°„ í™•ë³´ (65,536ê°œ) 2-3. ì„œë¸Œë„· êµ¬ì„± # ì„œë¸Œë„· 1 (ê°€ìš©ì˜ì—­ 2b) resource \"aws_subnet\" \"subnet_1\" { vpc_id = aws_vpc.main.id cidr_block = \"10.38.1.0/24\" availability_zone = \"ap-northeast-2b\" map_public_ip_on_launch = true tags = { Name = \"llm-subnet-1\" } } # ì„œë¸Œë„· 2 (ê°€ìš©ì˜ì—­ 2c) resource \"aws_subnet\" \"subnet_2\" { vpc_id = aws_vpc.main.id cidr_block = \"10.38.2.0/24\" availability_zone = \"ap-northeast-2c\" map_public_ip_on_launch = true tags = { Name = \"llm-subnet-2\" } } ğŸ” ì„¤ëª…:\n2ê°œì˜ ê°€ìš©ì˜ì—­ì— ì„œë¸Œë„· ë°°ì¹˜ (ê³ ê°€ìš©ì„±) Public IP ìë™ í• ë‹¹ ì„¤ì • ê° ì„œë¸Œë„·ì€ 256ê°œì˜ IP ì£¼ì†Œ ì œê³µ 2-4. ì¸í„°ë„· ì—°ê²° ì„¤ì • # ì¸í„°ë„· ê²Œì´íŠ¸ì›¨ì´ resource \"aws_internet_gateway\" \"main\" { vpc_id = aws_vpc.main.id tags = { Name = \"llm-project-eks-igw\" } } # ë¼ìš°íŒ… í…Œì´ë¸” resource \"aws_route_table\" \"main\" { vpc_id = aws_vpc.main.id route { cidr_block = \"0.0.0.0/0\" gateway_id = aws_internet_gateway.main.id } tags = { Name = \"llm-project-eks-rt\" } } # ì„œë¸Œë„·ê³¼ ë¼ìš°íŒ… í…Œì´ë¸” ì—°ê²° resource \"aws_route_table_association\" \"subnet_1\" { subnet_id = aws_subnet.subnet_1.id route_table_id = aws_route_table.main.id } resource \"aws_route_table_association\" \"subnet_2\" { subnet_id = aws_subnet.subnet_2.id route_table_id = aws_route_table.main.id } ğŸ” ì„¤ëª…:\nì¸í„°ë„· ê²Œì´íŠ¸ì›¨ì´ë¡œ ì™¸ë¶€ í†µì‹  í™œì„±í™” ëª¨ë“  ì™¸ë¶€ íŠ¸ë˜í”½(0.0.0.0/0)ì„ IGWë¡œ ë¼ìš°íŒ… ğŸ”’ Step 3: ë³´ì•ˆ ê·¸ë£¹ ì„¤ì • 3-1. EKS í´ëŸ¬ìŠ¤í„° ë³´ì•ˆ ê·¸ë£¹ resource \"aws_security_group\" \"eks_cluster_sg\" { name = \"llm-project-eks-sg\" description = \"Security group for EKS cluster\" vpc_id = aws_vpc.main.id # VPC ë‚´ë¶€ í†µì‹  í—ˆìš© ingress { from_port = 0 to_port = 0 protocol = \"-1\" cidr_blocks = [\"10.38.0.0/16\"] } # ëª¨ë“  ì•„ì›ƒë°”ìš´ë“œ í—ˆìš© egress { from_port = 0 to_port = 0 protocol = \"-1\" cidr_blocks = [\"0.0.0.0/0\"] } } 3-2. ì• í”Œë¦¬ì¼€ì´ì…˜ë³„ í¬íŠ¸ ê°œë°© # Grafana í¬íŠ¸ (3000-3001) resource \"aws_security_group_rule\" \"allow_openwebui_grafana\" { type = \"ingress\" from_port = 3000 to_port = 3001 protocol = \"tcp\" cidr_blocks = [\"0.0.0.0/0\"] security_group_id = aws_security_group.eks_cluster_sg.id } # Prometheus í¬íŠ¸ (9090) resource \"aws_security_group_rule\" \"allow_prometheus\" { type = \"ingress\" from_port = 9090 to_port = 9090 protocol = \"tcp\" cidr_blocks = [\"0.0.0.0/0\"] security_group_id = aws_security_group.eks_cluster_sg.id } ğŸ” ì„¤ëª…:\nVPC ë‚´ë¶€ëŠ” ëª¨ë“  í¬íŠ¸ í†µì‹  í—ˆìš© íŠ¹ì • ì„œë¹„ìŠ¤ í¬íŠ¸ë§Œ ì¸í„°ë„·ì—ì„œ ì ‘ê·¼ ê°€ëŠ¥ ğŸ‘¤ Step 4: IAM ì—­í•  ì„¤ì • 4-1. EKS í´ëŸ¬ìŠ¤í„° ì—­í•  resource \"aws_iam_role\" \"eks_cluster_role\" { name = \"llm-project-eks-eks-cluster-role-v3\" assume_role_policy = jsonencode({ Version = \"2012-10-17\", Statement = [{ Effect = \"Allow\", Principal = { Service = \"eks.amazonaws.com\" }, Action = \"sts:AssumeRole\" }] }) } # EKS í´ëŸ¬ìŠ¤í„° ì •ì±… ì—°ê²° resource \"aws_iam_role_policy_attachment\" \"eks_cluster_policy\" { policy_arn = \"arn:aws:iam::aws:policy/AmazonEKSClusterPolicy\" role = aws_iam_role.eks_cluster_role.name } 4-2. ë…¸ë“œ ê·¸ë£¹ ì—­í•  resource \"aws_iam_role\" \"eks_node_role\" { name = \"llm-project-eks-eks-node-role-v3\" assume_role_policy = jsonencode({ Version = \"2012-10-17\", Statement = [{ Effect = \"Allow\", Principal = { Service = \"ec2.amazonaws.com\" }, Action = \"sts:AssumeRole\" }] }) } # í•„ìˆ˜ ì •ì±… ì—°ê²° resource \"aws_iam_role_policy_attachment\" \"eks_worker_node_policy\" { policy_arn = \"arn:aws:iam::aws:policy/AmazonEKSWorkerNodePolicy\" role = aws_iam_role.eks_node_role.name } resource \"aws_iam_role_policy_attachment\" \"eks_cni_policy\" { policy_arn = \"arn:aws:iam::aws:policy/AmazonEKS_CNI_Policy\" role = aws_iam_role.eks_node_role.name } resource \"aws_iam_role_policy_attachment\" \"eks_container_registry_policy\" { policy_arn = \"arn:aws:iam::aws:policy/AmazonEC2ContainerRegistryReadOnly\" role = aws_iam_role.eks_node_role.name } # EBS CSI ë“œë¼ì´ë²„ ì •ì±… (ì˜êµ¬ ìŠ¤í† ë¦¬ì§€ìš©) resource \"aws_iam_role_policy_attachment\" \"ebs_csi_policy\" { policy_arn = \"arn:aws:iam::aws:policy/service-role/AmazonEBSCSIDriverPolicy\" role = aws_iam_role.eks_node_role.name } ğŸ” ì„¤ëª…:\nEKS í´ëŸ¬ìŠ¤í„°ì™€ ë…¸ë“œì— í•„ìš”í•œ ìµœì†Œ ê¶Œí•œë§Œ ë¶€ì—¬ EBS CSI ë“œë¼ì´ë²„ë¡œ ì˜êµ¬ ë³¼ë¥¨ ì‚¬ìš© ê°€ëŠ¥ âš™ï¸ Step 5: EKS í´ëŸ¬ìŠ¤í„° êµ¬ì„± 5-1. EKS í´ëŸ¬ìŠ¤í„° ìƒì„± resource \"aws_eks_cluster\" \"main\" { name = var.cluster_name role_arn = aws_iam_role.eks_cluster_role.arn vpc_config { subnet_ids = var.private_subnet_ids security_group_ids = [aws_security_group.eks_cluster_sg.id] endpoint_private_access = true endpoint_public_access = true } kubernetes_network_config { service_ipv4_cidr = \"172.20.0.0/16\" } depends_on = [aws_iam_role_policy_attachment.eks_cluster_policy] } ğŸ” ì„¤ëª…:\nPrivate/Public ì—”ë“œí¬ì¸íŠ¸ ëª¨ë‘ í™œì„±í™” ì„œë¹„ìŠ¤ ë„¤íŠ¸ì›Œí¬ëŠ” 172.20.0.0/16 ì‚¬ìš© (VPCì™€ ê²¹ì¹˜ì§€ ì•ŠìŒ) 5-2. ë…¸ë“œ ê·¸ë£¹ ìƒì„± resource \"aws_eks_node_group\" \"nodes\" { cluster_name = aws_eks_cluster.main.name node_group_name = \"${var.cluster_name}-nodes\" node_role_arn = aws_iam_role.eks_node_role.arn subnet_ids = var.private_subnet_ids instance_types = [var.instance_type] scaling_config { desired_size = var.node_group_desired_capacity min_size = var.node_group_min_capacity max_size = var.node_group_max_capacity } depends_on = [ aws_iam_role_policy_attachment.eks_worker_node_policy, aws_iam_role_policy_attachment.eks_cni_policy, aws_iam_role_policy_attachment.eks_container_registry_policy, aws_iam_role_policy_attachment.ebs_csi_policy ] } ğŸ” ì„¤ëª…:\nì˜¤í† ìŠ¤ì¼€ì¼ë§ ì„¤ì • (1~3ê°œ ë…¸ë“œ) t3.xlarge ì¸ìŠ¤í„´ìŠ¤ ì‚¬ìš© (4 vCPU, 16GB RAM) 5-3. EKS ì• ë“œì˜¨ ì„¤ì¹˜ resource \"aws_eks_addon\" \"ebs_csi_driver\" { cluster_name = aws_eks_cluster.main.name addon_name = \"aws-ebs-csi-driver\" depends_on = [ aws_eks_cluster.main, aws_iam_role_policy_attachment.ebs_csi_policy ] } ğŸ˜ Step 6: PostgreSQL ë°ì´í„°ë² ì´ìŠ¤ êµ¬ì„± 6-1. ì˜êµ¬ ë³¼ë¥¨ í´ë ˆì„ resource \"kubernetes_persistent_volume_claim\" \"postgres_pvc\" { provider = kubernetes.eks depends_on = [ aws_eks_node_group.nodes, aws_eks_addon.ebs_csi_driver ] metadata { name = \"postgres-pvc\" namespace = var.namespace } spec { access_modes = [\"ReadWriteOnce\"] resources { requests = { storage = \"5Gi\" } } storage_class_name = \"gp2-immediate\" } } 6-2. PostgreSQL ë°°í¬ resource \"kubernetes_deployment\" \"postgres_deployment\" { provider = kubernetes.eks depends_on = [ aws_eks_node_group.nodes, kubernetes_persistent_volume_claim.postgres_pvc ] metadata { name = \"postgres\" namespace = var.namespace labels = { app = \"postgres\" } } spec { replicas = 1 selector { match_labels = { app = \"postgres\" } } template { metadata { labels = { app = \"postgres\" } } spec { container { name = \"postgres\" image = \"postgres:13\" env { name = \"POSTGRES_DB\" value = var.postgres_db } env { name = \"POSTGRES_USER\" value = var.postgres_user } env { name = \"POSTGRES_PASSWORD\" value = var.postgres_password } env { name = \"PGDATA\" value = \"/var/lib/postgresql/data/pgdata\" } port { container_port = 5432 } volume_mount { mount_path = \"/var/lib/postgresql/data\" name = \"postgres-storage\" } } volume { name = \"postgres-storage\" persistent_volume_claim { claim_name = \"postgres-pvc\" } } } } } } 6-3. PostgreSQL ì„œë¹„ìŠ¤ resource \"kubernetes_service\" \"postgres_service\" { provider = kubernetes.eks depends_on = [aws_eks_node_group.nodes] metadata { name = \"postgres-service\" namespace = var.namespace } spec { selector = { app = \"postgres\" } port { port = 5432 target_port = 5432 } type = \"ClusterIP\" } } ğŸ” ì„¤ëª…:\n5GB EBS ë³¼ë¥¨ìœ¼ë¡œ ë°ì´í„° ì˜êµ¬ ì €ì¥ ClusterIPë¡œ ë‚´ë¶€ í†µì‹ ë§Œ í—ˆìš© PGDATA ê²½ë¡œë¥¼ ì„œë¸Œë””ë ‰í† ë¦¬ë¡œ ì„¤ì • (ê¶Œí•œ ë¬¸ì œ ë°©ì§€) ğŸ¤– Step 7: LiteLLM í”„ë¡ì‹œ êµ¬ì„± 7-1. LiteLLM ë°°í¬ resource \"kubernetes_deployment\" \"litellm_deployment\" { provider = kubernetes.eks depends_on = [aws_eks_node_group.nodes] metadata { name = \"litellm\" namespace = var.namespace labels = { app = \"litellm\" } } spec { replicas = 1 selector { match_labels = { app = \"litellm\" } } template { metadata { labels = { app = \"litellm\" } } spec { container { name = \"litellm\" image = \"ghcr.io/berriai/litellm:main\" # Azure OpenAI ì„¤ì • env { name = \"AZURE_API_KEY\" value = var.AZURE_API_KEY } env { name = \"AZURE_OPENAI_API_KEY\" value = var.AZURE_API_KEY } env { name = \"AZURE_API_BASE\" value = var.AZURE_API_BASE } env { name = \"AZURE_API_VERSION\" value = var.AZURE_API_VERSION } # Gemini API ì„¤ì • env { name = \"GEMINI_API_KEY\" value = var.GEMINI_API_KEY } # ë°ì´í„°ë² ì´ìŠ¤ ë° ì¸ì¦ env { name = \"DATABASE_URL\" value = var.database_url } env { name = \"LITELLM_MASTER_KEY\" value = var.litellm_master_key } env { name = \"LITELLM_SALT_KEY\" value = var.litellm_salt_key } port { container_port = var.litellm_api_port # 4000 } port { container_port = var.litellm_metrics_port # 8000 } } } } } } 7-2. LiteLLM ì„œë¹„ìŠ¤ (LoadBalancer) resource \"kubernetes_service\" \"litellm_service\" { provider = kubernetes.eks depends_on = [aws_eks_node_group.nodes] metadata { name = \"litellm-service\" namespace = var.namespace annotations = { \"service.beta.kubernetes.io/aws-load-balancer-type\" = \"nlb\" \"service.beta.kubernetes.io/aws-load-balancer-scheme\" = \"internet-facing\" } } spec { selector = { app = \"litellm\" } port { name = \"api\" protocol = \"TCP\" port = var.litellm_api_port target_port = var.litellm_api_port } port { name = \"metrics\" protocol = \"TCP\" port = var.litellm_metrics_port target_port = var.litellm_metrics_port } type = \"LoadBalancer\" } } ğŸ” ì„¤ëª…:\në©€í‹° LLM í”„ë¡ì‹œ (Azure OpenAI, Gemini ì§€ì›) NLB(Network Load Balancer) ì‚¬ìš©ìœ¼ë¡œ ë‚®ì€ ì§€ì—°ì‹œê°„ APIì™€ ë©”íŠ¸ë¦­ í¬íŠ¸ ë¶„ë¦¬ ğŸŒ Step 8: OpenWebUI êµ¬ì„± 8-1. OpenWebUI ë°°í¬ resource \"kubernetes_deployment\" \"openwebui_deployment\" { provider = kubernetes.eks depends_on = [aws_eks_node_group.nodes] metadata { name = \"openwebui\" namespace = var.namespace labels = { app = \"openwebui\" } } spec { replicas = 1 selector { match_labels = { app = \"openwebui\" } } template { metadata { labels = { app = \"openwebui\" } } spec { container { name = \"openwebui\" image = \"ghcr.io/open-webui/open-webui:main\" command = [\"uvicorn\", \"open_webui.main:app\", \"--host\", \"0.0.0.0\", \"--port\", \"3000\"] env { name = \"DATABASE_URL\" value = var.database_url } env { name = \"LITELLM_PROXY_BASE_URL\" value = \"http://litellm-service:${var.litellm_api_port}\" } port { container_port = var.openwebui_port # 3000 } } } } } } 8-2. OpenWebUI ì„œë¹„ìŠ¤ resource \"kubernetes_service\" \"openwebui_service\" { provider = kubernetes.eks depends_on = [aws_eks_node_group.nodes] metadata { name = \"openwebui-service\" namespace = var.namespace annotations = { \"service.beta.kubernetes.io/aws-load-balancer-type\" = \"classic\" \"service.beta.kubernetes.io/aws-load-balancer-scheme\" = \"internet-facing\" } } spec { selector = { app = \"openwebui\" } port { protocol = \"TCP\" port = var.openwebui_port target_port = var.openwebui_port } type = \"LoadBalancer\" } } ğŸ“Š Step 9: ëª¨ë‹ˆí„°ë§ ìŠ¤íƒ 9-1. Prometheus ë°°í¬ resource \"kubernetes_deployment\" \"prometheus_deployment\" { provider = kubernetes.eks depends_on = [aws_eks_node_group.nodes] metadata { name = \"prometheus\" namespace = var.namespace labels = { app = \"prometheus\" } } spec { replicas = 1 selector { match_labels = { app = \"prometheus\" } } template { metadata { labels = { app = \"prometheus\" } } spec { container { name = \"prometheus\" image = \"prom/prometheus:latest\" port { container_port = var.prometheus_port # 9090 } } } } } } 9-2. Grafana ë°°í¬ resource \"kubernetes_deployment\" \"grafana_deployment\" { provider = kubernetes.eks depends_on = [aws_eks_node_group.nodes] metadata { name = \"grafana\" namespace = var.namespace labels = { app = \"grafana\" } } spec { replicas = 1 selector { match_labels = { app = \"grafana\" } } template { metadata { labels = { app = \"grafana\" } } spec { container { name = \"grafana\" image = \"grafana/grafana:latest\" port { container_port = var.grafana_port # 3001 } } } } } } ğŸ“ Step 10: ë³€ìˆ˜ ì„¤ì • variables.tf (ì£¼ìš” ë³€ìˆ˜) variable \"aws_region\" { description = \"AWS region to deploy resources\" type = string default = \"ap-northeast-2\" } variable \"cluster_name\" { description = \"Name of the EKS cluster\" type = string default = \"llm-project-eks\" } variable \"instance_type\" { description = \"EC2 instance type for EKS worker nodes\" type = string default = \"t3.xlarge\" } variable \"node_group_desired_capacity\" { description = \"Desired number of worker nodes\" type = number default = 2 } # API í‚¤ ë³€ìˆ˜ë“¤ variable \"GEMINI_API_KEY\" { description = \"Gemini API key for LiteLLM\" type = string sensitive = true } variable \"AZURE_API_KEY\" { description = \"Azure OpenAI API key\" type = string sensitive = true } # ë°ì´í„°ë² ì´ìŠ¤ ë³€ìˆ˜ë“¤ variable \"postgres_user\" { description = \"PostgreSQL username\" type = string sensitive = true } variable \"postgres_password\" { description = \"PostgreSQL password\" type = string sensitive = true } terraform.tfvars.example # AWS ì„¤ì • aws_region = \"ap-northeast-2\" cluster_name = \"llm-project-eks\" # ë„¤íŠ¸ì›Œí¬ ì„¤ì • (ì‹¤ì œ ê°’ìœ¼ë¡œ ë³€ê²½ í•„ìš”) vpc_id = \"vpc-0f11e0b7cb225055a\" private_subnet_ids = [\"subnet-020d530cbcaed0656\", \"subnet-06bed7cfb33b120c1\"] # ë…¸ë“œ ê·¸ë£¹ ì„¤ì • instance_type = \"t3.medium\" node_group_desired_capacity = 2 node_group_min_capacity = 1 node_group_max_capacity = 3 # ì• í”Œë¦¬ì¼€ì´ì…˜ í¬íŠ¸ litellm_api_port = 4000 litellm_metrics_port = 8000 openwebui_port = 3000 prometheus_port = 9090 grafana_port = 3001 # ë¯¼ê°í•œ ì •ë³´ (ì‹¤ì œ ê°’ìœ¼ë¡œ ë³€ê²½ í•„ìˆ˜!) # ì´ ê°’ë“¤ì€ í™˜ê²½ ë³€ìˆ˜ë‚˜ CI/CD ì‹œí¬ë¦¿ìœ¼ë¡œ ê´€ë¦¬ litellm_master_key = \"\" litellm_salt_key = \"\" GEMINI_API_KEY = \"\" AZURE_API_KEY = \"\" AZURE_API_BASE = \"https://your-resource.openai.azure.com/\" AZURE_API_VERSION = \"2023-07-01-preview\" # PostgreSQL ì„¤ì • postgres_user = \"openwebui_user\" postgres_password = \"\" postgres_db = \"openwebui\" database_url = \"postgresql://openwebui_user:@postgres-service:5432/openwebui\" ğŸš€ ë°°í¬ ì‹¤í–‰ ê°€ì´ë“œ 1. ì‚¬ì „ ì¤€ë¹„ # AWS CLI í”„ë¡œíŒŒì¼ ì„¤ì • aws configure --profile llm # ì‘ì—… ë””ë ‰í† ë¦¬ ì´ë™ cd terraform-related/AWS_terraform_grafana 2. ë³€ìˆ˜ íŒŒì¼ ì¤€ë¹„ # ì˜ˆì‹œ íŒŒì¼ ë³µì‚¬ cp tfvars.example terraform.tfvars # ì‹¤ì œ ê°’ìœ¼ë¡œ ìˆ˜ì • vim terraform.tfvars 3. Terraform ì‹¤í–‰ # ì´ˆê¸°í™” terraform init # ê³„íš í™•ì¸ terraform plan # ë°°í¬ ì‹¤í–‰ terraform apply 4. kubectl ì„¤ì • # kubeconfig ì—…ë°ì´íŠ¸ aws eks update-kubeconfig --region ap-northeast-2 --name llm-project-eks --profile llm # í´ëŸ¬ìŠ¤í„° í™•ì¸ kubectl get nodes kubectl get pods -A 5. ì„œë¹„ìŠ¤ URL í™•ì¸ # LoadBalancer URL í™•ì¸ kubectl get svc -A | grep LoadBalancer # ê° ì„œë¹„ìŠ¤ë³„ ì—”ë“œí¬ì¸íŠ¸ echo \"OpenWebUI: http://$(kubectl get svc openwebui-service -o jsonpath='{.status.loadBalancer.ingress[0].hostname}'):3000\" echo \"Grafana: http://$(kubectl get svc grafana-service -o jsonpath='{.status.loadBalancer.ingress[0].hostname}'):3001\" echo \"Prometheus: http://$(kubectl get svc prometheus-service -o jsonpath='{.status.loadBalancer.ingress[0].hostname}'):9090\" ğŸ’° ë¹„ìš© ìµœì í™” íŒ ê°œë°œ í™˜ê²½ ì„¤ì • # terraform.tfvarsì—ì„œ ì¡°ì • instance_type = \"t3.small\" # ì‘ì€ ì¸ìŠ¤í„´ìŠ¤ ì‚¬ìš© node_group_desired_capacity = 1 # ìµœì†Œ ë…¸ë“œë¡œ ìš´ì˜ node_group_min_capacity = 0 # ì•¼ê°„ ìŠ¤ì¼€ì¼ë‹¤ìš´ ê°€ëŠ¥ ë¦¬ì†ŒìŠ¤ ì •ë¦¬ # ì „ì²´ ë¦¬ì†ŒìŠ¤ ì‚­ì œ terraform destroy # íŠ¹ì • ë¦¬ì†ŒìŠ¤ë§Œ ì‚­ì œ ",
  "wordCount" : "2101",
  "inLanguage": "en",
  "datePublished": "0001-01-01T00:00:00Z",
  "dateModified": "0001-01-01T00:00:00Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://8dobibim.github.io/backend/terraform-%EC%84%A4%EC%A0%95/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "8dobibim Tech Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://8dobibim.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://8dobibim.github.io/" accesskey="h" title="8dobibim Tech Blog (Alt + H)">8dobibim Tech Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://8dobibim.github.io/frontend/" title="ğŸ–¥ í”„ë¡ íŠ¸ì—”ë“œ">
                    <span>ğŸ–¥ í”„ë¡ íŠ¸ì—”ë“œ</span>
                </a>
            </li>
            <li>
                <a href="https://8dobibim.github.io/backend/" title="ğŸ’¾ ë°±ì—”ë“œ">
                    <span>ğŸ’¾ ë°±ì—”ë“œ</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://8dobibim.github.io/">Home</a>&nbsp;Â»&nbsp;<a href="https://8dobibim.github.io/backend/">Backend ë¬¸ì„œ</a></div>
    <h1 class="post-title entry-hint-parent">
      
    </h1>
    <div class="post-meta">10 min&nbsp;Â·&nbsp;2101 words

</div>
  </header> <div class="toc">
    <details  open>
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#-%ec%8b%a4%ec%a0%9c-%ed%94%84%eb%a1%9c%ec%a0%9d%ed%8a%b8-%ea%b8%b0%eb%b0%98-terraform-%ea%b5%ac%ec%84%b1-%ea%b0%80%ec%9d%b4%eb%93%9c" aria-label="ğŸ—ï¸ ì‹¤ì œ í”„ë¡œì íŠ¸ ê¸°ë°˜ Terraform êµ¬ì„± ê°€ì´ë“œ">ğŸ—ï¸ ì‹¤ì œ í”„ë¡œì íŠ¸ ê¸°ë°˜ Terraform êµ¬ì„± ê°€ì´ë“œ</a><ul>
                        
                <li>
                    <a href="#-%ed%94%84%eb%a1%9c%ec%a0%9d%ed%8a%b8-%ea%b5%ac%ec%a1%b0" aria-label="ğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡°">ğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡°</a></li>
                <li>
                    <a href="#-step-1-%ed%94%84%eb%a1%9c%eb%b0%94%ec%9d%b4%eb%8d%94-%eb%b0%8f-%eb%b2%84%ec%a0%84-%ec%84%a4%ec%a0%95" aria-label="ğŸ”§ Step 1: í”„ë¡œë°”ì´ë” ë° ë²„ì „ ì„¤ì •">ğŸ”§ Step 1: í”„ë¡œë°”ì´ë” ë° ë²„ì „ ì„¤ì •</a><ul>
                        
                <li>
                    <a href="#versionstf" aria-label="versions.tf">versions.tf</a></li></ul>
                </li>
                <li>
                    <a href="#-step-2-%eb%84%a4%ed%8a%b8%ec%9b%8c%ed%81%ac-%ec%9d%b8%ed%94%84%eb%9d%bc-%ea%b5%ac%ec%84%b1" aria-label="ğŸŒ Step 2: ë„¤íŠ¸ì›Œí¬ ì¸í”„ë¼ êµ¬ì„±">ğŸŒ Step 2: ë„¤íŠ¸ì›Œí¬ ì¸í”„ë¼ êµ¬ì„±</a><ul>
                        
                <li>
                    <a href="#2-1-%ed%94%84%eb%a1%9c%eb%b0%94%ec%9d%b4%eb%8d%94-%ec%84%a4%ec%a0%95" aria-label="2-1. í”„ë¡œë°”ì´ë” ì„¤ì •">2-1. í”„ë¡œë°”ì´ë” ì„¤ì •</a></li>
                <li>
                    <a href="#2-2-vpc-%ec%83%9d%ec%84%b1" aria-label="2-2. VPC ìƒì„±">2-2. VPC ìƒì„±</a></li>
                <li>
                    <a href="#2-3-%ec%84%9c%eb%b8%8c%eb%84%b7-%ea%b5%ac%ec%84%b1" aria-label="2-3. ì„œë¸Œë„· êµ¬ì„±">2-3. ì„œë¸Œë„· êµ¬ì„±</a></li>
                <li>
                    <a href="#2-4-%ec%9d%b8%ed%84%b0%eb%84%b7-%ec%97%b0%ea%b2%b0-%ec%84%a4%ec%a0%95" aria-label="2-4. ì¸í„°ë„· ì—°ê²° ì„¤ì •">2-4. ì¸í„°ë„· ì—°ê²° ì„¤ì •</a></li></ul>
                </li>
                <li>
                    <a href="#-step-3-%eb%b3%b4%ec%95%88-%ea%b7%b8%eb%a3%b9-%ec%84%a4%ec%a0%95" aria-label="ğŸ”’ Step 3: ë³´ì•ˆ ê·¸ë£¹ ì„¤ì •">ğŸ”’ Step 3: ë³´ì•ˆ ê·¸ë£¹ ì„¤ì •</a><ul>
                        
                <li>
                    <a href="#3-1-eks-%ed%81%b4%eb%9f%ac%ec%8a%a4%ed%84%b0-%eb%b3%b4%ec%95%88-%ea%b7%b8%eb%a3%b9" aria-label="3-1. EKS í´ëŸ¬ìŠ¤í„° ë³´ì•ˆ ê·¸ë£¹">3-1. EKS í´ëŸ¬ìŠ¤í„° ë³´ì•ˆ ê·¸ë£¹</a></li>
                <li>
                    <a href="#3-2-%ec%95%a0%ed%94%8c%eb%a6%ac%ec%bc%80%ec%9d%b4%ec%85%98%eb%b3%84-%ed%8f%ac%ed%8a%b8-%ea%b0%9c%eb%b0%a9" aria-label="3-2. ì• í”Œë¦¬ì¼€ì´ì…˜ë³„ í¬íŠ¸ ê°œë°©">3-2. ì• í”Œë¦¬ì¼€ì´ì…˜ë³„ í¬íŠ¸ ê°œë°©</a></li></ul>
                </li>
                <li>
                    <a href="#-step-4-iam-%ec%97%ad%ed%95%a0-%ec%84%a4%ec%a0%95" aria-label="ğŸ‘¤ Step 4: IAM ì—­í•  ì„¤ì •">ğŸ‘¤ Step 4: IAM ì—­í•  ì„¤ì •</a><ul>
                        
                <li>
                    <a href="#4-1-eks-%ed%81%b4%eb%9f%ac%ec%8a%a4%ed%84%b0-%ec%97%ad%ed%95%a0" aria-label="4-1. EKS í´ëŸ¬ìŠ¤í„° ì—­í• ">4-1. EKS í´ëŸ¬ìŠ¤í„° ì—­í• </a></li>
                <li>
                    <a href="#4-2-%eb%85%b8%eb%93%9c-%ea%b7%b8%eb%a3%b9-%ec%97%ad%ed%95%a0" aria-label="4-2. ë…¸ë“œ ê·¸ë£¹ ì—­í• ">4-2. ë…¸ë“œ ê·¸ë£¹ ì—­í• </a></li></ul>
                </li>
                <li>
                    <a href="#-step-5-eks-%ed%81%b4%eb%9f%ac%ec%8a%a4%ed%84%b0-%ea%b5%ac%ec%84%b1" aria-label="âš™ï¸ Step 5: EKS í´ëŸ¬ìŠ¤í„° êµ¬ì„±">âš™ï¸ Step 5: EKS í´ëŸ¬ìŠ¤í„° êµ¬ì„±</a><ul>
                        
                <li>
                    <a href="#5-1-eks-%ed%81%b4%eb%9f%ac%ec%8a%a4%ed%84%b0-%ec%83%9d%ec%84%b1" aria-label="5-1. EKS í´ëŸ¬ìŠ¤í„° ìƒì„±">5-1. EKS í´ëŸ¬ìŠ¤í„° ìƒì„±</a></li>
                <li>
                    <a href="#5-2-%eb%85%b8%eb%93%9c-%ea%b7%b8%eb%a3%b9-%ec%83%9d%ec%84%b1" aria-label="5-2. ë…¸ë“œ ê·¸ë£¹ ìƒì„±">5-2. ë…¸ë“œ ê·¸ë£¹ ìƒì„±</a></li>
                <li>
                    <a href="#5-3-eks-%ec%95%a0%eb%93%9c%ec%98%a8-%ec%84%a4%ec%b9%98" aria-label="5-3. EKS ì• ë“œì˜¨ ì„¤ì¹˜">5-3. EKS ì• ë“œì˜¨ ì„¤ì¹˜</a></li></ul>
                </li>
                <li>
                    <a href="#-step-6-postgresql-%eb%8d%b0%ec%9d%b4%ed%84%b0%eb%b2%a0%ec%9d%b4%ec%8a%a4-%ea%b5%ac%ec%84%b1" aria-label="ğŸ˜ Step 6: PostgreSQL ë°ì´í„°ë² ì´ìŠ¤ êµ¬ì„±">ğŸ˜ Step 6: PostgreSQL ë°ì´í„°ë² ì´ìŠ¤ êµ¬ì„±</a><ul>
                        
                <li>
                    <a href="#6-1-%ec%98%81%ea%b5%ac-%eb%b3%bc%eb%a5%a8-%ed%81%b4%eb%a0%88%ec%9e%84" aria-label="6-1. ì˜êµ¬ ë³¼ë¥¨ í´ë ˆì„">6-1. ì˜êµ¬ ë³¼ë¥¨ í´ë ˆì„</a></li>
                <li>
                    <a href="#6-2-postgresql-%eb%b0%b0%ed%8f%ac" aria-label="6-2. PostgreSQL ë°°í¬">6-2. PostgreSQL ë°°í¬</a></li>
                <li>
                    <a href="#6-3-postgresql-%ec%84%9c%eb%b9%84%ec%8a%a4" aria-label="6-3. PostgreSQL ì„œë¹„ìŠ¤">6-3. PostgreSQL ì„œë¹„ìŠ¤</a></li></ul>
                </li>
                <li>
                    <a href="#-step-7-litellm-%ed%94%84%eb%a1%9d%ec%8b%9c-%ea%b5%ac%ec%84%b1" aria-label="ğŸ¤– Step 7: LiteLLM í”„ë¡ì‹œ êµ¬ì„±">ğŸ¤– Step 7: LiteLLM í”„ë¡ì‹œ êµ¬ì„±</a><ul>
                        
                <li>
                    <a href="#7-1-litellm-%eb%b0%b0%ed%8f%ac" aria-label="7-1. LiteLLM ë°°í¬">7-1. LiteLLM ë°°í¬</a></li>
                <li>
                    <a href="#7-2-litellm-%ec%84%9c%eb%b9%84%ec%8a%a4-loadbalancer" aria-label="7-2. LiteLLM ì„œë¹„ìŠ¤ (LoadBalancer)">7-2. LiteLLM ì„œë¹„ìŠ¤ (LoadBalancer)</a></li></ul>
                </li>
                <li>
                    <a href="#-step-8-openwebui-%ea%b5%ac%ec%84%b1" aria-label="ğŸŒ Step 8: OpenWebUI êµ¬ì„±">ğŸŒ Step 8: OpenWebUI êµ¬ì„±</a><ul>
                        
                <li>
                    <a href="#8-1-openwebui-%eb%b0%b0%ed%8f%ac" aria-label="8-1. OpenWebUI ë°°í¬">8-1. OpenWebUI ë°°í¬</a></li>
                <li>
                    <a href="#8-2-openwebui-%ec%84%9c%eb%b9%84%ec%8a%a4" aria-label="8-2. OpenWebUI ì„œë¹„ìŠ¤">8-2. OpenWebUI ì„œë¹„ìŠ¤</a></li></ul>
                </li>
                <li>
                    <a href="#-step-9-%eb%aa%a8%eb%8b%88%ed%84%b0%eb%a7%81-%ec%8a%a4%ed%83%9d" aria-label="ğŸ“Š Step 9: ëª¨ë‹ˆí„°ë§ ìŠ¤íƒ">ğŸ“Š Step 9: ëª¨ë‹ˆí„°ë§ ìŠ¤íƒ</a><ul>
                        
                <li>
                    <a href="#9-1-prometheus-%eb%b0%b0%ed%8f%ac" aria-label="9-1. Prometheus ë°°í¬">9-1. Prometheus ë°°í¬</a></li>
                <li>
                    <a href="#9-2-grafana-%eb%b0%b0%ed%8f%ac" aria-label="9-2. Grafana ë°°í¬">9-2. Grafana ë°°í¬</a></li></ul>
                </li>
                <li>
                    <a href="#-step-10-%eb%b3%80%ec%88%98-%ec%84%a4%ec%a0%95" aria-label="ğŸ“ Step 10: ë³€ìˆ˜ ì„¤ì •">ğŸ“ Step 10: ë³€ìˆ˜ ì„¤ì •</a><ul>
                        
                <li>
                    <a href="#variablestf-%ec%a3%bc%ec%9a%94-%eb%b3%80%ec%88%98" aria-label="variables.tf (ì£¼ìš” ë³€ìˆ˜)">variables.tf (ì£¼ìš” ë³€ìˆ˜)</a></li>
                <li>
                    <a href="#terraformtfvarsexample" aria-label="terraform.tfvars.example">terraform.tfvars.example</a></li></ul>
                </li>
                <li>
                    <a href="#-%eb%b0%b0%ed%8f%ac-%ec%8b%a4%ed%96%89-%ea%b0%80%ec%9d%b4%eb%93%9c" aria-label="ğŸš€ ë°°í¬ ì‹¤í–‰ ê°€ì´ë“œ">ğŸš€ ë°°í¬ ì‹¤í–‰ ê°€ì´ë“œ</a><ul>
                        
                <li>
                    <a href="#1-%ec%82%ac%ec%a0%84-%ec%a4%80%eb%b9%84" aria-label="1. ì‚¬ì „ ì¤€ë¹„">1. ì‚¬ì „ ì¤€ë¹„</a></li>
                <li>
                    <a href="#2-%eb%b3%80%ec%88%98-%ed%8c%8c%ec%9d%bc-%ec%a4%80%eb%b9%84" aria-label="2. ë³€ìˆ˜ íŒŒì¼ ì¤€ë¹„">2. ë³€ìˆ˜ íŒŒì¼ ì¤€ë¹„</a></li>
                <li>
                    <a href="#3-terraform-%ec%8b%a4%ed%96%89" aria-label="3. Terraform ì‹¤í–‰">3. Terraform ì‹¤í–‰</a></li>
                <li>
                    <a href="#4-kubectl-%ec%84%a4%ec%a0%95" aria-label="4. kubectl ì„¤ì •">4. kubectl ì„¤ì •</a></li>
                <li>
                    <a href="#5-%ec%84%9c%eb%b9%84%ec%8a%a4-url-%ed%99%95%ec%9d%b8" aria-label="5. ì„œë¹„ìŠ¤ URL í™•ì¸">5. ì„œë¹„ìŠ¤ URL í™•ì¸</a></li></ul>
                </li>
                <li>
                    <a href="#-%eb%b9%84%ec%9a%a9-%ec%b5%9c%ec%a0%81%ed%99%94-%ed%8c%81" aria-label="ğŸ’° ë¹„ìš© ìµœì í™” íŒ">ğŸ’° ë¹„ìš© ìµœì í™” íŒ</a><ul>
                        
                <li>
                    <a href="#%ea%b0%9c%eb%b0%9c-%ed%99%98%ea%b2%bd-%ec%84%a4%ec%a0%95" aria-label="ê°œë°œ í™˜ê²½ ì„¤ì •">ê°œë°œ í™˜ê²½ ì„¤ì •</a></li>
                <li>
                    <a href="#%eb%a6%ac%ec%86%8c%ec%8a%a4-%ec%a0%95%eb%a6%ac" aria-label="ë¦¬ì†ŒìŠ¤ ì •ë¦¬">ë¦¬ì†ŒìŠ¤ ì •ë¦¬</a>
                </li>
            </ul>
            </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h1 id="-ì‹¤ì œ-í”„ë¡œì íŠ¸-ê¸°ë°˜-terraform-êµ¬ì„±-ê°€ì´ë“œ">ğŸ—ï¸ ì‹¤ì œ í”„ë¡œì íŠ¸ ê¸°ë°˜ Terraform êµ¬ì„± ê°€ì´ë“œ<a hidden class="anchor" aria-hidden="true" href="#-ì‹¤ì œ-í”„ë¡œì íŠ¸-ê¸°ë°˜-terraform-êµ¬ì„±-ê°€ì´ë“œ">#</a></h1>
<blockquote>
<p><strong>â±ï¸ ì˜ˆìƒ ì†Œìš”ì‹œê°„</strong>: 60-90ë¶„<br>
<strong>ğŸ’¡ ë‚œì´ë„</strong>: ì¤‘ê¸‰<br>
<strong>ğŸ“‹ ëª©í‘œ</strong>: Terraformì„ ì‚¬ìš©í•˜ì—¬ AWS EKS í´ëŸ¬ìŠ¤í„°ì™€ ì• í”Œë¦¬ì¼€ì´ì…˜ ìŠ¤íƒ êµ¬ì¶•<br>
<strong>ğŸ“ ì „ì²´ ì½”ë“œ</strong>: <a href="https://github.com/8dobibim/combined/tree/main/8dobibim_back/terraform-related/AWS_terraform_grafana">GitHubì—ì„œ í™•ì¸í•˜ê¸°</a></p></blockquote>
<hr>
<h2 id="-í”„ë¡œì íŠ¸-êµ¬ì¡°">ğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡°<a hidden class="anchor" aria-hidden="true" href="#-í”„ë¡œì íŠ¸-êµ¬ì¡°">#</a></h2>
<pre tabindex="0"><code>terraform-related/
â””â”€â”€ AWS_terraform_grafana/
    â”œâ”€â”€ main.tf           # ë©”ì¸ ë¦¬ì†ŒìŠ¤ ì •ì˜
    â”œâ”€â”€ variables.tf      # ë³€ìˆ˜ ì„ ì–¸
    â”œâ”€â”€ versions.tf       # í”„ë¡œë°”ì´ë” ë²„ì „
    â”œâ”€â”€ terraform.tfvars  # ë³€ìˆ˜ ê°’ (Git ì œì™¸)
    â””â”€â”€ tfvars.example    # ë³€ìˆ˜ ì˜ˆì‹œ íŒŒì¼
</code></pre><hr>
<h2 id="-step-1-í”„ë¡œë°”ì´ë”-ë°-ë²„ì „-ì„¤ì •">ğŸ”§ Step 1: í”„ë¡œë°”ì´ë” ë° ë²„ì „ ì„¤ì •<a hidden class="anchor" aria-hidden="true" href="#-step-1-í”„ë¡œë°”ì´ë”-ë°-ë²„ì „-ì„¤ì •">#</a></h2>
<h3 id="versionstf">versions.tf<a hidden class="anchor" aria-hidden="true" href="#versionstf">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-hcl" data-lang="hcl"><span style="display:flex;"><span><span style="color:#66d9ef">terraform</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">required_providers</span> {
</span></span><span style="display:flex;"><span>    kubernetes <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>      source  <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;hashicorp/kubernetes&#34;</span>
</span></span><span style="display:flex;"><span>      version <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;2.23.0&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    aws <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>      source  <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;hashicorp/aws&#34;</span>
</span></span><span style="display:flex;"><span>      version <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;5.45.0&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><strong>ğŸ” ì„¤ëª…</strong>:</p>
<ul>
<li>AWSì™€ Kubernetes í”„ë¡œë°”ì´ë” ì‚¬ìš©</li>
<li>ë²„ì „ì„ ê³ ì •í•˜ì—¬ ì¼ê´€ì„± ë³´ì¥</li>
</ul>
<hr>
<h2 id="-step-2-ë„¤íŠ¸ì›Œí¬-ì¸í”„ë¼-êµ¬ì„±">ğŸŒ Step 2: ë„¤íŠ¸ì›Œí¬ ì¸í”„ë¼ êµ¬ì„±<a hidden class="anchor" aria-hidden="true" href="#-step-2-ë„¤íŠ¸ì›Œí¬-ì¸í”„ë¼-êµ¬ì„±">#</a></h2>
<h3 id="2-1-í”„ë¡œë°”ì´ë”-ì„¤ì •">2-1. í”„ë¡œë°”ì´ë” ì„¤ì •<a hidden class="anchor" aria-hidden="true" href="#2-1-í”„ë¡œë°”ì´ë”-ì„¤ì •">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-hcl" data-lang="hcl"><span style="display:flex;"><span><span style="color:#66d9ef">provider</span> <span style="color:#e6db74">&#34;aws&#34;</span> {
</span></span><span style="display:flex;"><span>  region  <span style="color:#f92672">=</span> <span style="color:#66d9ef">var</span>.<span style="color:#66d9ef">aws_region</span>
</span></span><span style="display:flex;"><span>  profile <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;llm&#34;</span><span style="color:#75715e">  # AWS CLI í”„ë¡œíŒŒì¼ ì‚¬ìš©
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}<span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"># EKS ì¸ì¦ ì •ë³´
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">data</span> <span style="color:#e6db74">&#34;aws_eks_cluster_auth&#34; &#34;main&#34;</span> {
</span></span><span style="display:flex;"><span>  name <span style="color:#f92672">=</span> <span style="color:#66d9ef">aws_eks_cluster</span>.<span style="color:#66d9ef">main</span>.<span style="color:#66d9ef">name</span>
</span></span><span style="display:flex;"><span>}<span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"># Kubernetes í”„ë¡œë°”ì´ë” (EKS ì—°ë™)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">provider</span> <span style="color:#e6db74">&#34;kubernetes&#34;</span> {
</span></span><span style="display:flex;"><span>  alias                  <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;eks&#34;</span>
</span></span><span style="display:flex;"><span>  host                   <span style="color:#f92672">=</span> <span style="color:#66d9ef">aws_eks_cluster</span>.<span style="color:#66d9ef">main</span>.<span style="color:#66d9ef">endpoint</span>
</span></span><span style="display:flex;"><span>  cluster_ca_certificate <span style="color:#f92672">=</span> <span style="color:#66d9ef">base64decode</span>(<span style="color:#66d9ef">aws_eks_cluster</span>.<span style="color:#66d9ef">main</span>.<span style="color:#66d9ef">certificate_authority</span>[<span style="color:#ae81ff">0</span>].<span style="color:#66d9ef">data</span>)
</span></span><span style="display:flex;"><span>  token                  <span style="color:#f92672">=</span> <span style="color:#66d9ef">data</span>.<span style="color:#66d9ef">aws_eks_cluster_auth</span>.<span style="color:#66d9ef">main</span>.<span style="color:#66d9ef">token</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><strong>ğŸ” ì„¤ëª…</strong>:</p>
<ul>
<li><code>profile</code>: AWS CLIì— ì„¤ì •ëœ í”„ë¡œíŒŒì¼ ì‚¬ìš©</li>
<li>EKS í´ëŸ¬ìŠ¤í„° ìƒì„± í›„ ìë™ìœ¼ë¡œ ì¸ì¦ ì •ë³´ ê°€ì ¸ì˜´</li>
<li>Kubernetes í”„ë¡œë°”ì´ë”ëŠ” EKS ì—”ë“œí¬ì¸íŠ¸ì™€ ì—°ë™</li>
</ul>
<h3 id="2-2-vpc-ìƒì„±">2-2. VPC ìƒì„±<a hidden class="anchor" aria-hidden="true" href="#2-2-vpc-ìƒì„±">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-hcl" data-lang="hcl"><span style="display:flex;"><span><span style="color:#66d9ef">resource</span> <span style="color:#e6db74">&#34;aws_vpc&#34; &#34;main&#34;</span> {
</span></span><span style="display:flex;"><span>  cidr_block <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;10.38.0.0/16&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  tags <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>    Name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;llm-project-eks-vpc&#34;</span>
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><strong>ğŸ” ì„¤ëª…</strong>:</p>
<ul>
<li>ì „ìš© VPC ìƒì„± (10.38.0.0/16 ëŒ€ì—­)</li>
<li>ì¶©ë¶„í•œ IP ì£¼ì†Œ ê³µê°„ í™•ë³´ (65,536ê°œ)</li>
</ul>
<h3 id="2-3-ì„œë¸Œë„·-êµ¬ì„±">2-3. ì„œë¸Œë„· êµ¬ì„±<a hidden class="anchor" aria-hidden="true" href="#2-3-ì„œë¸Œë„·-êµ¬ì„±">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-hcl" data-lang="hcl"><span style="display:flex;"><span><span style="color:#75715e"># ì„œë¸Œë„· 1 (ê°€ìš©ì˜ì—­ 2b)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">resource</span> <span style="color:#e6db74">&#34;aws_subnet&#34; &#34;subnet_1&#34;</span> {
</span></span><span style="display:flex;"><span>  vpc_id                  <span style="color:#f92672">=</span> <span style="color:#66d9ef">aws_vpc</span>.<span style="color:#66d9ef">main</span>.<span style="color:#66d9ef">id</span>
</span></span><span style="display:flex;"><span>  cidr_block              <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;10.38.1.0/24&#34;</span>
</span></span><span style="display:flex;"><span>  availability_zone       <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;ap-northeast-2b&#34;</span>
</span></span><span style="display:flex;"><span>  map_public_ip_on_launch <span style="color:#f92672">=</span> <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  tags <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>    Name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;llm-subnet-1&#34;</span>
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}<span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"># ì„œë¸Œë„· 2 (ê°€ìš©ì˜ì—­ 2c)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">resource</span> <span style="color:#e6db74">&#34;aws_subnet&#34; &#34;subnet_2&#34;</span> {
</span></span><span style="display:flex;"><span>  vpc_id                  <span style="color:#f92672">=</span> <span style="color:#66d9ef">aws_vpc</span>.<span style="color:#66d9ef">main</span>.<span style="color:#66d9ef">id</span>
</span></span><span style="display:flex;"><span>  cidr_block              <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;10.38.2.0/24&#34;</span>
</span></span><span style="display:flex;"><span>  availability_zone       <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;ap-northeast-2c&#34;</span>
</span></span><span style="display:flex;"><span>  map_public_ip_on_launch <span style="color:#f92672">=</span> <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  tags <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>    Name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;llm-subnet-2&#34;</span>
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><strong>ğŸ” ì„¤ëª…</strong>:</p>
<ul>
<li>2ê°œì˜ ê°€ìš©ì˜ì—­ì— ì„œë¸Œë„· ë°°ì¹˜ (ê³ ê°€ìš©ì„±)</li>
<li>Public IP ìë™ í• ë‹¹ ì„¤ì •</li>
<li>ê° ì„œë¸Œë„·ì€ 256ê°œì˜ IP ì£¼ì†Œ ì œê³µ</li>
</ul>
<h3 id="2-4-ì¸í„°ë„·-ì—°ê²°-ì„¤ì •">2-4. ì¸í„°ë„· ì—°ê²° ì„¤ì •<a hidden class="anchor" aria-hidden="true" href="#2-4-ì¸í„°ë„·-ì—°ê²°-ì„¤ì •">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-hcl" data-lang="hcl"><span style="display:flex;"><span><span style="color:#75715e"># ì¸í„°ë„· ê²Œì´íŠ¸ì›¨ì´
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">resource</span> <span style="color:#e6db74">&#34;aws_internet_gateway&#34; &#34;main&#34;</span> {
</span></span><span style="display:flex;"><span>  vpc_id <span style="color:#f92672">=</span> <span style="color:#66d9ef">aws_vpc</span>.<span style="color:#66d9ef">main</span>.<span style="color:#66d9ef">id</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  tags <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>    Name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;llm-project-eks-igw&#34;</span>
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}<span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"># ë¼ìš°íŒ… í…Œì´ë¸”
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">resource</span> <span style="color:#e6db74">&#34;aws_route_table&#34; &#34;main&#34;</span> {
</span></span><span style="display:flex;"><span>  vpc_id <span style="color:#f92672">=</span> <span style="color:#66d9ef">aws_vpc</span>.<span style="color:#66d9ef">main</span>.<span style="color:#66d9ef">id</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">route</span> {
</span></span><span style="display:flex;"><span>    cidr_block <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;0.0.0.0/0&#34;</span>
</span></span><span style="display:flex;"><span>    gateway_id <span style="color:#f92672">=</span> <span style="color:#66d9ef">aws_internet_gateway</span>.<span style="color:#66d9ef">main</span>.<span style="color:#66d9ef">id</span>
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  tags <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>    Name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;llm-project-eks-rt&#34;</span>
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}<span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"># ì„œë¸Œë„·ê³¼ ë¼ìš°íŒ… í…Œì´ë¸” ì—°ê²°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">resource</span> <span style="color:#e6db74">&#34;aws_route_table_association&#34; &#34;subnet_1&#34;</span> {
</span></span><span style="display:flex;"><span>  subnet_id      <span style="color:#f92672">=</span> <span style="color:#66d9ef">aws_subnet</span>.<span style="color:#66d9ef">subnet_1</span>.<span style="color:#66d9ef">id</span>
</span></span><span style="display:flex;"><span>  route_table_id <span style="color:#f92672">=</span> <span style="color:#66d9ef">aws_route_table</span>.<span style="color:#66d9ef">main</span>.<span style="color:#66d9ef">id</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">resource</span> <span style="color:#e6db74">&#34;aws_route_table_association&#34; &#34;subnet_2&#34;</span> {
</span></span><span style="display:flex;"><span>  subnet_id      <span style="color:#f92672">=</span> <span style="color:#66d9ef">aws_subnet</span>.<span style="color:#66d9ef">subnet_2</span>.<span style="color:#66d9ef">id</span>
</span></span><span style="display:flex;"><span>  route_table_id <span style="color:#f92672">=</span> <span style="color:#66d9ef">aws_route_table</span>.<span style="color:#66d9ef">main</span>.<span style="color:#66d9ef">id</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><strong>ğŸ” ì„¤ëª…</strong>:</p>
<ul>
<li>ì¸í„°ë„· ê²Œì´íŠ¸ì›¨ì´ë¡œ ì™¸ë¶€ í†µì‹  í™œì„±í™”</li>
<li>ëª¨ë“  ì™¸ë¶€ íŠ¸ë˜í”½(0.0.0.0/0)ì„ IGWë¡œ ë¼ìš°íŒ…</li>
</ul>
<hr>
<h2 id="-step-3-ë³´ì•ˆ-ê·¸ë£¹-ì„¤ì •">ğŸ”’ Step 3: ë³´ì•ˆ ê·¸ë£¹ ì„¤ì •<a hidden class="anchor" aria-hidden="true" href="#-step-3-ë³´ì•ˆ-ê·¸ë£¹-ì„¤ì •">#</a></h2>
<h3 id="3-1-eks-í´ëŸ¬ìŠ¤í„°-ë³´ì•ˆ-ê·¸ë£¹">3-1. EKS í´ëŸ¬ìŠ¤í„° ë³´ì•ˆ ê·¸ë£¹<a hidden class="anchor" aria-hidden="true" href="#3-1-eks-í´ëŸ¬ìŠ¤í„°-ë³´ì•ˆ-ê·¸ë£¹">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-hcl" data-lang="hcl"><span style="display:flex;"><span><span style="color:#66d9ef">resource</span> <span style="color:#e6db74">&#34;aws_security_group&#34; &#34;eks_cluster_sg&#34;</span> {
</span></span><span style="display:flex;"><span>  name        <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;llm-project-eks-sg&#34;</span>
</span></span><span style="display:flex;"><span>  description <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Security group for EKS cluster&#34;</span>
</span></span><span style="display:flex;"><span>  vpc_id      <span style="color:#f92672">=</span> <span style="color:#66d9ef">aws_vpc</span>.<span style="color:#66d9ef">main</span>.<span style="color:#66d9ef">id</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">  # VPC ë‚´ë¶€ í†µì‹  í—ˆìš©
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">ingress</span> {
</span></span><span style="display:flex;"><span>    from_port   <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    to_port     <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    protocol    <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;-1&#34;</span>
</span></span><span style="display:flex;"><span>    cidr_blocks <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#34;10.38.0.0/16&#34;</span>]
</span></span><span style="display:flex;"><span>  }<span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">  # ëª¨ë“  ì•„ì›ƒë°”ìš´ë“œ í—ˆìš©
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">egress</span> {
</span></span><span style="display:flex;"><span>    from_port   <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    to_port     <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    protocol    <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;-1&#34;</span>
</span></span><span style="display:flex;"><span>    cidr_blocks <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#34;0.0.0.0/0&#34;</span>]
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="3-2-ì• í”Œë¦¬ì¼€ì´ì…˜ë³„-í¬íŠ¸-ê°œë°©">3-2. ì• í”Œë¦¬ì¼€ì´ì…˜ë³„ í¬íŠ¸ ê°œë°©<a hidden class="anchor" aria-hidden="true" href="#3-2-ì• í”Œë¦¬ì¼€ì´ì…˜ë³„-í¬íŠ¸-ê°œë°©">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-hcl" data-lang="hcl"><span style="display:flex;"><span><span style="color:#75715e"># Grafana í¬íŠ¸ (3000-3001)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">resource</span> <span style="color:#e6db74">&#34;aws_security_group_rule&#34; &#34;allow_openwebui_grafana&#34;</span> {
</span></span><span style="display:flex;"><span>  type              <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;ingress&#34;</span>
</span></span><span style="display:flex;"><span>  from_port         <span style="color:#f92672">=</span> <span style="color:#ae81ff">3000</span>
</span></span><span style="display:flex;"><span>  to_port           <span style="color:#f92672">=</span> <span style="color:#ae81ff">3001</span>
</span></span><span style="display:flex;"><span>  protocol          <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;tcp&#34;</span>
</span></span><span style="display:flex;"><span>  cidr_blocks       <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#34;0.0.0.0/0&#34;</span>]
</span></span><span style="display:flex;"><span>  security_group_id <span style="color:#f92672">=</span> <span style="color:#66d9ef">aws_security_group</span>.<span style="color:#66d9ef">eks_cluster_sg</span>.<span style="color:#66d9ef">id</span>
</span></span><span style="display:flex;"><span>}<span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"># Prometheus í¬íŠ¸ (9090)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">resource</span> <span style="color:#e6db74">&#34;aws_security_group_rule&#34; &#34;allow_prometheus&#34;</span> {
</span></span><span style="display:flex;"><span>  type              <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;ingress&#34;</span>
</span></span><span style="display:flex;"><span>  from_port         <span style="color:#f92672">=</span> <span style="color:#ae81ff">9090</span>
</span></span><span style="display:flex;"><span>  to_port           <span style="color:#f92672">=</span> <span style="color:#ae81ff">9090</span>
</span></span><span style="display:flex;"><span>  protocol          <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;tcp&#34;</span>
</span></span><span style="display:flex;"><span>  cidr_blocks       <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#34;0.0.0.0/0&#34;</span>]
</span></span><span style="display:flex;"><span>  security_group_id <span style="color:#f92672">=</span> <span style="color:#66d9ef">aws_security_group</span>.<span style="color:#66d9ef">eks_cluster_sg</span>.<span style="color:#66d9ef">id</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><strong>ğŸ” ì„¤ëª…</strong>:</p>
<ul>
<li>VPC ë‚´ë¶€ëŠ” ëª¨ë“  í¬íŠ¸ í†µì‹  í—ˆìš©</li>
<li>íŠ¹ì • ì„œë¹„ìŠ¤ í¬íŠ¸ë§Œ ì¸í„°ë„·ì—ì„œ ì ‘ê·¼ ê°€ëŠ¥</li>
</ul>
<hr>
<h2 id="-step-4-iam-ì—­í• -ì„¤ì •">ğŸ‘¤ Step 4: IAM ì—­í•  ì„¤ì •<a hidden class="anchor" aria-hidden="true" href="#-step-4-iam-ì—­í• -ì„¤ì •">#</a></h2>
<h3 id="4-1-eks-í´ëŸ¬ìŠ¤í„°-ì—­í• ">4-1. EKS í´ëŸ¬ìŠ¤í„° ì—­í• <a hidden class="anchor" aria-hidden="true" href="#4-1-eks-í´ëŸ¬ìŠ¤í„°-ì—­í• ">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-hcl" data-lang="hcl"><span style="display:flex;"><span><span style="color:#66d9ef">resource</span> <span style="color:#e6db74">&#34;aws_iam_role&#34; &#34;eks_cluster_role&#34;</span> {
</span></span><span style="display:flex;"><span>  name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;llm-project-eks-eks-cluster-role-v3&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  assume_role_policy <span style="color:#f92672">=</span> <span style="color:#66d9ef">jsonencode</span>({
</span></span><span style="display:flex;"><span>    Version <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;2012-10-17&#34;</span>,
</span></span><span style="display:flex;"><span>    Statement <span style="color:#f92672">=</span> [{
</span></span><span style="display:flex;"><span>      Effect    <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Allow&#34;</span>,
</span></span><span style="display:flex;"><span>      Principal <span style="color:#f92672">=</span> { Service <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;eks.amazonaws.com&#34;</span> },
</span></span><span style="display:flex;"><span>      Action    <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;sts:AssumeRole&#34;</span>
</span></span><span style="display:flex;"><span>    }]
</span></span><span style="display:flex;"><span>  })
</span></span><span style="display:flex;"><span>}<span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"># EKS í´ëŸ¬ìŠ¤í„° ì •ì±… ì—°ê²°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">resource</span> <span style="color:#e6db74">&#34;aws_iam_role_policy_attachment&#34; &#34;eks_cluster_policy&#34;</span> {
</span></span><span style="display:flex;"><span>  policy_arn <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;arn:aws:iam::aws:policy/AmazonEKSClusterPolicy&#34;</span>
</span></span><span style="display:flex;"><span>  role       <span style="color:#f92672">=</span> <span style="color:#66d9ef">aws_iam_role</span>.<span style="color:#66d9ef">eks_cluster_role</span>.<span style="color:#66d9ef">name</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="4-2-ë…¸ë“œ-ê·¸ë£¹-ì—­í• ">4-2. ë…¸ë“œ ê·¸ë£¹ ì—­í• <a hidden class="anchor" aria-hidden="true" href="#4-2-ë…¸ë“œ-ê·¸ë£¹-ì—­í• ">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-hcl" data-lang="hcl"><span style="display:flex;"><span><span style="color:#66d9ef">resource</span> <span style="color:#e6db74">&#34;aws_iam_role&#34; &#34;eks_node_role&#34;</span> {
</span></span><span style="display:flex;"><span>  name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;llm-project-eks-eks-node-role-v3&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  assume_role_policy <span style="color:#f92672">=</span> <span style="color:#66d9ef">jsonencode</span>({
</span></span><span style="display:flex;"><span>    Version <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;2012-10-17&#34;</span>,
</span></span><span style="display:flex;"><span>    Statement <span style="color:#f92672">=</span> [{
</span></span><span style="display:flex;"><span>      Effect    <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Allow&#34;</span>,
</span></span><span style="display:flex;"><span>      Principal <span style="color:#f92672">=</span> { Service <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;ec2.amazonaws.com&#34;</span> },
</span></span><span style="display:flex;"><span>      Action    <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;sts:AssumeRole&#34;</span>
</span></span><span style="display:flex;"><span>    }]
</span></span><span style="display:flex;"><span>  })
</span></span><span style="display:flex;"><span>}<span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"># í•„ìˆ˜ ì •ì±… ì—°ê²°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">resource</span> <span style="color:#e6db74">&#34;aws_iam_role_policy_attachment&#34; &#34;eks_worker_node_policy&#34;</span> {
</span></span><span style="display:flex;"><span>  policy_arn <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;arn:aws:iam::aws:policy/AmazonEKSWorkerNodePolicy&#34;</span>
</span></span><span style="display:flex;"><span>  role       <span style="color:#f92672">=</span> <span style="color:#66d9ef">aws_iam_role</span>.<span style="color:#66d9ef">eks_node_role</span>.<span style="color:#66d9ef">name</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">resource</span> <span style="color:#e6db74">&#34;aws_iam_role_policy_attachment&#34; &#34;eks_cni_policy&#34;</span> {
</span></span><span style="display:flex;"><span>  policy_arn <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;arn:aws:iam::aws:policy/AmazonEKS_CNI_Policy&#34;</span>
</span></span><span style="display:flex;"><span>  role       <span style="color:#f92672">=</span> <span style="color:#66d9ef">aws_iam_role</span>.<span style="color:#66d9ef">eks_node_role</span>.<span style="color:#66d9ef">name</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">resource</span> <span style="color:#e6db74">&#34;aws_iam_role_policy_attachment&#34; &#34;eks_container_registry_policy&#34;</span> {
</span></span><span style="display:flex;"><span>  policy_arn <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;arn:aws:iam::aws:policy/AmazonEC2ContainerRegistryReadOnly&#34;</span>
</span></span><span style="display:flex;"><span>  role       <span style="color:#f92672">=</span> <span style="color:#66d9ef">aws_iam_role</span>.<span style="color:#66d9ef">eks_node_role</span>.<span style="color:#66d9ef">name</span>
</span></span><span style="display:flex;"><span>}<span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"># EBS CSI ë“œë¼ì´ë²„ ì •ì±… (ì˜êµ¬ ìŠ¤í† ë¦¬ì§€ìš©)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">resource</span> <span style="color:#e6db74">&#34;aws_iam_role_policy_attachment&#34; &#34;ebs_csi_policy&#34;</span> {
</span></span><span style="display:flex;"><span>  policy_arn <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;arn:aws:iam::aws:policy/service-role/AmazonEBSCSIDriverPolicy&#34;</span>
</span></span><span style="display:flex;"><span>  role       <span style="color:#f92672">=</span> <span style="color:#66d9ef">aws_iam_role</span>.<span style="color:#66d9ef">eks_node_role</span>.<span style="color:#66d9ef">name</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><strong>ğŸ” ì„¤ëª…</strong>:</p>
<ul>
<li>EKS í´ëŸ¬ìŠ¤í„°ì™€ ë…¸ë“œì— í•„ìš”í•œ ìµœì†Œ ê¶Œí•œë§Œ ë¶€ì—¬</li>
<li>EBS CSI ë“œë¼ì´ë²„ë¡œ ì˜êµ¬ ë³¼ë¥¨ ì‚¬ìš© ê°€ëŠ¥</li>
</ul>
<hr>
<h2 id="-step-5-eks-í´ëŸ¬ìŠ¤í„°-êµ¬ì„±">âš™ï¸ Step 5: EKS í´ëŸ¬ìŠ¤í„° êµ¬ì„±<a hidden class="anchor" aria-hidden="true" href="#-step-5-eks-í´ëŸ¬ìŠ¤í„°-êµ¬ì„±">#</a></h2>
<h3 id="5-1-eks-í´ëŸ¬ìŠ¤í„°-ìƒì„±">5-1. EKS í´ëŸ¬ìŠ¤í„° ìƒì„±<a hidden class="anchor" aria-hidden="true" href="#5-1-eks-í´ëŸ¬ìŠ¤í„°-ìƒì„±">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-hcl" data-lang="hcl"><span style="display:flex;"><span><span style="color:#66d9ef">resource</span> <span style="color:#e6db74">&#34;aws_eks_cluster&#34; &#34;main&#34;</span> {
</span></span><span style="display:flex;"><span>  name     <span style="color:#f92672">=</span> <span style="color:#66d9ef">var</span>.<span style="color:#66d9ef">cluster_name</span>
</span></span><span style="display:flex;"><span>  role_arn <span style="color:#f92672">=</span> <span style="color:#66d9ef">aws_iam_role</span>.<span style="color:#66d9ef">eks_cluster_role</span>.<span style="color:#66d9ef">arn</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">vpc_config</span> {
</span></span><span style="display:flex;"><span>    subnet_ids              <span style="color:#f92672">=</span> <span style="color:#66d9ef">var</span>.<span style="color:#66d9ef">private_subnet_ids</span>
</span></span><span style="display:flex;"><span>    security_group_ids      <span style="color:#f92672">=</span> [<span style="color:#66d9ef">aws_security_group</span>.<span style="color:#66d9ef">eks_cluster_sg</span>.<span style="color:#66d9ef">id</span>]
</span></span><span style="display:flex;"><span>    endpoint_private_access <span style="color:#f92672">=</span> <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>    endpoint_public_access  <span style="color:#f92672">=</span> <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">kubernetes_network_config</span> {
</span></span><span style="display:flex;"><span>    service_ipv4_cidr <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;172.20.0.0/16&#34;</span>
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  depends_on <span style="color:#f92672">=</span> [<span style="color:#66d9ef">aws_iam_role_policy_attachment</span>.<span style="color:#66d9ef">eks_cluster_policy</span>]
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><strong>ğŸ” ì„¤ëª…</strong>:</p>
<ul>
<li>Private/Public ì—”ë“œí¬ì¸íŠ¸ ëª¨ë‘ í™œì„±í™”</li>
<li>ì„œë¹„ìŠ¤ ë„¤íŠ¸ì›Œí¬ëŠ” 172.20.0.0/16 ì‚¬ìš© (VPCì™€ ê²¹ì¹˜ì§€ ì•ŠìŒ)</li>
</ul>
<h3 id="5-2-ë…¸ë“œ-ê·¸ë£¹-ìƒì„±">5-2. ë…¸ë“œ ê·¸ë£¹ ìƒì„±<a hidden class="anchor" aria-hidden="true" href="#5-2-ë…¸ë“œ-ê·¸ë£¹-ìƒì„±">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-hcl" data-lang="hcl"><span style="display:flex;"><span><span style="color:#66d9ef">resource</span> <span style="color:#e6db74">&#34;aws_eks_node_group&#34; &#34;nodes&#34;</span> {
</span></span><span style="display:flex;"><span>  cluster_name    <span style="color:#f92672">=</span> <span style="color:#66d9ef">aws_eks_cluster</span>.<span style="color:#66d9ef">main</span>.<span style="color:#66d9ef">name</span>
</span></span><span style="display:flex;"><span>  node_group_name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;${var.cluster_name}-nodes&#34;</span>
</span></span><span style="display:flex;"><span>  node_role_arn   <span style="color:#f92672">=</span> <span style="color:#66d9ef">aws_iam_role</span>.<span style="color:#66d9ef">eks_node_role</span>.<span style="color:#66d9ef">arn</span>
</span></span><span style="display:flex;"><span>  subnet_ids      <span style="color:#f92672">=</span> <span style="color:#66d9ef">var</span>.<span style="color:#66d9ef">private_subnet_ids</span>
</span></span><span style="display:flex;"><span>  instance_types  <span style="color:#f92672">=</span> [<span style="color:#66d9ef">var</span>.<span style="color:#66d9ef">instance_type</span>]
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">scaling_config</span> {
</span></span><span style="display:flex;"><span>    desired_size <span style="color:#f92672">=</span> <span style="color:#66d9ef">var</span>.<span style="color:#66d9ef">node_group_desired_capacity</span>
</span></span><span style="display:flex;"><span>    min_size     <span style="color:#f92672">=</span> <span style="color:#66d9ef">var</span>.<span style="color:#66d9ef">node_group_min_capacity</span>
</span></span><span style="display:flex;"><span>    max_size     <span style="color:#f92672">=</span> <span style="color:#66d9ef">var</span>.<span style="color:#66d9ef">node_group_max_capacity</span>
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  depends_on <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">aws_iam_role_policy_attachment</span>.<span style="color:#66d9ef">eks_worker_node_policy</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">aws_iam_role_policy_attachment</span>.<span style="color:#66d9ef">eks_cni_policy</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">aws_iam_role_policy_attachment</span>.<span style="color:#66d9ef">eks_container_registry_policy</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">aws_iam_role_policy_attachment</span>.<span style="color:#66d9ef">ebs_csi_policy</span>
</span></span><span style="display:flex;"><span>  ]
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><strong>ğŸ” ì„¤ëª…</strong>:</p>
<ul>
<li>ì˜¤í† ìŠ¤ì¼€ì¼ë§ ì„¤ì • (1~3ê°œ ë…¸ë“œ)</li>
<li>t3.xlarge ì¸ìŠ¤í„´ìŠ¤ ì‚¬ìš© (4 vCPU, 16GB RAM)</li>
</ul>
<h3 id="5-3-eks-ì• ë“œì˜¨-ì„¤ì¹˜">5-3. EKS ì• ë“œì˜¨ ì„¤ì¹˜<a hidden class="anchor" aria-hidden="true" href="#5-3-eks-ì• ë“œì˜¨-ì„¤ì¹˜">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-hcl" data-lang="hcl"><span style="display:flex;"><span><span style="color:#66d9ef">resource</span> <span style="color:#e6db74">&#34;aws_eks_addon&#34; &#34;ebs_csi_driver&#34;</span> {
</span></span><span style="display:flex;"><span>  cluster_name <span style="color:#f92672">=</span> <span style="color:#66d9ef">aws_eks_cluster</span>.<span style="color:#66d9ef">main</span>.<span style="color:#66d9ef">name</span>
</span></span><span style="display:flex;"><span>  addon_name   <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;aws-ebs-csi-driver&#34;</span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  depends_on <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">aws_eks_cluster</span>.<span style="color:#66d9ef">main</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">aws_iam_role_policy_attachment</span>.<span style="color:#66d9ef">ebs_csi_policy</span>
</span></span><span style="display:flex;"><span>  ]
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><hr>
<h2 id="-step-6-postgresql-ë°ì´í„°ë² ì´ìŠ¤-êµ¬ì„±">ğŸ˜ Step 6: PostgreSQL ë°ì´í„°ë² ì´ìŠ¤ êµ¬ì„±<a hidden class="anchor" aria-hidden="true" href="#-step-6-postgresql-ë°ì´í„°ë² ì´ìŠ¤-êµ¬ì„±">#</a></h2>
<h3 id="6-1-ì˜êµ¬-ë³¼ë¥¨-í´ë ˆì„">6-1. ì˜êµ¬ ë³¼ë¥¨ í´ë ˆì„<a hidden class="anchor" aria-hidden="true" href="#6-1-ì˜êµ¬-ë³¼ë¥¨-í´ë ˆì„">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-hcl" data-lang="hcl"><span style="display:flex;"><span><span style="color:#66d9ef">resource</span> <span style="color:#e6db74">&#34;kubernetes_persistent_volume_claim&#34; &#34;postgres_pvc&#34;</span> {
</span></span><span style="display:flex;"><span>  provider   <span style="color:#f92672">=</span> <span style="color:#66d9ef">kubernetes</span>.<span style="color:#66d9ef">eks</span>
</span></span><span style="display:flex;"><span>  depends_on <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">aws_eks_node_group</span>.<span style="color:#66d9ef">nodes</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">aws_eks_addon</span>.<span style="color:#66d9ef">ebs_csi_driver</span>
</span></span><span style="display:flex;"><span>  ]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">metadata</span> {
</span></span><span style="display:flex;"><span>    name      <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;postgres-pvc&#34;</span>
</span></span><span style="display:flex;"><span>    namespace <span style="color:#f92672">=</span> <span style="color:#66d9ef">var</span>.<span style="color:#66d9ef">namespace</span>
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">spec</span> {
</span></span><span style="display:flex;"><span>    access_modes <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#34;ReadWriteOnce&#34;</span>]
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">resources</span> {
</span></span><span style="display:flex;"><span>      requests <span style="color:#f92672">=</span> { storage <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;5Gi&#34;</span> }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    storage_class_name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;gp2-immediate&#34;</span>
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="6-2-postgresql-ë°°í¬">6-2. PostgreSQL ë°°í¬<a hidden class="anchor" aria-hidden="true" href="#6-2-postgresql-ë°°í¬">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-hcl" data-lang="hcl"><span style="display:flex;"><span><span style="color:#66d9ef">resource</span> <span style="color:#e6db74">&#34;kubernetes_deployment&#34; &#34;postgres_deployment&#34;</span> {
</span></span><span style="display:flex;"><span>  provider   <span style="color:#f92672">=</span> <span style="color:#66d9ef">kubernetes</span>.<span style="color:#66d9ef">eks</span>
</span></span><span style="display:flex;"><span>  depends_on <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">aws_eks_node_group</span>.<span style="color:#66d9ef">nodes</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">kubernetes_persistent_volume_claim</span>.<span style="color:#66d9ef">postgres_pvc</span>
</span></span><span style="display:flex;"><span>  ]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">metadata</span> {
</span></span><span style="display:flex;"><span>    name      <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;postgres&#34;</span>
</span></span><span style="display:flex;"><span>    namespace <span style="color:#f92672">=</span> <span style="color:#66d9ef">var</span>.<span style="color:#66d9ef">namespace</span>
</span></span><span style="display:flex;"><span>    labels <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>      app <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;postgres&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">spec</span> {
</span></span><span style="display:flex;"><span>    replicas <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">selector</span> {
</span></span><span style="display:flex;"><span>      match_labels <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>        app <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;postgres&#34;</span>
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">template</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">metadata</span> {
</span></span><span style="display:flex;"><span>        labels <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>          app <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;postgres&#34;</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">spec</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">container</span> {
</span></span><span style="display:flex;"><span>          name  <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;postgres&#34;</span>
</span></span><span style="display:flex;"><span>          image <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;postgres:13&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">env</span> {
</span></span><span style="display:flex;"><span>            name  <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;POSTGRES_DB&#34;</span>
</span></span><span style="display:flex;"><span>            value <span style="color:#f92672">=</span> <span style="color:#66d9ef">var</span>.<span style="color:#66d9ef">postgres_db</span>
</span></span><span style="display:flex;"><span>          }
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">env</span> {
</span></span><span style="display:flex;"><span>            name  <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;POSTGRES_USER&#34;</span>
</span></span><span style="display:flex;"><span>            value <span style="color:#f92672">=</span> <span style="color:#66d9ef">var</span>.<span style="color:#66d9ef">postgres_user</span>
</span></span><span style="display:flex;"><span>          }
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">env</span> {
</span></span><span style="display:flex;"><span>            name  <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;POSTGRES_PASSWORD&#34;</span>
</span></span><span style="display:flex;"><span>            value <span style="color:#f92672">=</span> <span style="color:#66d9ef">var</span>.<span style="color:#66d9ef">postgres_password</span>
</span></span><span style="display:flex;"><span>          }
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">env</span> {
</span></span><span style="display:flex;"><span>            name  <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;PGDATA&#34;</span>
</span></span><span style="display:flex;"><span>            value <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;/var/lib/postgresql/data/pgdata&#34;</span>
</span></span><span style="display:flex;"><span>          }
</span></span><span style="display:flex;"><span>          
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">port</span> {
</span></span><span style="display:flex;"><span>            container_port <span style="color:#f92672">=</span> <span style="color:#ae81ff">5432</span>
</span></span><span style="display:flex;"><span>          }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">volume_mount</span> {
</span></span><span style="display:flex;"><span>            mount_path <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;/var/lib/postgresql/data&#34;</span>
</span></span><span style="display:flex;"><span>            name       <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;postgres-storage&#34;</span>
</span></span><span style="display:flex;"><span>          }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">volume</span> {
</span></span><span style="display:flex;"><span>          name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;postgres-storage&#34;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">persistent_volume_claim</span> {
</span></span><span style="display:flex;"><span>            claim_name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;postgres-pvc&#34;</span>
</span></span><span style="display:flex;"><span>          }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="6-3-postgresql-ì„œë¹„ìŠ¤">6-3. PostgreSQL ì„œë¹„ìŠ¤<a hidden class="anchor" aria-hidden="true" href="#6-3-postgresql-ì„œë¹„ìŠ¤">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-hcl" data-lang="hcl"><span style="display:flex;"><span><span style="color:#66d9ef">resource</span> <span style="color:#e6db74">&#34;kubernetes_service&#34; &#34;postgres_service&#34;</span> {
</span></span><span style="display:flex;"><span>  provider   <span style="color:#f92672">=</span> <span style="color:#66d9ef">kubernetes</span>.<span style="color:#66d9ef">eks</span>
</span></span><span style="display:flex;"><span>  depends_on <span style="color:#f92672">=</span> [<span style="color:#66d9ef">aws_eks_node_group</span>.<span style="color:#66d9ef">nodes</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">metadata</span> {
</span></span><span style="display:flex;"><span>    name      <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;postgres-service&#34;</span>
</span></span><span style="display:flex;"><span>    namespace <span style="color:#f92672">=</span> <span style="color:#66d9ef">var</span>.<span style="color:#66d9ef">namespace</span>
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">spec</span> {
</span></span><span style="display:flex;"><span>    selector <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>      app <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;postgres&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">port</span> {
</span></span><span style="display:flex;"><span>      port        <span style="color:#f92672">=</span> <span style="color:#ae81ff">5432</span>
</span></span><span style="display:flex;"><span>      target_port <span style="color:#f92672">=</span> <span style="color:#ae81ff">5432</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    type <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;ClusterIP&#34;</span>
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><strong>ğŸ” ì„¤ëª…</strong>:</p>
<ul>
<li>5GB EBS ë³¼ë¥¨ìœ¼ë¡œ ë°ì´í„° ì˜êµ¬ ì €ì¥</li>
<li>ClusterIPë¡œ ë‚´ë¶€ í†µì‹ ë§Œ í—ˆìš©</li>
<li>PGDATA ê²½ë¡œë¥¼ ì„œë¸Œë””ë ‰í† ë¦¬ë¡œ ì„¤ì • (ê¶Œí•œ ë¬¸ì œ ë°©ì§€)</li>
</ul>
<hr>
<h2 id="-step-7-litellm-í”„ë¡ì‹œ-êµ¬ì„±">ğŸ¤– Step 7: LiteLLM í”„ë¡ì‹œ êµ¬ì„±<a hidden class="anchor" aria-hidden="true" href="#-step-7-litellm-í”„ë¡ì‹œ-êµ¬ì„±">#</a></h2>
<h3 id="7-1-litellm-ë°°í¬">7-1. LiteLLM ë°°í¬<a hidden class="anchor" aria-hidden="true" href="#7-1-litellm-ë°°í¬">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-hcl" data-lang="hcl"><span style="display:flex;"><span><span style="color:#66d9ef">resource</span> <span style="color:#e6db74">&#34;kubernetes_deployment&#34; &#34;litellm_deployment&#34;</span> {
</span></span><span style="display:flex;"><span>  provider   <span style="color:#f92672">=</span> <span style="color:#66d9ef">kubernetes</span>.<span style="color:#66d9ef">eks</span>
</span></span><span style="display:flex;"><span>  depends_on <span style="color:#f92672">=</span> [<span style="color:#66d9ef">aws_eks_node_group</span>.<span style="color:#66d9ef">nodes</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">metadata</span> {
</span></span><span style="display:flex;"><span>    name      <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;litellm&#34;</span>
</span></span><span style="display:flex;"><span>    namespace <span style="color:#f92672">=</span> <span style="color:#66d9ef">var</span>.<span style="color:#66d9ef">namespace</span>
</span></span><span style="display:flex;"><span>    labels <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>      app <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;litellm&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">spec</span> {
</span></span><span style="display:flex;"><span>    replicas <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">selector</span> {
</span></span><span style="display:flex;"><span>      match_labels <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>        app <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;litellm&#34;</span>
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">template</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">metadata</span> {
</span></span><span style="display:flex;"><span>        labels <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>          app <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;litellm&#34;</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>      
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">spec</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">container</span> {
</span></span><span style="display:flex;"><span>          name  <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;litellm&#34;</span>
</span></span><span style="display:flex;"><span>          image <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;ghcr.io/berriai/litellm:main&#34;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">          
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">          # Azure OpenAI ì„¤ì •
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>          <span style="color:#66d9ef">env</span> {
</span></span><span style="display:flex;"><span>            name  <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;AZURE_API_KEY&#34;</span>
</span></span><span style="display:flex;"><span>            value <span style="color:#f92672">=</span> <span style="color:#66d9ef">var</span>.<span style="color:#66d9ef">AZURE_API_KEY</span>
</span></span><span style="display:flex;"><span>          }
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">env</span> {
</span></span><span style="display:flex;"><span>            name  <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;AZURE_OPENAI_API_KEY&#34;</span>
</span></span><span style="display:flex;"><span>            value <span style="color:#f92672">=</span> <span style="color:#66d9ef">var</span>.<span style="color:#66d9ef">AZURE_API_KEY</span>
</span></span><span style="display:flex;"><span>          }
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">env</span> {
</span></span><span style="display:flex;"><span>            name  <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;AZURE_API_BASE&#34;</span>
</span></span><span style="display:flex;"><span>            value <span style="color:#f92672">=</span> <span style="color:#66d9ef">var</span>.<span style="color:#66d9ef">AZURE_API_BASE</span>
</span></span><span style="display:flex;"><span>          }
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">env</span> {
</span></span><span style="display:flex;"><span>            name  <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;AZURE_API_VERSION&#34;</span>
</span></span><span style="display:flex;"><span>            value <span style="color:#f92672">=</span> <span style="color:#66d9ef">var</span>.<span style="color:#66d9ef">AZURE_API_VERSION</span>
</span></span><span style="display:flex;"><span>          }<span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">          
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">          # Gemini API ì„¤ì •
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>          <span style="color:#66d9ef">env</span> {
</span></span><span style="display:flex;"><span>            name  <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;GEMINI_API_KEY&#34;</span>
</span></span><span style="display:flex;"><span>            value <span style="color:#f92672">=</span> <span style="color:#66d9ef">var</span>.<span style="color:#66d9ef">GEMINI_API_KEY</span>
</span></span><span style="display:flex;"><span>          }<span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">          
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">          # ë°ì´í„°ë² ì´ìŠ¤ ë° ì¸ì¦
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>          <span style="color:#66d9ef">env</span> {
</span></span><span style="display:flex;"><span>            name  <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;DATABASE_URL&#34;</span>
</span></span><span style="display:flex;"><span>            value <span style="color:#f92672">=</span> <span style="color:#66d9ef">var</span>.<span style="color:#66d9ef">database_url</span>
</span></span><span style="display:flex;"><span>          }
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">env</span> {
</span></span><span style="display:flex;"><span>            name  <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;LITELLM_MASTER_KEY&#34;</span>
</span></span><span style="display:flex;"><span>            value <span style="color:#f92672">=</span> <span style="color:#66d9ef">var</span>.<span style="color:#66d9ef">litellm_master_key</span>
</span></span><span style="display:flex;"><span>          }
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">env</span> {
</span></span><span style="display:flex;"><span>            name  <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;LITELLM_SALT_KEY&#34;</span>
</span></span><span style="display:flex;"><span>            value <span style="color:#f92672">=</span> <span style="color:#66d9ef">var</span>.<span style="color:#66d9ef">litellm_salt_key</span>
</span></span><span style="display:flex;"><span>          }
</span></span><span style="display:flex;"><span>          
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">port</span> {
</span></span><span style="display:flex;"><span>            container_port <span style="color:#f92672">=</span> <span style="color:#66d9ef">var</span>.<span style="color:#66d9ef">litellm_api_port</span><span style="color:#75715e">      # 4000
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>          }
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">port</span> {
</span></span><span style="display:flex;"><span>            container_port <span style="color:#f92672">=</span> <span style="color:#66d9ef">var</span>.<span style="color:#66d9ef">litellm_metrics_port</span><span style="color:#75715e">  # 8000
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>          }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="7-2-litellm-ì„œë¹„ìŠ¤-loadbalancer">7-2. LiteLLM ì„œë¹„ìŠ¤ (LoadBalancer)<a hidden class="anchor" aria-hidden="true" href="#7-2-litellm-ì„œë¹„ìŠ¤-loadbalancer">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-hcl" data-lang="hcl"><span style="display:flex;"><span><span style="color:#66d9ef">resource</span> <span style="color:#e6db74">&#34;kubernetes_service&#34; &#34;litellm_service&#34;</span> {
</span></span><span style="display:flex;"><span>  provider   <span style="color:#f92672">=</span> <span style="color:#66d9ef">kubernetes</span>.<span style="color:#66d9ef">eks</span>
</span></span><span style="display:flex;"><span>  depends_on <span style="color:#f92672">=</span> [<span style="color:#66d9ef">aws_eks_node_group</span>.<span style="color:#66d9ef">nodes</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">metadata</span> {
</span></span><span style="display:flex;"><span>    name      <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;litellm-service&#34;</span>
</span></span><span style="display:flex;"><span>    namespace <span style="color:#f92672">=</span> <span style="color:#66d9ef">var</span>.<span style="color:#66d9ef">namespace</span>
</span></span><span style="display:flex;"><span>    annotations <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>      &#34;service.beta.kubernetes.io/aws-load-balancer-type&#34;   <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;nlb&#34;</span>
</span></span><span style="display:flex;"><span>      &#34;service.beta.kubernetes.io/aws-load-balancer-scheme&#34; <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;internet-facing&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">spec</span> {
</span></span><span style="display:flex;"><span>    selector <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>      app <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;litellm&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">port</span> {
</span></span><span style="display:flex;"><span>      name        <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;api&#34;</span>
</span></span><span style="display:flex;"><span>      protocol    <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;TCP&#34;</span>
</span></span><span style="display:flex;"><span>      port        <span style="color:#f92672">=</span> <span style="color:#66d9ef">var</span>.<span style="color:#66d9ef">litellm_api_port</span>
</span></span><span style="display:flex;"><span>      target_port <span style="color:#f92672">=</span> <span style="color:#66d9ef">var</span>.<span style="color:#66d9ef">litellm_api_port</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">port</span> {
</span></span><span style="display:flex;"><span>      name        <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;metrics&#34;</span>
</span></span><span style="display:flex;"><span>      protocol    <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;TCP&#34;</span>
</span></span><span style="display:flex;"><span>      port        <span style="color:#f92672">=</span> <span style="color:#66d9ef">var</span>.<span style="color:#66d9ef">litellm_metrics_port</span>
</span></span><span style="display:flex;"><span>      target_port <span style="color:#f92672">=</span> <span style="color:#66d9ef">var</span>.<span style="color:#66d9ef">litellm_metrics_port</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    type <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;LoadBalancer&#34;</span>
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><strong>ğŸ” ì„¤ëª…</strong>:</p>
<ul>
<li>ë©€í‹° LLM í”„ë¡ì‹œ (Azure OpenAI, Gemini ì§€ì›)</li>
<li>NLB(Network Load Balancer) ì‚¬ìš©ìœ¼ë¡œ ë‚®ì€ ì§€ì—°ì‹œê°„</li>
<li>APIì™€ ë©”íŠ¸ë¦­ í¬íŠ¸ ë¶„ë¦¬</li>
</ul>
<hr>
<h2 id="-step-8-openwebui-êµ¬ì„±">ğŸŒ Step 8: OpenWebUI êµ¬ì„±<a hidden class="anchor" aria-hidden="true" href="#-step-8-openwebui-êµ¬ì„±">#</a></h2>
<h3 id="8-1-openwebui-ë°°í¬">8-1. OpenWebUI ë°°í¬<a hidden class="anchor" aria-hidden="true" href="#8-1-openwebui-ë°°í¬">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-hcl" data-lang="hcl"><span style="display:flex;"><span><span style="color:#66d9ef">resource</span> <span style="color:#e6db74">&#34;kubernetes_deployment&#34; &#34;openwebui_deployment&#34;</span> {
</span></span><span style="display:flex;"><span>  provider   <span style="color:#f92672">=</span> <span style="color:#66d9ef">kubernetes</span>.<span style="color:#66d9ef">eks</span>
</span></span><span style="display:flex;"><span>  depends_on <span style="color:#f92672">=</span> [<span style="color:#66d9ef">aws_eks_node_group</span>.<span style="color:#66d9ef">nodes</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">metadata</span> {
</span></span><span style="display:flex;"><span>    name      <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;openwebui&#34;</span>
</span></span><span style="display:flex;"><span>    namespace <span style="color:#f92672">=</span> <span style="color:#66d9ef">var</span>.<span style="color:#66d9ef">namespace</span>
</span></span><span style="display:flex;"><span>    labels <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>      app <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;openwebui&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">spec</span> {
</span></span><span style="display:flex;"><span>    replicas <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">selector</span> {
</span></span><span style="display:flex;"><span>      match_labels <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>        app <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;openwebui&#34;</span>
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">template</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">metadata</span> {
</span></span><span style="display:flex;"><span>        labels <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>          app <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;openwebui&#34;</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>      
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">spec</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">container</span> {
</span></span><span style="display:flex;"><span>          name  <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;openwebui&#34;</span>
</span></span><span style="display:flex;"><span>          image <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;ghcr.io/open-webui/open-webui:main&#34;</span>
</span></span><span style="display:flex;"><span>          command <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#34;uvicorn&#34;, &#34;open_webui.main:app&#34;, &#34;--host&#34;, &#34;0.0.0.0&#34;, &#34;--port&#34;, &#34;3000&#34;</span>]
</span></span><span style="display:flex;"><span>          
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">env</span> {
</span></span><span style="display:flex;"><span>            name  <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;DATABASE_URL&#34;</span>
</span></span><span style="display:flex;"><span>            value <span style="color:#f92672">=</span> <span style="color:#66d9ef">var</span>.<span style="color:#66d9ef">database_url</span>
</span></span><span style="display:flex;"><span>          }
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">env</span> {
</span></span><span style="display:flex;"><span>            name  <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;LITELLM_PROXY_BASE_URL&#34;</span>
</span></span><span style="display:flex;"><span>            value <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;http://litellm-service:${var.litellm_api_port}&#34;</span>
</span></span><span style="display:flex;"><span>          }
</span></span><span style="display:flex;"><span>          
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">port</span> {
</span></span><span style="display:flex;"><span>            container_port <span style="color:#f92672">=</span> <span style="color:#66d9ef">var</span>.<span style="color:#66d9ef">openwebui_port</span><span style="color:#75715e">  # 3000
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>          }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="8-2-openwebui-ì„œë¹„ìŠ¤">8-2. OpenWebUI ì„œë¹„ìŠ¤<a hidden class="anchor" aria-hidden="true" href="#8-2-openwebui-ì„œë¹„ìŠ¤">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-hcl" data-lang="hcl"><span style="display:flex;"><span><span style="color:#66d9ef">resource</span> <span style="color:#e6db74">&#34;kubernetes_service&#34; &#34;openwebui_service&#34;</span> {
</span></span><span style="display:flex;"><span>  provider <span style="color:#f92672">=</span> <span style="color:#66d9ef">kubernetes</span>.<span style="color:#66d9ef">eks</span>
</span></span><span style="display:flex;"><span>  depends_on <span style="color:#f92672">=</span> [<span style="color:#66d9ef">aws_eks_node_group</span>.<span style="color:#66d9ef">nodes</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">metadata</span> {
</span></span><span style="display:flex;"><span>    name      <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;openwebui-service&#34;</span>
</span></span><span style="display:flex;"><span>    namespace <span style="color:#f92672">=</span> <span style="color:#66d9ef">var</span>.<span style="color:#66d9ef">namespace</span>
</span></span><span style="display:flex;"><span>    annotations <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>      &#34;service.beta.kubernetes.io/aws-load-balancer-type&#34;   <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;classic&#34;</span>
</span></span><span style="display:flex;"><span>      &#34;service.beta.kubernetes.io/aws-load-balancer-scheme&#34; <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;internet-facing&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">spec</span> {
</span></span><span style="display:flex;"><span>    selector <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>      app <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;openwebui&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">port</span> {
</span></span><span style="display:flex;"><span>      protocol    <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;TCP&#34;</span>
</span></span><span style="display:flex;"><span>      port        <span style="color:#f92672">=</span> <span style="color:#66d9ef">var</span>.<span style="color:#66d9ef">openwebui_port</span>
</span></span><span style="display:flex;"><span>      target_port <span style="color:#f92672">=</span> <span style="color:#66d9ef">var</span>.<span style="color:#66d9ef">openwebui_port</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    type <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;LoadBalancer&#34;</span>
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><hr>
<h2 id="-step-9-ëª¨ë‹ˆí„°ë§-ìŠ¤íƒ">ğŸ“Š Step 9: ëª¨ë‹ˆí„°ë§ ìŠ¤íƒ<a hidden class="anchor" aria-hidden="true" href="#-step-9-ëª¨ë‹ˆí„°ë§-ìŠ¤íƒ">#</a></h2>
<h3 id="9-1-prometheus-ë°°í¬">9-1. Prometheus ë°°í¬<a hidden class="anchor" aria-hidden="true" href="#9-1-prometheus-ë°°í¬">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-hcl" data-lang="hcl"><span style="display:flex;"><span><span style="color:#66d9ef">resource</span> <span style="color:#e6db74">&#34;kubernetes_deployment&#34; &#34;prometheus_deployment&#34;</span> {
</span></span><span style="display:flex;"><span>  provider   <span style="color:#f92672">=</span> <span style="color:#66d9ef">kubernetes</span>.<span style="color:#66d9ef">eks</span>
</span></span><span style="display:flex;"><span>  depends_on <span style="color:#f92672">=</span> [<span style="color:#66d9ef">aws_eks_node_group</span>.<span style="color:#66d9ef">nodes</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">metadata</span> {
</span></span><span style="display:flex;"><span>    name      <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;prometheus&#34;</span>
</span></span><span style="display:flex;"><span>    namespace <span style="color:#f92672">=</span> <span style="color:#66d9ef">var</span>.<span style="color:#66d9ef">namespace</span>
</span></span><span style="display:flex;"><span>    labels <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>      app <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;prometheus&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">spec</span> {
</span></span><span style="display:flex;"><span>    replicas <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">selector</span> {
</span></span><span style="display:flex;"><span>      match_labels <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>        app <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;prometheus&#34;</span>
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">template</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">metadata</span> {
</span></span><span style="display:flex;"><span>        labels <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>          app <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;prometheus&#34;</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>      
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">spec</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">container</span> {
</span></span><span style="display:flex;"><span>          name  <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;prometheus&#34;</span>
</span></span><span style="display:flex;"><span>          image <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;prom/prometheus:latest&#34;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">port</span> {
</span></span><span style="display:flex;"><span>            container_port <span style="color:#f92672">=</span> <span style="color:#66d9ef">var</span>.<span style="color:#66d9ef">prometheus_port</span><span style="color:#75715e">  # 9090
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>          }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="9-2-grafana-ë°°í¬">9-2. Grafana ë°°í¬<a hidden class="anchor" aria-hidden="true" href="#9-2-grafana-ë°°í¬">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-hcl" data-lang="hcl"><span style="display:flex;"><span><span style="color:#66d9ef">resource</span> <span style="color:#e6db74">&#34;kubernetes_deployment&#34; &#34;grafana_deployment&#34;</span> {
</span></span><span style="display:flex;"><span>  provider   <span style="color:#f92672">=</span> <span style="color:#66d9ef">kubernetes</span>.<span style="color:#66d9ef">eks</span>
</span></span><span style="display:flex;"><span>  depends_on <span style="color:#f92672">=</span> [<span style="color:#66d9ef">aws_eks_node_group</span>.<span style="color:#66d9ef">nodes</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">metadata</span> {
</span></span><span style="display:flex;"><span>    name      <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;grafana&#34;</span>
</span></span><span style="display:flex;"><span>    namespace <span style="color:#f92672">=</span> <span style="color:#66d9ef">var</span>.<span style="color:#66d9ef">namespace</span>
</span></span><span style="display:flex;"><span>    labels <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>      app <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;grafana&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">spec</span> {
</span></span><span style="display:flex;"><span>    replicas <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">selector</span> {
</span></span><span style="display:flex;"><span>      match_labels <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>        app <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;grafana&#34;</span>
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">template</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">metadata</span> {
</span></span><span style="display:flex;"><span>        labels <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>          app <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;grafana&#34;</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>      
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">spec</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">container</span> {
</span></span><span style="display:flex;"><span>          name  <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;grafana&#34;</span>
</span></span><span style="display:flex;"><span>          image <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;grafana/grafana:latest&#34;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">port</span> {
</span></span><span style="display:flex;"><span>            container_port <span style="color:#f92672">=</span> <span style="color:#66d9ef">var</span>.<span style="color:#66d9ef">grafana_port</span><span style="color:#75715e">  # 3001
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>          }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><hr>
<h2 id="-step-10-ë³€ìˆ˜-ì„¤ì •">ğŸ“ Step 10: ë³€ìˆ˜ ì„¤ì •<a hidden class="anchor" aria-hidden="true" href="#-step-10-ë³€ìˆ˜-ì„¤ì •">#</a></h2>
<h3 id="variablestf-ì£¼ìš”-ë³€ìˆ˜">variables.tf (ì£¼ìš” ë³€ìˆ˜)<a hidden class="anchor" aria-hidden="true" href="#variablestf-ì£¼ìš”-ë³€ìˆ˜">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-hcl" data-lang="hcl"><span style="display:flex;"><span><span style="color:#66d9ef">variable</span> <span style="color:#e6db74">&#34;aws_region&#34;</span> {
</span></span><span style="display:flex;"><span>  description <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;AWS region to deploy resources&#34;</span>
</span></span><span style="display:flex;"><span>  type        <span style="color:#f92672">=</span> <span style="color:#66d9ef">string</span>
</span></span><span style="display:flex;"><span>  default     <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;ap-northeast-2&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">variable</span> <span style="color:#e6db74">&#34;cluster_name&#34;</span> {
</span></span><span style="display:flex;"><span>  description <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Name of the EKS cluster&#34;</span>
</span></span><span style="display:flex;"><span>  type        <span style="color:#f92672">=</span> <span style="color:#66d9ef">string</span>
</span></span><span style="display:flex;"><span>  default     <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;llm-project-eks&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">variable</span> <span style="color:#e6db74">&#34;instance_type&#34;</span> {
</span></span><span style="display:flex;"><span>  description <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;EC2 instance type for EKS worker nodes&#34;</span>
</span></span><span style="display:flex;"><span>  type        <span style="color:#f92672">=</span> <span style="color:#66d9ef">string</span>
</span></span><span style="display:flex;"><span>  default     <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;t3.xlarge&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">variable</span> <span style="color:#e6db74">&#34;node_group_desired_capacity&#34;</span> {
</span></span><span style="display:flex;"><span>  description <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Desired number of worker nodes&#34;</span>
</span></span><span style="display:flex;"><span>  type        <span style="color:#f92672">=</span> <span style="color:#66d9ef">number</span>
</span></span><span style="display:flex;"><span>  default     <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>}<span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"># API í‚¤ ë³€ìˆ˜ë“¤
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">variable</span> <span style="color:#e6db74">&#34;GEMINI_API_KEY&#34;</span> {
</span></span><span style="display:flex;"><span>  description <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Gemini API key for LiteLLM&#34;</span>
</span></span><span style="display:flex;"><span>  type        <span style="color:#f92672">=</span> <span style="color:#66d9ef">string</span>
</span></span><span style="display:flex;"><span>  sensitive   <span style="color:#f92672">=</span> <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">variable</span> <span style="color:#e6db74">&#34;AZURE_API_KEY&#34;</span> {
</span></span><span style="display:flex;"><span>  description <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Azure OpenAI API key&#34;</span>
</span></span><span style="display:flex;"><span>  type        <span style="color:#f92672">=</span> <span style="color:#66d9ef">string</span>
</span></span><span style="display:flex;"><span>  sensitive   <span style="color:#f92672">=</span> <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>}<span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"># ë°ì´í„°ë² ì´ìŠ¤ ë³€ìˆ˜ë“¤
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">variable</span> <span style="color:#e6db74">&#34;postgres_user&#34;</span> {
</span></span><span style="display:flex;"><span>  description <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;PostgreSQL username&#34;</span>
</span></span><span style="display:flex;"><span>  type        <span style="color:#f92672">=</span> <span style="color:#66d9ef">string</span>
</span></span><span style="display:flex;"><span>  sensitive   <span style="color:#f92672">=</span> <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">variable</span> <span style="color:#e6db74">&#34;postgres_password&#34;</span> {
</span></span><span style="display:flex;"><span>  description <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;PostgreSQL password&#34;</span>
</span></span><span style="display:flex;"><span>  type        <span style="color:#f92672">=</span> <span style="color:#66d9ef">string</span>
</span></span><span style="display:flex;"><span>  sensitive   <span style="color:#f92672">=</span> <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="terraformtfvarsexample">terraform.tfvars.example<a hidden class="anchor" aria-hidden="true" href="#terraformtfvarsexample">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-hcl" data-lang="hcl"><span style="display:flex;"><span><span style="color:#75715e"># AWS ì„¤ì •
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>aws_region <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;ap-northeast-2&#34;</span>
</span></span><span style="display:flex;"><span>cluster_name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;llm-project-eks&#34;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"># ë„¤íŠ¸ì›Œí¬ ì„¤ì • (ì‹¤ì œ ê°’ìœ¼ë¡œ ë³€ê²½ í•„ìš”)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>vpc_id <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;vpc-0f11e0b7cb225055a&#34;</span>
</span></span><span style="display:flex;"><span>private_subnet_ids <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#34;subnet-020d530cbcaed0656&#34;, &#34;subnet-06bed7cfb33b120c1&#34;</span>]<span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"># ë…¸ë“œ ê·¸ë£¹ ì„¤ì •
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>instance_type <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;t3.medium&#34;</span>
</span></span><span style="display:flex;"><span>node_group_desired_capacity <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>node_group_min_capacity <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>node_group_max_capacity <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"># ì• í”Œë¦¬ì¼€ì´ì…˜ í¬íŠ¸
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>litellm_api_port <span style="color:#f92672">=</span> <span style="color:#ae81ff">4000</span>
</span></span><span style="display:flex;"><span>litellm_metrics_port <span style="color:#f92672">=</span> <span style="color:#ae81ff">8000</span>
</span></span><span style="display:flex;"><span>openwebui_port <span style="color:#f92672">=</span> <span style="color:#ae81ff">3000</span>
</span></span><span style="display:flex;"><span>prometheus_port <span style="color:#f92672">=</span> <span style="color:#ae81ff">9090</span>
</span></span><span style="display:flex;"><span>grafana_port <span style="color:#f92672">=</span> <span style="color:#ae81ff">3001</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"># ë¯¼ê°í•œ ì •ë³´ (ì‹¤ì œ ê°’ìœ¼ë¡œ ë³€ê²½ í•„ìˆ˜!)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"># ì´ ê°’ë“¤ì€ í™˜ê²½ ë³€ìˆ˜ë‚˜ CI/CD ì‹œí¬ë¦¿ìœ¼ë¡œ ê´€ë¦¬
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>litellm_master_key <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&lt;YOUR_MASTER_KEY&gt;&#34;</span>
</span></span><span style="display:flex;"><span>litellm_salt_key <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&lt;YOUR_SALT_KEY&gt;&#34;</span>
</span></span><span style="display:flex;"><span>GEMINI_API_KEY <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&lt;YOUR_GEMINI_KEY&gt;&#34;</span>
</span></span><span style="display:flex;"><span>AZURE_API_KEY <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&lt;YOUR_AZURE_KEY&gt;&#34;</span>
</span></span><span style="display:flex;"><span>AZURE_API_BASE <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;https://your-resource.openai.azure.com/&#34;</span>
</span></span><span style="display:flex;"><span>AZURE_API_VERSION <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;2023-07-01-preview&#34;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"># PostgreSQL ì„¤ì •
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>postgres_user <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;openwebui_user&#34;</span>
</span></span><span style="display:flex;"><span>postgres_password <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&lt;SECURE_PASSWORD&gt;&#34;</span>
</span></span><span style="display:flex;"><span>postgres_db <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;openwebui&#34;</span>
</span></span><span style="display:flex;"><span>database_url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;postgresql://openwebui_user:&lt;PASSWORD&gt;@postgres-service:5432/openwebui&#34;</span>
</span></span></code></pre></div><hr>
<h2 id="-ë°°í¬-ì‹¤í–‰-ê°€ì´ë“œ">ğŸš€ ë°°í¬ ì‹¤í–‰ ê°€ì´ë“œ<a hidden class="anchor" aria-hidden="true" href="#-ë°°í¬-ì‹¤í–‰-ê°€ì´ë“œ">#</a></h2>
<h3 id="1-ì‚¬ì „-ì¤€ë¹„">1. ì‚¬ì „ ì¤€ë¹„<a hidden class="anchor" aria-hidden="true" href="#1-ì‚¬ì „-ì¤€ë¹„">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># AWS CLI í”„ë¡œíŒŒì¼ ì„¤ì •</span>
</span></span><span style="display:flex;"><span>aws configure --profile llm
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ì‘ì—… ë””ë ‰í† ë¦¬ ì´ë™</span>
</span></span><span style="display:flex;"><span>cd terraform-related/AWS_terraform_grafana
</span></span></code></pre></div><h3 id="2-ë³€ìˆ˜-íŒŒì¼-ì¤€ë¹„">2. ë³€ìˆ˜ íŒŒì¼ ì¤€ë¹„<a hidden class="anchor" aria-hidden="true" href="#2-ë³€ìˆ˜-íŒŒì¼-ì¤€ë¹„">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># ì˜ˆì‹œ íŒŒì¼ ë³µì‚¬</span>
</span></span><span style="display:flex;"><span>cp tfvars.example terraform.tfvars
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ì‹¤ì œ ê°’ìœ¼ë¡œ ìˆ˜ì •</span>
</span></span><span style="display:flex;"><span>vim terraform.tfvars
</span></span></code></pre></div><h3 id="3-terraform-ì‹¤í–‰">3. Terraform ì‹¤í–‰<a hidden class="anchor" aria-hidden="true" href="#3-terraform-ì‹¤í–‰">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># ì´ˆê¸°í™”</span>
</span></span><span style="display:flex;"><span>terraform init
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ê³„íš í™•ì¸</span>
</span></span><span style="display:flex;"><span>terraform plan
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ë°°í¬ ì‹¤í–‰</span>
</span></span><span style="display:flex;"><span>terraform apply
</span></span></code></pre></div><h3 id="4-kubectl-ì„¤ì •">4. kubectl ì„¤ì •<a hidden class="anchor" aria-hidden="true" href="#4-kubectl-ì„¤ì •">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># kubeconfig ì—…ë°ì´íŠ¸</span>
</span></span><span style="display:flex;"><span>aws eks update-kubeconfig --region ap-northeast-2 --name llm-project-eks --profile llm
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># í´ëŸ¬ìŠ¤í„° í™•ì¸</span>
</span></span><span style="display:flex;"><span>kubectl get nodes
</span></span><span style="display:flex;"><span>kubectl get pods -A
</span></span></code></pre></div><h3 id="5-ì„œë¹„ìŠ¤-url-í™•ì¸">5. ì„œë¹„ìŠ¤ URL í™•ì¸<a hidden class="anchor" aria-hidden="true" href="#5-ì„œë¹„ìŠ¤-url-í™•ì¸">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># LoadBalancer URL í™•ì¸</span>
</span></span><span style="display:flex;"><span>kubectl get svc -A | grep LoadBalancer
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ê° ì„œë¹„ìŠ¤ë³„ ì—”ë“œí¬ì¸íŠ¸</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;OpenWebUI: http://</span><span style="color:#66d9ef">$(</span>kubectl get svc openwebui-service -o jsonpath<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;{.status.loadBalancer.ingress[0].hostname}&#39;</span><span style="color:#66d9ef">)</span><span style="color:#e6db74">:3000&#34;</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;Grafana: http://</span><span style="color:#66d9ef">$(</span>kubectl get svc grafana-service -o jsonpath<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;{.status.loadBalancer.ingress[0].hostname}&#39;</span><span style="color:#66d9ef">)</span><span style="color:#e6db74">:3001&#34;</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;Prometheus: http://</span><span style="color:#66d9ef">$(</span>kubectl get svc prometheus-service -o jsonpath<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;{.status.loadBalancer.ingress[0].hostname}&#39;</span><span style="color:#66d9ef">)</span><span style="color:#e6db74">:9090&#34;</span>
</span></span></code></pre></div><hr>
<h2 id="-ë¹„ìš©-ìµœì í™”-íŒ">ğŸ’° ë¹„ìš© ìµœì í™” íŒ<a hidden class="anchor" aria-hidden="true" href="#-ë¹„ìš©-ìµœì í™”-íŒ">#</a></h2>
<h3 id="ê°œë°œ-í™˜ê²½-ì„¤ì •">ê°œë°œ í™˜ê²½ ì„¤ì •<a hidden class="anchor" aria-hidden="true" href="#ê°œë°œ-í™˜ê²½-ì„¤ì •">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-hcl" data-lang="hcl"><span style="display:flex;"><span><span style="color:#75715e"># terraform.tfvarsì—ì„œ ì¡°ì •
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>instance_type <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;t3.small&#34;</span><span style="color:#75715e">              # ì‘ì€ ì¸ìŠ¤í„´ìŠ¤ ì‚¬ìš©
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>node_group_desired_capacity <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span><span style="color:#75715e">         # ìµœì†Œ ë…¸ë“œë¡œ ìš´ì˜
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>node_group_min_capacity <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span><span style="color:#75715e">             # ì•¼ê°„ ìŠ¤ì¼€ì¼ë‹¤ìš´ ê°€ëŠ¥
</span></span></span></code></pre></div><h3 id="ë¦¬ì†ŒìŠ¤-ì •ë¦¬">ë¦¬ì†ŒìŠ¤ ì •ë¦¬<a hidden class="anchor" aria-hidden="true" href="#ë¦¬ì†ŒìŠ¤-ì •ë¦¬">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># ì „ì²´ ë¦¬ì†ŒìŠ¤ ì‚­ì œ</span>
</span></span><span style="display:flex;"><span>terraform destroy
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># íŠ¹ì • ë¦¬ì†ŒìŠ¤ë§Œ ì‚­ì œ</span>
</span></span></code></pre></div>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
<nav class="paginav">
  <a class="prev" href="https://8dobibim.github.io/backend/eks-%ED%81%B4%EB%9F%AC%EC%8A%A4%ED%84%B0-%EB%B0%B0%ED%8F%AC-%EA%B0%80%EC%9D%B4%EB%93%9C/">
    <span class="title">Â« Prev</span>
    <br>
    <span></span>
  </a>
  <a class="next" href="https://8dobibim.github.io/backend/%EB%B0%B0%ED%8F%AC-%EA%B2%80%EC%A6%9D-%EA%B0%80%EC%9D%B4%EB%93%9C/">
    <span class="title">Next Â»</span>
    <br>
    <span></span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="https://8dobibim.github.io/">8dobibim Tech Blog</a></span> Â· 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
